function eg(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const a=Object.getOwnPropertyDescriptor(r,s);a&&Object.defineProperty(e,s,a.get?a:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();function tg(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var kh={exports:{}},Ri={},Nh={exports:{}},ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ca=Symbol.for("react.element"),ng=Symbol.for("react.portal"),rg=Symbol.for("react.fragment"),sg=Symbol.for("react.strict_mode"),ag=Symbol.for("react.profiler"),ig=Symbol.for("react.provider"),og=Symbol.for("react.context"),lg=Symbol.for("react.forward_ref"),cg=Symbol.for("react.suspense"),ug=Symbol.for("react.memo"),dg=Symbol.for("react.lazy"),ku=Symbol.iterator;function hg(e){return e===null||typeof e!="object"?null:(e=ku&&e[ku]||e["@@iterator"],typeof e=="function"?e:null)}var Eh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ch=Object.assign,Th={};function es(e,t,n){this.props=e,this.context=t,this.refs=Th,this.updater=n||Eh}es.prototype.isReactComponent={};es.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};es.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Rh(){}Rh.prototype=es.prototype;function lc(e,t,n){this.props=e,this.context=t,this.refs=Th,this.updater=n||Eh}var cc=lc.prototype=new Rh;cc.constructor=lc;Ch(cc,es.prototype);cc.isPureReactComponent=!0;var Nu=Array.isArray,Ph=Object.prototype.hasOwnProperty,uc={current:null},Oh={key:!0,ref:!0,__self:!0,__source:!0};function Ah(e,t,n){var r,s={},a=null,i=null;if(t!=null)for(r in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(a=""+t.key),t)Ph.call(t,r)&&!Oh.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:ca,type:e,key:a,ref:i,props:s,_owner:uc.current}}function fg(e,t){return{$$typeof:ca,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function dc(e){return typeof e=="object"&&e!==null&&e.$$typeof===ca}function pg(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Eu=/\/+/g;function lo(e,t){return typeof e=="object"&&e!==null&&e.key!=null?pg(""+e.key):t.toString(36)}function Va(e,t,n,r,s){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case ca:case ng:i=!0}}if(i)return i=e,s=s(i),e=r===""?"."+lo(i,0):r,Nu(s)?(n="",e!=null&&(n=e.replace(Eu,"$&/")+"/"),Va(s,t,n,"",function(u){return u})):s!=null&&(dc(s)&&(s=fg(s,n+(!s.key||i&&i.key===s.key?"":(""+s.key).replace(Eu,"$&/")+"/")+e)),t.push(s)),1;if(i=0,r=r===""?".":r+":",Nu(e))for(var l=0;l<e.length;l++){a=e[l];var c=r+lo(a,l);i+=Va(a,t,n,c,s)}else if(c=hg(e),typeof c=="function")for(e=c.call(e),l=0;!(a=e.next()).done;)a=a.value,c=r+lo(a,l++),i+=Va(a,t,n,c,s);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function xa(e,t,n){if(e==null)return e;var r=[],s=0;return Va(e,r,"","",function(a){return t.call(n,a,s++)}),r}function mg(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var st={current:null},Wa={transition:null},gg={ReactCurrentDispatcher:st,ReactCurrentBatchConfig:Wa,ReactCurrentOwner:uc};function Ih(){throw Error("act(...) is not supported in production builds of React.")}ce.Children={map:xa,forEach:function(e,t,n){xa(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return xa(e,function(){t++}),t},toArray:function(e){return xa(e,function(t){return t})||[]},only:function(e){if(!dc(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ce.Component=es;ce.Fragment=rg;ce.Profiler=ag;ce.PureComponent=lc;ce.StrictMode=sg;ce.Suspense=cg;ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gg;ce.act=Ih;ce.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Ch({},e.props),s=e.key,a=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,i=uc.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Ph.call(t,c)&&!Oh.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:ca,type:e.type,key:s,ref:a,props:r,_owner:i}};ce.createContext=function(e){return e={$$typeof:og,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:ig,_context:e},e.Consumer=e};ce.createElement=Ah;ce.createFactory=function(e){var t=Ah.bind(null,e);return t.type=e,t};ce.createRef=function(){return{current:null}};ce.forwardRef=function(e){return{$$typeof:lg,render:e}};ce.isValidElement=dc;ce.lazy=function(e){return{$$typeof:dg,_payload:{_status:-1,_result:e},_init:mg}};ce.memo=function(e,t){return{$$typeof:ug,type:e,compare:t===void 0?null:t}};ce.startTransition=function(e){var t=Wa.transition;Wa.transition={};try{e()}finally{Wa.transition=t}};ce.unstable_act=Ih;ce.useCallback=function(e,t){return st.current.useCallback(e,t)};ce.useContext=function(e){return st.current.useContext(e)};ce.useDebugValue=function(){};ce.useDeferredValue=function(e){return st.current.useDeferredValue(e)};ce.useEffect=function(e,t){return st.current.useEffect(e,t)};ce.useId=function(){return st.current.useId()};ce.useImperativeHandle=function(e,t,n){return st.current.useImperativeHandle(e,t,n)};ce.useInsertionEffect=function(e,t){return st.current.useInsertionEffect(e,t)};ce.useLayoutEffect=function(e,t){return st.current.useLayoutEffect(e,t)};ce.useMemo=function(e,t){return st.current.useMemo(e,t)};ce.useReducer=function(e,t,n){return st.current.useReducer(e,t,n)};ce.useRef=function(e){return st.current.useRef(e)};ce.useState=function(e){return st.current.useState(e)};ce.useSyncExternalStore=function(e,t,n){return st.current.useSyncExternalStore(e,t,n)};ce.useTransition=function(){return st.current.useTransition()};ce.version="18.3.1";Nh.exports=ce;var x=Nh.exports;const $h=tg(x),vg=eg({__proto__:null,default:$h},[x]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yg=x,wg=Symbol.for("react.element"),_g=Symbol.for("react.fragment"),xg=Object.prototype.hasOwnProperty,jg=yg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,bg={key:!0,ref:!0,__self:!0,__source:!0};function Lh(e,t,n){var r,s={},a=null,i=null;n!==void 0&&(a=""+n),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(r in t)xg.call(t,r)&&!bg.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:wg,type:e,key:a,ref:i,props:s,_owner:jg.current}}Ri.Fragment=_g;Ri.jsx=Lh;Ri.jsxs=Lh;kh.exports=Ri;var o=kh.exports,Go={},Dh={exports:{}},xt={},Uh={exports:{}},Mh={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(B,ee){var G=B.length;B.push(ee);e:for(;0<G;){var de=G-1>>>1,ie=B[de];if(0<s(ie,ee))B[de]=ee,B[G]=ie,G=de;else break e}}function n(B){return B.length===0?null:B[0]}function r(B){if(B.length===0)return null;var ee=B[0],G=B.pop();if(G!==ee){B[0]=G;e:for(var de=0,ie=B.length,E=ie>>>1;de<E;){var R=2*(de+1)-1,N=B[R],j=R+1,$=B[j];if(0>s(N,G))j<ie&&0>s($,N)?(B[de]=$,B[j]=G,de=j):(B[de]=N,B[R]=G,de=R);else if(j<ie&&0>s($,G))B[de]=$,B[j]=G,de=j;else break e}}return ee}function s(B,ee){var G=B.sortIndex-ee.sortIndex;return G!==0?G:B.id-ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,l=i.now();e.unstable_now=function(){return i.now()-l}}var c=[],u=[],d=1,m=null,p=3,w=!1,y=!1,_=!1,b=typeof setTimeout=="function"?setTimeout:null,f=typeof clearTimeout=="function"?clearTimeout:null,h=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(B){for(var ee=n(u);ee!==null;){if(ee.callback===null)r(u);else if(ee.startTime<=B)r(u),ee.sortIndex=ee.expirationTime,t(c,ee);else break;ee=n(u)}}function S(B){if(_=!1,g(B),!y)if(n(c)!==null)y=!0,oe(T);else{var ee=n(u);ee!==null&&ge(S,ee.startTime-B)}}function T(B,ee){y=!1,_&&(_=!1,f(O),O=-1),w=!0;var G=p;try{for(g(ee),m=n(c);m!==null&&(!(m.expirationTime>ee)||B&&!J());){var de=m.callback;if(typeof de=="function"){m.callback=null,p=m.priorityLevel;var ie=de(m.expirationTime<=ee);ee=e.unstable_now(),typeof ie=="function"?m.callback=ie:m===n(c)&&r(c),g(ee)}else r(c);m=n(c)}if(m!==null)var E=!0;else{var R=n(u);R!==null&&ge(S,R.startTime-ee),E=!1}return E}finally{m=null,p=G,w=!1}}var k=!1,P=null,O=-1,M=5,z=-1;function J(){return!(e.unstable_now()-z<M)}function be(){if(P!==null){var B=e.unstable_now();z=B;var ee=!0;try{ee=P(!0,B)}finally{ee?se():(k=!1,P=null)}}else k=!1}var se;if(typeof h=="function")se=function(){h(be)};else if(typeof MessageChannel<"u"){var we=new MessageChannel,K=we.port2;we.port1.onmessage=be,se=function(){K.postMessage(null)}}else se=function(){b(be,0)};function oe(B){P=B,k||(k=!0,se())}function ge(B,ee){O=b(function(){B(e.unstable_now())},ee)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(B){B.callback=null},e.unstable_continueExecution=function(){y||w||(y=!0,oe(T))},e.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<B?Math.floor(1e3/B):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(B){switch(p){case 1:case 2:case 3:var ee=3;break;default:ee=p}var G=p;p=ee;try{return B()}finally{p=G}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(B,ee){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var G=p;p=B;try{return ee()}finally{p=G}},e.unstable_scheduleCallback=function(B,ee,G){var de=e.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?de+G:de):G=de,B){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=G+ie,B={id:d++,callback:ee,priorityLevel:B,startTime:G,expirationTime:ie,sortIndex:-1},G>de?(B.sortIndex=G,t(u,B),n(c)===null&&B===n(u)&&(_?(f(O),O=-1):_=!0,ge(S,G-de))):(B.sortIndex=ie,t(c,B),y||w||(y=!0,oe(T))),B},e.unstable_shouldYield=J,e.unstable_wrapCallback=function(B){var ee=p;return function(){var G=p;p=ee;try{return B.apply(this,arguments)}finally{p=G}}}})(Mh);Uh.exports=Mh;var Sg=Uh.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kg=x,_t=Sg;function U(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Fh=new Set,Ds={};function cr(e,t){qr(e,t),qr(e+"Capture",t)}function qr(e,t){for(Ds[e]=t,e=0;e<t.length;e++)Fh.add(t[e])}var sn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Jo=Object.prototype.hasOwnProperty,Ng=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Cu={},Tu={};function Eg(e){return Jo.call(Tu,e)?!0:Jo.call(Cu,e)?!1:Ng.test(e)?Tu[e]=!0:(Cu[e]=!0,!1)}function Cg(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function Tg(e,t,n,r){if(t===null||typeof t>"u"||Cg(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function at(e,t,n,r,s,a,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var Qe={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Qe[e]=new at(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Qe[t]=new at(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Qe[e]=new at(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Qe[e]=new at(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Qe[e]=new at(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Qe[e]=new at(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Qe[e]=new at(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Qe[e]=new at(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Qe[e]=new at(e,5,!1,e.toLowerCase(),null,!1,!1)});var hc=/[\-:]([a-z])/g;function fc(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(hc,fc);Qe[t]=new at(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(hc,fc);Qe[t]=new at(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(hc,fc);Qe[t]=new at(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Qe[e]=new at(e,1,!1,e.toLowerCase(),null,!1,!1)});Qe.xlinkHref=new at("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Qe[e]=new at(e,1,!1,e.toLowerCase(),null,!0,!0)});function pc(e,t,n,r){var s=Qe.hasOwnProperty(t)?Qe[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(Tg(t,n,s,r)&&(n=null),r||s===null?Eg(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var cn=kg.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ja=Symbol.for("react.element"),kr=Symbol.for("react.portal"),Nr=Symbol.for("react.fragment"),mc=Symbol.for("react.strict_mode"),Qo=Symbol.for("react.profiler"),zh=Symbol.for("react.provider"),Bh=Symbol.for("react.context"),gc=Symbol.for("react.forward_ref"),Yo=Symbol.for("react.suspense"),Xo=Symbol.for("react.suspense_list"),vc=Symbol.for("react.memo"),wn=Symbol.for("react.lazy"),Vh=Symbol.for("react.offscreen"),Ru=Symbol.iterator;function ds(e){return e===null||typeof e!="object"?null:(e=Ru&&e[Ru]||e["@@iterator"],typeof e=="function"?e:null)}var Ie=Object.assign,co;function _s(e){if(co===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);co=t&&t[1]||""}return`
`+co+e}var uo=!1;function ho(e,t){if(!e||uo)return"";uo=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),a=r.stack.split(`
`),i=s.length-1,l=a.length-1;1<=i&&0<=l&&s[i]!==a[l];)l--;for(;1<=i&&0<=l;i--,l--)if(s[i]!==a[l]){if(i!==1||l!==1)do if(i--,l--,0>l||s[i]!==a[l]){var c=`
`+s[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=l);break}}}finally{uo=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?_s(e):""}function Rg(e){switch(e.tag){case 5:return _s(e.type);case 16:return _s("Lazy");case 13:return _s("Suspense");case 19:return _s("SuspenseList");case 0:case 2:case 15:return e=ho(e.type,!1),e;case 11:return e=ho(e.type.render,!1),e;case 1:return e=ho(e.type,!0),e;default:return""}}function Zo(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Nr:return"Fragment";case kr:return"Portal";case Qo:return"Profiler";case mc:return"StrictMode";case Yo:return"Suspense";case Xo:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Bh:return(e.displayName||"Context")+".Consumer";case zh:return(e._context.displayName||"Context")+".Provider";case gc:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case vc:return t=e.displayName||null,t!==null?t:Zo(e.type)||"Memo";case wn:t=e._payload,e=e._init;try{return Zo(e(t))}catch{}}return null}function Pg(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Zo(t);case 8:return t===mc?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Dn(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Wh(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Og(e){var t=Wh(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(i){r=""+i,a.call(this,i)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ba(e){e._valueTracker||(e._valueTracker=Og(e))}function qh(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Wh(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function ti(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function el(e,t){var n=t.checked;return Ie({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Pu(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Dn(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Kh(e,t){t=t.checked,t!=null&&pc(e,"checked",t,!1)}function tl(e,t){Kh(e,t);var n=Dn(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?nl(e,t.type,n):t.hasOwnProperty("defaultValue")&&nl(e,t.type,Dn(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Ou(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function nl(e,t,n){(t!=="number"||ti(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var xs=Array.isArray;function Ur(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Dn(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function rl(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(U(91));return Ie({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Au(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(U(92));if(xs(n)){if(1<n.length)throw Error(U(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Dn(n)}}function Hh(e,t){var n=Dn(t.value),r=Dn(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Iu(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Gh(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function sl(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Gh(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Sa,Jh=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Sa=Sa||document.createElement("div"),Sa.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Sa.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Us(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var ks={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ag=["Webkit","ms","Moz","O"];Object.keys(ks).forEach(function(e){Ag.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ks[t]=ks[e]})});function Qh(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||ks.hasOwnProperty(e)&&ks[e]?(""+t).trim():t+"px"}function Yh(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=Qh(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var Ig=Ie({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function al(e,t){if(t){if(Ig[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(U(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(U(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(U(61))}if(t.style!=null&&typeof t.style!="object")throw Error(U(62))}}function il(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ol=null;function yc(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var ll=null,Mr=null,Fr=null;function $u(e){if(e=ha(e)){if(typeof ll!="function")throw Error(U(280));var t=e.stateNode;t&&(t=$i(t),ll(e.stateNode,e.type,t))}}function Xh(e){Mr?Fr?Fr.push(e):Fr=[e]:Mr=e}function Zh(){if(Mr){var e=Mr,t=Fr;if(Fr=Mr=null,$u(e),t)for(e=0;e<t.length;e++)$u(t[e])}}function ef(e,t){return e(t)}function tf(){}var fo=!1;function nf(e,t,n){if(fo)return e(t,n);fo=!0;try{return ef(e,t,n)}finally{fo=!1,(Mr!==null||Fr!==null)&&(tf(),Zh())}}function Ms(e,t){var n=e.stateNode;if(n===null)return null;var r=$i(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(U(231,t,typeof n));return n}var cl=!1;if(sn)try{var hs={};Object.defineProperty(hs,"passive",{get:function(){cl=!0}}),window.addEventListener("test",hs,hs),window.removeEventListener("test",hs,hs)}catch{cl=!1}function $g(e,t,n,r,s,a,i,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(d){this.onError(d)}}var Ns=!1,ni=null,ri=!1,ul=null,Lg={onError:function(e){Ns=!0,ni=e}};function Dg(e,t,n,r,s,a,i,l,c){Ns=!1,ni=null,$g.apply(Lg,arguments)}function Ug(e,t,n,r,s,a,i,l,c){if(Dg.apply(this,arguments),Ns){if(Ns){var u=ni;Ns=!1,ni=null}else throw Error(U(198));ri||(ri=!0,ul=u)}}function ur(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function rf(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Lu(e){if(ur(e)!==e)throw Error(U(188))}function Mg(e){var t=e.alternate;if(!t){if(t=ur(e),t===null)throw Error(U(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var a=s.alternate;if(a===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===a.child){for(a=s.child;a;){if(a===n)return Lu(s),e;if(a===r)return Lu(s),t;a=a.sibling}throw Error(U(188))}if(n.return!==r.return)n=s,r=a;else{for(var i=!1,l=s.child;l;){if(l===n){i=!0,n=s,r=a;break}if(l===r){i=!0,r=s,n=a;break}l=l.sibling}if(!i){for(l=a.child;l;){if(l===n){i=!0,n=a,r=s;break}if(l===r){i=!0,r=a,n=s;break}l=l.sibling}if(!i)throw Error(U(189))}}if(n.alternate!==r)throw Error(U(190))}if(n.tag!==3)throw Error(U(188));return n.stateNode.current===n?e:t}function sf(e){return e=Mg(e),e!==null?af(e):null}function af(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=af(e);if(t!==null)return t;e=e.sibling}return null}var of=_t.unstable_scheduleCallback,Du=_t.unstable_cancelCallback,Fg=_t.unstable_shouldYield,zg=_t.unstable_requestPaint,De=_t.unstable_now,Bg=_t.unstable_getCurrentPriorityLevel,wc=_t.unstable_ImmediatePriority,lf=_t.unstable_UserBlockingPriority,si=_t.unstable_NormalPriority,Vg=_t.unstable_LowPriority,cf=_t.unstable_IdlePriority,Pi=null,Qt=null;function Wg(e){if(Qt&&typeof Qt.onCommitFiberRoot=="function")try{Qt.onCommitFiberRoot(Pi,e,void 0,(e.current.flags&128)===128)}catch{}}var Wt=Math.clz32?Math.clz32:Hg,qg=Math.log,Kg=Math.LN2;function Hg(e){return e>>>=0,e===0?32:31-(qg(e)/Kg|0)|0}var ka=64,Na=4194304;function js(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ai(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,a=e.pingedLanes,i=n&268435455;if(i!==0){var l=i&~s;l!==0?r=js(l):(a&=i,a!==0&&(r=js(a)))}else i=n&~s,i!==0?r=js(i):a!==0&&(r=js(a));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,a=t&-t,s>=a||s===16&&(a&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Wt(t),s=1<<n,r|=e[n],t&=~s;return r}function Gg(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jg(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-Wt(a),l=1<<i,c=s[i];c===-1?(!(l&n)||l&r)&&(s[i]=Gg(l,t)):c<=t&&(e.expiredLanes|=l),a&=~l}}function dl(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function uf(){var e=ka;return ka<<=1,!(ka&4194240)&&(ka=64),e}function po(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function ua(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Wt(t),e[t]=n}function Qg(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-Wt(n),a=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~a}}function _c(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Wt(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var _e=0;function df(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var hf,xc,ff,pf,mf,hl=!1,Ea=[],Cn=null,Tn=null,Rn=null,Fs=new Map,zs=new Map,jn=[],Yg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Uu(e,t){switch(e){case"focusin":case"focusout":Cn=null;break;case"dragenter":case"dragleave":Tn=null;break;case"mouseover":case"mouseout":Rn=null;break;case"pointerover":case"pointerout":Fs.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":zs.delete(t.pointerId)}}function fs(e,t,n,r,s,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[s]},t!==null&&(t=ha(t),t!==null&&xc(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function Xg(e,t,n,r,s){switch(t){case"focusin":return Cn=fs(Cn,e,t,n,r,s),!0;case"dragenter":return Tn=fs(Tn,e,t,n,r,s),!0;case"mouseover":return Rn=fs(Rn,e,t,n,r,s),!0;case"pointerover":var a=s.pointerId;return Fs.set(a,fs(Fs.get(a)||null,e,t,n,r,s)),!0;case"gotpointercapture":return a=s.pointerId,zs.set(a,fs(zs.get(a)||null,e,t,n,r,s)),!0}return!1}function gf(e){var t=Xn(e.target);if(t!==null){var n=ur(t);if(n!==null){if(t=n.tag,t===13){if(t=rf(n),t!==null){e.blockedOn=t,mf(e.priority,function(){ff(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function qa(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=fl(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);ol=r,n.target.dispatchEvent(r),ol=null}else return t=ha(n),t!==null&&xc(t),e.blockedOn=n,!1;t.shift()}return!0}function Mu(e,t,n){qa(e)&&n.delete(t)}function Zg(){hl=!1,Cn!==null&&qa(Cn)&&(Cn=null),Tn!==null&&qa(Tn)&&(Tn=null),Rn!==null&&qa(Rn)&&(Rn=null),Fs.forEach(Mu),zs.forEach(Mu)}function ps(e,t){e.blockedOn===t&&(e.blockedOn=null,hl||(hl=!0,_t.unstable_scheduleCallback(_t.unstable_NormalPriority,Zg)))}function Bs(e){function t(s){return ps(s,e)}if(0<Ea.length){ps(Ea[0],e);for(var n=1;n<Ea.length;n++){var r=Ea[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Cn!==null&&ps(Cn,e),Tn!==null&&ps(Tn,e),Rn!==null&&ps(Rn,e),Fs.forEach(t),zs.forEach(t),n=0;n<jn.length;n++)r=jn[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<jn.length&&(n=jn[0],n.blockedOn===null);)gf(n),n.blockedOn===null&&jn.shift()}var zr=cn.ReactCurrentBatchConfig,ii=!0;function ev(e,t,n,r){var s=_e,a=zr.transition;zr.transition=null;try{_e=1,jc(e,t,n,r)}finally{_e=s,zr.transition=a}}function tv(e,t,n,r){var s=_e,a=zr.transition;zr.transition=null;try{_e=4,jc(e,t,n,r)}finally{_e=s,zr.transition=a}}function jc(e,t,n,r){if(ii){var s=fl(e,t,n,r);if(s===null)So(e,t,r,oi,n),Uu(e,r);else if(Xg(s,e,t,n,r))r.stopPropagation();else if(Uu(e,r),t&4&&-1<Yg.indexOf(e)){for(;s!==null;){var a=ha(s);if(a!==null&&hf(a),a=fl(e,t,n,r),a===null&&So(e,t,r,oi,n),a===s)break;s=a}s!==null&&r.stopPropagation()}else So(e,t,r,null,n)}}var oi=null;function fl(e,t,n,r){if(oi=null,e=yc(r),e=Xn(e),e!==null)if(t=ur(e),t===null)e=null;else if(n=t.tag,n===13){if(e=rf(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return oi=e,null}function vf(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Bg()){case wc:return 1;case lf:return 4;case si:case Vg:return 16;case cf:return 536870912;default:return 16}default:return 16}}var kn=null,bc=null,Ka=null;function yf(){if(Ka)return Ka;var e,t=bc,n=t.length,r,s="value"in kn?kn.value:kn.textContent,a=s.length;for(e=0;e<n&&t[e]===s[e];e++);var i=n-e;for(r=1;r<=i&&t[n-r]===s[a-r];r++);return Ka=s.slice(e,1<r?1-r:void 0)}function Ha(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ca(){return!0}function Fu(){return!1}function jt(e){function t(n,r,s,a,i){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Ca:Fu,this.isPropagationStopped=Fu,this}return Ie(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ca)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ca)},persist:function(){},isPersistent:Ca}),t}var ts={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Sc=jt(ts),da=Ie({},ts,{view:0,detail:0}),nv=jt(da),mo,go,ms,Oi=Ie({},da,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kc,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ms&&(ms&&e.type==="mousemove"?(mo=e.screenX-ms.screenX,go=e.screenY-ms.screenY):go=mo=0,ms=e),mo)},movementY:function(e){return"movementY"in e?e.movementY:go}}),zu=jt(Oi),rv=Ie({},Oi,{dataTransfer:0}),sv=jt(rv),av=Ie({},da,{relatedTarget:0}),vo=jt(av),iv=Ie({},ts,{animationName:0,elapsedTime:0,pseudoElement:0}),ov=jt(iv),lv=Ie({},ts,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),cv=jt(lv),uv=Ie({},ts,{data:0}),Bu=jt(uv),dv={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hv={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pv(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=fv[e])?!!t[e]:!1}function kc(){return pv}var mv=Ie({},da,{key:function(e){if(e.key){var t=dv[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ha(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?hv[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kc,charCode:function(e){return e.type==="keypress"?Ha(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ha(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),gv=jt(mv),vv=Ie({},Oi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vu=jt(vv),yv=Ie({},da,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kc}),wv=jt(yv),_v=Ie({},ts,{propertyName:0,elapsedTime:0,pseudoElement:0}),xv=jt(_v),jv=Ie({},Oi,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),bv=jt(jv),Sv=[9,13,27,32],Nc=sn&&"CompositionEvent"in window,Es=null;sn&&"documentMode"in document&&(Es=document.documentMode);var kv=sn&&"TextEvent"in window&&!Es,wf=sn&&(!Nc||Es&&8<Es&&11>=Es),Wu=" ",qu=!1;function _f(e,t){switch(e){case"keyup":return Sv.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xf(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Er=!1;function Nv(e,t){switch(e){case"compositionend":return xf(t);case"keypress":return t.which!==32?null:(qu=!0,Wu);case"textInput":return e=t.data,e===Wu&&qu?null:e;default:return null}}function Ev(e,t){if(Er)return e==="compositionend"||!Nc&&_f(e,t)?(e=yf(),Ka=bc=kn=null,Er=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return wf&&t.locale!=="ko"?null:t.data;default:return null}}var Cv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ku(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Cv[e.type]:t==="textarea"}function jf(e,t,n,r){Xh(r),t=li(t,"onChange"),0<t.length&&(n=new Sc("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Cs=null,Vs=null;function Tv(e){Af(e,0)}function Ai(e){var t=Rr(e);if(qh(t))return e}function Rv(e,t){if(e==="change")return t}var bf=!1;if(sn){var yo;if(sn){var wo="oninput"in document;if(!wo){var Hu=document.createElement("div");Hu.setAttribute("oninput","return;"),wo=typeof Hu.oninput=="function"}yo=wo}else yo=!1;bf=yo&&(!document.documentMode||9<document.documentMode)}function Gu(){Cs&&(Cs.detachEvent("onpropertychange",Sf),Vs=Cs=null)}function Sf(e){if(e.propertyName==="value"&&Ai(Vs)){var t=[];jf(t,Vs,e,yc(e)),nf(Tv,t)}}function Pv(e,t,n){e==="focusin"?(Gu(),Cs=t,Vs=n,Cs.attachEvent("onpropertychange",Sf)):e==="focusout"&&Gu()}function Ov(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ai(Vs)}function Av(e,t){if(e==="click")return Ai(t)}function Iv(e,t){if(e==="input"||e==="change")return Ai(t)}function $v(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Kt=typeof Object.is=="function"?Object.is:$v;function Ws(e,t){if(Kt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Jo.call(t,s)||!Kt(e[s],t[s]))return!1}return!0}function Ju(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Qu(e,t){var n=Ju(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ju(n)}}function kf(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?kf(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Nf(){for(var e=window,t=ti();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=ti(e.document)}return t}function Ec(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Lv(e){var t=Nf(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&kf(n.ownerDocument.documentElement,n)){if(r!==null&&Ec(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,a=Math.min(r.start,s);r=r.end===void 0?a:Math.min(r.end,s),!e.extend&&a>r&&(s=r,r=a,a=s),s=Qu(n,a);var i=Qu(n,r);s&&i&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Dv=sn&&"documentMode"in document&&11>=document.documentMode,Cr=null,pl=null,Ts=null,ml=!1;function Yu(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ml||Cr==null||Cr!==ti(r)||(r=Cr,"selectionStart"in r&&Ec(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ts&&Ws(Ts,r)||(Ts=r,r=li(pl,"onSelect"),0<r.length&&(t=new Sc("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Cr)))}function Ta(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Tr={animationend:Ta("Animation","AnimationEnd"),animationiteration:Ta("Animation","AnimationIteration"),animationstart:Ta("Animation","AnimationStart"),transitionend:Ta("Transition","TransitionEnd")},_o={},Ef={};sn&&(Ef=document.createElement("div").style,"AnimationEvent"in window||(delete Tr.animationend.animation,delete Tr.animationiteration.animation,delete Tr.animationstart.animation),"TransitionEvent"in window||delete Tr.transitionend.transition);function Ii(e){if(_o[e])return _o[e];if(!Tr[e])return e;var t=Tr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in Ef)return _o[e]=t[n];return e}var Cf=Ii("animationend"),Tf=Ii("animationiteration"),Rf=Ii("animationstart"),Pf=Ii("transitionend"),Of=new Map,Xu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Mn(e,t){Of.set(e,t),cr(t,[e])}for(var xo=0;xo<Xu.length;xo++){var jo=Xu[xo],Uv=jo.toLowerCase(),Mv=jo[0].toUpperCase()+jo.slice(1);Mn(Uv,"on"+Mv)}Mn(Cf,"onAnimationEnd");Mn(Tf,"onAnimationIteration");Mn(Rf,"onAnimationStart");Mn("dblclick","onDoubleClick");Mn("focusin","onFocus");Mn("focusout","onBlur");Mn(Pf,"onTransitionEnd");qr("onMouseEnter",["mouseout","mouseover"]);qr("onMouseLeave",["mouseout","mouseover"]);qr("onPointerEnter",["pointerout","pointerover"]);qr("onPointerLeave",["pointerout","pointerover"]);cr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));cr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));cr("onBeforeInput",["compositionend","keypress","textInput","paste"]);cr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));cr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));cr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var bs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fv=new Set("cancel close invalid load scroll toggle".split(" ").concat(bs));function Zu(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Ug(r,t,void 0,e),e.currentTarget=null}function Af(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var i=r.length-1;0<=i;i--){var l=r[i],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==a&&s.isPropagationStopped())break e;Zu(s,l,u),a=c}else for(i=0;i<r.length;i++){if(l=r[i],c=l.instance,u=l.currentTarget,l=l.listener,c!==a&&s.isPropagationStopped())break e;Zu(s,l,u),a=c}}}if(ri)throw e=ul,ri=!1,ul=null,e}function Ne(e,t){var n=t[_l];n===void 0&&(n=t[_l]=new Set);var r=e+"__bubble";n.has(r)||(If(t,e,2,!1),n.add(r))}function bo(e,t,n){var r=0;t&&(r|=4),If(n,e,r,t)}var Ra="_reactListening"+Math.random().toString(36).slice(2);function qs(e){if(!e[Ra]){e[Ra]=!0,Fh.forEach(function(n){n!=="selectionchange"&&(Fv.has(n)||bo(n,!1,e),bo(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ra]||(t[Ra]=!0,bo("selectionchange",!1,t))}}function If(e,t,n,r){switch(vf(t)){case 1:var s=ev;break;case 4:s=tv;break;default:s=jc}n=s.bind(null,t,n,e),s=void 0,!cl||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function So(e,t,n,r,s){var a=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(i===4)for(i=r.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;i=i.return}for(;l!==null;){if(i=Xn(l),i===null)return;if(c=i.tag,c===5||c===6){r=a=i;continue e}l=l.parentNode}}r=r.return}nf(function(){var u=a,d=yc(n),m=[];e:{var p=Of.get(e);if(p!==void 0){var w=Sc,y=e;switch(e){case"keypress":if(Ha(n)===0)break e;case"keydown":case"keyup":w=gv;break;case"focusin":y="focus",w=vo;break;case"focusout":y="blur",w=vo;break;case"beforeblur":case"afterblur":w=vo;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=zu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=sv;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=wv;break;case Cf:case Tf:case Rf:w=ov;break;case Pf:w=xv;break;case"scroll":w=nv;break;case"wheel":w=bv;break;case"copy":case"cut":case"paste":w=cv;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=Vu}var _=(t&4)!==0,b=!_&&e==="scroll",f=_?p!==null?p+"Capture":null:p;_=[];for(var h=u,g;h!==null;){g=h;var S=g.stateNode;if(g.tag===5&&S!==null&&(g=S,f!==null&&(S=Ms(h,f),S!=null&&_.push(Ks(h,S,g)))),b)break;h=h.return}0<_.length&&(p=new w(p,y,null,n,d),m.push({event:p,listeners:_}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",w=e==="mouseout"||e==="pointerout",p&&n!==ol&&(y=n.relatedTarget||n.fromElement)&&(Xn(y)||y[an]))break e;if((w||p)&&(p=d.window===d?d:(p=d.ownerDocument)?p.defaultView||p.parentWindow:window,w?(y=n.relatedTarget||n.toElement,w=u,y=y?Xn(y):null,y!==null&&(b=ur(y),y!==b||y.tag!==5&&y.tag!==6)&&(y=null)):(w=null,y=u),w!==y)){if(_=zu,S="onMouseLeave",f="onMouseEnter",h="mouse",(e==="pointerout"||e==="pointerover")&&(_=Vu,S="onPointerLeave",f="onPointerEnter",h="pointer"),b=w==null?p:Rr(w),g=y==null?p:Rr(y),p=new _(S,h+"leave",w,n,d),p.target=b,p.relatedTarget=g,S=null,Xn(d)===u&&(_=new _(f,h+"enter",y,n,d),_.target=g,_.relatedTarget=b,S=_),b=S,w&&y)t:{for(_=w,f=y,h=0,g=_;g;g=mr(g))h++;for(g=0,S=f;S;S=mr(S))g++;for(;0<h-g;)_=mr(_),h--;for(;0<g-h;)f=mr(f),g--;for(;h--;){if(_===f||f!==null&&_===f.alternate)break t;_=mr(_),f=mr(f)}_=null}else _=null;w!==null&&ed(m,p,w,_,!1),y!==null&&b!==null&&ed(m,b,y,_,!0)}}e:{if(p=u?Rr(u):window,w=p.nodeName&&p.nodeName.toLowerCase(),w==="select"||w==="input"&&p.type==="file")var T=Rv;else if(Ku(p))if(bf)T=Iv;else{T=Ov;var k=Pv}else(w=p.nodeName)&&w.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(T=Av);if(T&&(T=T(e,u))){jf(m,T,n,d);break e}k&&k(e,p,u),e==="focusout"&&(k=p._wrapperState)&&k.controlled&&p.type==="number"&&nl(p,"number",p.value)}switch(k=u?Rr(u):window,e){case"focusin":(Ku(k)||k.contentEditable==="true")&&(Cr=k,pl=u,Ts=null);break;case"focusout":Ts=pl=Cr=null;break;case"mousedown":ml=!0;break;case"contextmenu":case"mouseup":case"dragend":ml=!1,Yu(m,n,d);break;case"selectionchange":if(Dv)break;case"keydown":case"keyup":Yu(m,n,d)}var P;if(Nc)e:{switch(e){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else Er?_f(e,n)&&(O="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(O="onCompositionStart");O&&(wf&&n.locale!=="ko"&&(Er||O!=="onCompositionStart"?O==="onCompositionEnd"&&Er&&(P=yf()):(kn=d,bc="value"in kn?kn.value:kn.textContent,Er=!0)),k=li(u,O),0<k.length&&(O=new Bu(O,e,null,n,d),m.push({event:O,listeners:k}),P?O.data=P:(P=xf(n),P!==null&&(O.data=P)))),(P=kv?Nv(e,n):Ev(e,n))&&(u=li(u,"onBeforeInput"),0<u.length&&(d=new Bu("onBeforeInput","beforeinput",null,n,d),m.push({event:d,listeners:u}),d.data=P))}Af(m,t)})}function Ks(e,t,n){return{instance:e,listener:t,currentTarget:n}}function li(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,a=s.stateNode;s.tag===5&&a!==null&&(s=a,a=Ms(e,n),a!=null&&r.unshift(Ks(e,a,s)),a=Ms(e,t),a!=null&&r.push(Ks(e,a,s))),e=e.return}return r}function mr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function ed(e,t,n,r,s){for(var a=t._reactName,i=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=Ms(n,a),c!=null&&i.unshift(Ks(n,c,l))):s||(c=Ms(n,a),c!=null&&i.push(Ks(n,c,l)))),n=n.return}i.length!==0&&e.push({event:t,listeners:i})}var zv=/\r\n?/g,Bv=/\u0000|\uFFFD/g;function td(e){return(typeof e=="string"?e:""+e).replace(zv,`
`).replace(Bv,"")}function Pa(e,t,n){if(t=td(t),td(e)!==t&&n)throw Error(U(425))}function ci(){}var gl=null,vl=null;function yl(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var wl=typeof setTimeout=="function"?setTimeout:void 0,Vv=typeof clearTimeout=="function"?clearTimeout:void 0,nd=typeof Promise=="function"?Promise:void 0,Wv=typeof queueMicrotask=="function"?queueMicrotask:typeof nd<"u"?function(e){return nd.resolve(null).then(e).catch(qv)}:wl;function qv(e){setTimeout(function(){throw e})}function ko(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),Bs(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Bs(t)}function Pn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function rd(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var ns=Math.random().toString(36).slice(2),Jt="__reactFiber$"+ns,Hs="__reactProps$"+ns,an="__reactContainer$"+ns,_l="__reactEvents$"+ns,Kv="__reactListeners$"+ns,Hv="__reactHandles$"+ns;function Xn(e){var t=e[Jt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[an]||n[Jt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=rd(e);e!==null;){if(n=e[Jt])return n;e=rd(e)}return t}e=n,n=e.parentNode}return null}function ha(e){return e=e[Jt]||e[an],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Rr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(U(33))}function $i(e){return e[Hs]||null}var xl=[],Pr=-1;function Fn(e){return{current:e}}function Ee(e){0>Pr||(e.current=xl[Pr],xl[Pr]=null,Pr--)}function ke(e,t){Pr++,xl[Pr]=e.current,e.current=t}var Un={},tt=Fn(Un),lt=Fn(!1),sr=Un;function Kr(e,t){var n=e.type.contextTypes;if(!n)return Un;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},a;for(a in n)s[a]=t[a];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function ct(e){return e=e.childContextTypes,e!=null}function ui(){Ee(lt),Ee(tt)}function sd(e,t,n){if(tt.current!==Un)throw Error(U(168));ke(tt,t),ke(lt,n)}function $f(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(U(108,Pg(e)||"Unknown",s));return Ie({},n,r)}function di(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Un,sr=tt.current,ke(tt,e),ke(lt,lt.current),!0}function ad(e,t,n){var r=e.stateNode;if(!r)throw Error(U(169));n?(e=$f(e,t,sr),r.__reactInternalMemoizedMergedChildContext=e,Ee(lt),Ee(tt),ke(tt,e)):Ee(lt),ke(lt,n)}var en=null,Li=!1,No=!1;function Lf(e){en===null?en=[e]:en.push(e)}function Gv(e){Li=!0,Lf(e)}function zn(){if(!No&&en!==null){No=!0;var e=0,t=_e;try{var n=en;for(_e=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}en=null,Li=!1}catch(s){throw en!==null&&(en=en.slice(e+1)),of(wc,zn),s}finally{_e=t,No=!1}}return null}var Or=[],Ar=0,hi=null,fi=0,kt=[],Nt=0,ar=null,tn=1,nn="";function Hn(e,t){Or[Ar++]=fi,Or[Ar++]=hi,hi=e,fi=t}function Df(e,t,n){kt[Nt++]=tn,kt[Nt++]=nn,kt[Nt++]=ar,ar=e;var r=tn;e=nn;var s=32-Wt(r)-1;r&=~(1<<s),n+=1;var a=32-Wt(t)+s;if(30<a){var i=s-s%5;a=(r&(1<<i)-1).toString(32),r>>=i,s-=i,tn=1<<32-Wt(t)+s|n<<s|r,nn=a+e}else tn=1<<a|n<<s|r,nn=e}function Cc(e){e.return!==null&&(Hn(e,1),Df(e,1,0))}function Tc(e){for(;e===hi;)hi=Or[--Ar],Or[Ar]=null,fi=Or[--Ar],Or[Ar]=null;for(;e===ar;)ar=kt[--Nt],kt[Nt]=null,nn=kt[--Nt],kt[Nt]=null,tn=kt[--Nt],kt[Nt]=null}var wt=null,yt=null,Ce=!1,Bt=null;function Uf(e,t){var n=Ct(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function id(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,wt=e,yt=Pn(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,wt=e,yt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=ar!==null?{id:tn,overflow:nn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Ct(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,wt=e,yt=null,!0):!1;default:return!1}}function jl(e){return(e.mode&1)!==0&&(e.flags&128)===0}function bl(e){if(Ce){var t=yt;if(t){var n=t;if(!id(e,t)){if(jl(e))throw Error(U(418));t=Pn(n.nextSibling);var r=wt;t&&id(e,t)?Uf(r,n):(e.flags=e.flags&-4097|2,Ce=!1,wt=e)}}else{if(jl(e))throw Error(U(418));e.flags=e.flags&-4097|2,Ce=!1,wt=e}}}function od(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;wt=e}function Oa(e){if(e!==wt)return!1;if(!Ce)return od(e),Ce=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!yl(e.type,e.memoizedProps)),t&&(t=yt)){if(jl(e))throw Mf(),Error(U(418));for(;t;)Uf(e,t),t=Pn(t.nextSibling)}if(od(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(U(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){yt=Pn(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}yt=null}}else yt=wt?Pn(e.stateNode.nextSibling):null;return!0}function Mf(){for(var e=yt;e;)e=Pn(e.nextSibling)}function Hr(){yt=wt=null,Ce=!1}function Rc(e){Bt===null?Bt=[e]:Bt.push(e)}var Jv=cn.ReactCurrentBatchConfig;function gs(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(U(309));var r=n.stateNode}if(!r)throw Error(U(147,e));var s=r,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(i){var l=s.refs;i===null?delete l[a]:l[a]=i},t._stringRef=a,t)}if(typeof e!="string")throw Error(U(284));if(!n._owner)throw Error(U(290,e))}return e}function Aa(e,t){throw e=Object.prototype.toString.call(t),Error(U(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ld(e){var t=e._init;return t(e._payload)}function Ff(e){function t(f,h){if(e){var g=f.deletions;g===null?(f.deletions=[h],f.flags|=16):g.push(h)}}function n(f,h){if(!e)return null;for(;h!==null;)t(f,h),h=h.sibling;return null}function r(f,h){for(f=new Map;h!==null;)h.key!==null?f.set(h.key,h):f.set(h.index,h),h=h.sibling;return f}function s(f,h){return f=$n(f,h),f.index=0,f.sibling=null,f}function a(f,h,g){return f.index=g,e?(g=f.alternate,g!==null?(g=g.index,g<h?(f.flags|=2,h):g):(f.flags|=2,h)):(f.flags|=1048576,h)}function i(f){return e&&f.alternate===null&&(f.flags|=2),f}function l(f,h,g,S){return h===null||h.tag!==6?(h=Ao(g,f.mode,S),h.return=f,h):(h=s(h,g),h.return=f,h)}function c(f,h,g,S){var T=g.type;return T===Nr?d(f,h,g.props.children,S,g.key):h!==null&&(h.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===wn&&ld(T)===h.type)?(S=s(h,g.props),S.ref=gs(f,h,g),S.return=f,S):(S=ei(g.type,g.key,g.props,null,f.mode,S),S.ref=gs(f,h,g),S.return=f,S)}function u(f,h,g,S){return h===null||h.tag!==4||h.stateNode.containerInfo!==g.containerInfo||h.stateNode.implementation!==g.implementation?(h=Io(g,f.mode,S),h.return=f,h):(h=s(h,g.children||[]),h.return=f,h)}function d(f,h,g,S,T){return h===null||h.tag!==7?(h=rr(g,f.mode,S,T),h.return=f,h):(h=s(h,g),h.return=f,h)}function m(f,h,g){if(typeof h=="string"&&h!==""||typeof h=="number")return h=Ao(""+h,f.mode,g),h.return=f,h;if(typeof h=="object"&&h!==null){switch(h.$$typeof){case ja:return g=ei(h.type,h.key,h.props,null,f.mode,g),g.ref=gs(f,null,h),g.return=f,g;case kr:return h=Io(h,f.mode,g),h.return=f,h;case wn:var S=h._init;return m(f,S(h._payload),g)}if(xs(h)||ds(h))return h=rr(h,f.mode,g,null),h.return=f,h;Aa(f,h)}return null}function p(f,h,g,S){var T=h!==null?h.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return T!==null?null:l(f,h,""+g,S);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case ja:return g.key===T?c(f,h,g,S):null;case kr:return g.key===T?u(f,h,g,S):null;case wn:return T=g._init,p(f,h,T(g._payload),S)}if(xs(g)||ds(g))return T!==null?null:d(f,h,g,S,null);Aa(f,g)}return null}function w(f,h,g,S,T){if(typeof S=="string"&&S!==""||typeof S=="number")return f=f.get(g)||null,l(h,f,""+S,T);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case ja:return f=f.get(S.key===null?g:S.key)||null,c(h,f,S,T);case kr:return f=f.get(S.key===null?g:S.key)||null,u(h,f,S,T);case wn:var k=S._init;return w(f,h,g,k(S._payload),T)}if(xs(S)||ds(S))return f=f.get(g)||null,d(h,f,S,T,null);Aa(h,S)}return null}function y(f,h,g,S){for(var T=null,k=null,P=h,O=h=0,M=null;P!==null&&O<g.length;O++){P.index>O?(M=P,P=null):M=P.sibling;var z=p(f,P,g[O],S);if(z===null){P===null&&(P=M);break}e&&P&&z.alternate===null&&t(f,P),h=a(z,h,O),k===null?T=z:k.sibling=z,k=z,P=M}if(O===g.length)return n(f,P),Ce&&Hn(f,O),T;if(P===null){for(;O<g.length;O++)P=m(f,g[O],S),P!==null&&(h=a(P,h,O),k===null?T=P:k.sibling=P,k=P);return Ce&&Hn(f,O),T}for(P=r(f,P);O<g.length;O++)M=w(P,f,O,g[O],S),M!==null&&(e&&M.alternate!==null&&P.delete(M.key===null?O:M.key),h=a(M,h,O),k===null?T=M:k.sibling=M,k=M);return e&&P.forEach(function(J){return t(f,J)}),Ce&&Hn(f,O),T}function _(f,h,g,S){var T=ds(g);if(typeof T!="function")throw Error(U(150));if(g=T.call(g),g==null)throw Error(U(151));for(var k=T=null,P=h,O=h=0,M=null,z=g.next();P!==null&&!z.done;O++,z=g.next()){P.index>O?(M=P,P=null):M=P.sibling;var J=p(f,P,z.value,S);if(J===null){P===null&&(P=M);break}e&&P&&J.alternate===null&&t(f,P),h=a(J,h,O),k===null?T=J:k.sibling=J,k=J,P=M}if(z.done)return n(f,P),Ce&&Hn(f,O),T;if(P===null){for(;!z.done;O++,z=g.next())z=m(f,z.value,S),z!==null&&(h=a(z,h,O),k===null?T=z:k.sibling=z,k=z);return Ce&&Hn(f,O),T}for(P=r(f,P);!z.done;O++,z=g.next())z=w(P,f,O,z.value,S),z!==null&&(e&&z.alternate!==null&&P.delete(z.key===null?O:z.key),h=a(z,h,O),k===null?T=z:k.sibling=z,k=z);return e&&P.forEach(function(be){return t(f,be)}),Ce&&Hn(f,O),T}function b(f,h,g,S){if(typeof g=="object"&&g!==null&&g.type===Nr&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case ja:e:{for(var T=g.key,k=h;k!==null;){if(k.key===T){if(T=g.type,T===Nr){if(k.tag===7){n(f,k.sibling),h=s(k,g.props.children),h.return=f,f=h;break e}}else if(k.elementType===T||typeof T=="object"&&T!==null&&T.$$typeof===wn&&ld(T)===k.type){n(f,k.sibling),h=s(k,g.props),h.ref=gs(f,k,g),h.return=f,f=h;break e}n(f,k);break}else t(f,k);k=k.sibling}g.type===Nr?(h=rr(g.props.children,f.mode,S,g.key),h.return=f,f=h):(S=ei(g.type,g.key,g.props,null,f.mode,S),S.ref=gs(f,h,g),S.return=f,f=S)}return i(f);case kr:e:{for(k=g.key;h!==null;){if(h.key===k)if(h.tag===4&&h.stateNode.containerInfo===g.containerInfo&&h.stateNode.implementation===g.implementation){n(f,h.sibling),h=s(h,g.children||[]),h.return=f,f=h;break e}else{n(f,h);break}else t(f,h);h=h.sibling}h=Io(g,f.mode,S),h.return=f,f=h}return i(f);case wn:return k=g._init,b(f,h,k(g._payload),S)}if(xs(g))return y(f,h,g,S);if(ds(g))return _(f,h,g,S);Aa(f,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,h!==null&&h.tag===6?(n(f,h.sibling),h=s(h,g),h.return=f,f=h):(n(f,h),h=Ao(g,f.mode,S),h.return=f,f=h),i(f)):n(f,h)}return b}var Gr=Ff(!0),zf=Ff(!1),pi=Fn(null),mi=null,Ir=null,Pc=null;function Oc(){Pc=Ir=mi=null}function Ac(e){var t=pi.current;Ee(pi),e._currentValue=t}function Sl(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Br(e,t){mi=e,Pc=Ir=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(ot=!0),e.firstContext=null)}function Rt(e){var t=e._currentValue;if(Pc!==e)if(e={context:e,memoizedValue:t,next:null},Ir===null){if(mi===null)throw Error(U(308));Ir=e,mi.dependencies={lanes:0,firstContext:e}}else Ir=Ir.next=e;return t}var Zn=null;function Ic(e){Zn===null?Zn=[e]:Zn.push(e)}function Bf(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,Ic(t)):(n.next=s.next,s.next=n),t.interleaved=n,on(e,r)}function on(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var _n=!1;function $c(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Vf(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function rn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function On(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,pe&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,on(e,n)}return s=r.interleaved,s===null?(t.next=t,Ic(r)):(t.next=s.next,s.next=t),r.interleaved=t,on(e,n)}function Ga(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,_c(e,n)}}function cd(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?s=a=i:a=a.next=i,n=n.next}while(n!==null);a===null?s=a=t:a=a.next=t}else s=a=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:a,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function gi(e,t,n,r){var s=e.updateQueue;_n=!1;var a=s.firstBaseUpdate,i=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,i===null?a=u:i.next=u,i=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==i&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(a!==null){var m=s.baseState;i=0,d=u=c=null,l=a;do{var p=l.lane,w=l.eventTime;if((r&p)===p){d!==null&&(d=d.next={eventTime:w,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var y=e,_=l;switch(p=t,w=n,_.tag){case 1:if(y=_.payload,typeof y=="function"){m=y.call(w,m,p);break e}m=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=_.payload,p=typeof y=="function"?y.call(w,m,p):y,p==null)break e;m=Ie({},m,p);break e;case 2:_n=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,p=s.effects,p===null?s.effects=[l]:p.push(l))}else w={eventTime:w,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=w,c=m):d=d.next=w,i|=p;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;p=l,l=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(d===null&&(c=m),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do i|=s.lane,s=s.next;while(s!==t)}else a===null&&(s.shared.lanes=0);or|=i,e.lanes=i,e.memoizedState=m}}function ud(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(U(191,s));s.call(r)}}}var fa={},Yt=Fn(fa),Gs=Fn(fa),Js=Fn(fa);function er(e){if(e===fa)throw Error(U(174));return e}function Lc(e,t){switch(ke(Js,t),ke(Gs,e),ke(Yt,fa),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:sl(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=sl(t,e)}Ee(Yt),ke(Yt,t)}function Jr(){Ee(Yt),Ee(Gs),Ee(Js)}function Wf(e){er(Js.current);var t=er(Yt.current),n=sl(t,e.type);t!==n&&(ke(Gs,e),ke(Yt,n))}function Dc(e){Gs.current===e&&(Ee(Yt),Ee(Gs))}var Pe=Fn(0);function vi(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Eo=[];function Uc(){for(var e=0;e<Eo.length;e++)Eo[e]._workInProgressVersionPrimary=null;Eo.length=0}var Ja=cn.ReactCurrentDispatcher,Co=cn.ReactCurrentBatchConfig,ir=0,Oe=null,Be=null,We=null,yi=!1,Rs=!1,Qs=0,Qv=0;function Xe(){throw Error(U(321))}function Mc(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Kt(e[n],t[n]))return!1;return!0}function Fc(e,t,n,r,s,a){if(ir=a,Oe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ja.current=e===null||e.memoizedState===null?ey:ty,e=n(r,s),Rs){a=0;do{if(Rs=!1,Qs=0,25<=a)throw Error(U(301));a+=1,We=Be=null,t.updateQueue=null,Ja.current=ny,e=n(r,s)}while(Rs)}if(Ja.current=wi,t=Be!==null&&Be.next!==null,ir=0,We=Be=Oe=null,yi=!1,t)throw Error(U(300));return e}function zc(){var e=Qs!==0;return Qs=0,e}function Gt(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return We===null?Oe.memoizedState=We=e:We=We.next=e,We}function Pt(){if(Be===null){var e=Oe.alternate;e=e!==null?e.memoizedState:null}else e=Be.next;var t=We===null?Oe.memoizedState:We.next;if(t!==null)We=t,Be=e;else{if(e===null)throw Error(U(310));Be=e,e={memoizedState:Be.memoizedState,baseState:Be.baseState,baseQueue:Be.baseQueue,queue:Be.queue,next:null},We===null?Oe.memoizedState=We=e:We=We.next=e}return We}function Ys(e,t){return typeof t=="function"?t(e):t}function To(e){var t=Pt(),n=t.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=e;var r=Be,s=r.baseQueue,a=n.pending;if(a!==null){if(s!==null){var i=s.next;s.next=a.next,a.next=i}r.baseQueue=s=a,n.pending=null}if(s!==null){a=s.next,r=r.baseState;var l=i=null,c=null,u=a;do{var d=u.lane;if((ir&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var m={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=m,i=r):c=c.next=m,Oe.lanes|=d,or|=d}u=u.next}while(u!==null&&u!==a);c===null?i=r:c.next=l,Kt(r,t.memoizedState)||(ot=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do a=s.lane,Oe.lanes|=a,or|=a,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ro(e){var t=Pt(),n=t.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,a=t.memoizedState;if(s!==null){n.pending=null;var i=s=s.next;do a=e(a,i.action),i=i.next;while(i!==s);Kt(a,t.memoizedState)||(ot=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function qf(){}function Kf(e,t){var n=Oe,r=Pt(),s=t(),a=!Kt(r.memoizedState,s);if(a&&(r.memoizedState=s,ot=!0),r=r.queue,Bc(Jf.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||We!==null&&We.memoizedState.tag&1){if(n.flags|=2048,Xs(9,Gf.bind(null,n,r,s,t),void 0,null),qe===null)throw Error(U(349));ir&30||Hf(n,t,s)}return s}function Hf(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Oe.updateQueue,t===null?(t={lastEffect:null,stores:null},Oe.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Gf(e,t,n,r){t.value=n,t.getSnapshot=r,Qf(t)&&Yf(e)}function Jf(e,t,n){return n(function(){Qf(t)&&Yf(e)})}function Qf(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Kt(e,n)}catch{return!0}}function Yf(e){var t=on(e,1);t!==null&&qt(t,e,1,-1)}function dd(e){var t=Gt();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ys,lastRenderedState:e},t.queue=e,e=e.dispatch=Zv.bind(null,Oe,e),[t.memoizedState,e]}function Xs(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Oe.updateQueue,t===null?(t={lastEffect:null,stores:null},Oe.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Xf(){return Pt().memoizedState}function Qa(e,t,n,r){var s=Gt();Oe.flags|=e,s.memoizedState=Xs(1|t,n,void 0,r===void 0?null:r)}function Di(e,t,n,r){var s=Pt();r=r===void 0?null:r;var a=void 0;if(Be!==null){var i=Be.memoizedState;if(a=i.destroy,r!==null&&Mc(r,i.deps)){s.memoizedState=Xs(t,n,a,r);return}}Oe.flags|=e,s.memoizedState=Xs(1|t,n,a,r)}function hd(e,t){return Qa(8390656,8,e,t)}function Bc(e,t){return Di(2048,8,e,t)}function Zf(e,t){return Di(4,2,e,t)}function ep(e,t){return Di(4,4,e,t)}function tp(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function np(e,t,n){return n=n!=null?n.concat([e]):null,Di(4,4,tp.bind(null,t,e),n)}function Vc(){}function rp(e,t){var n=Pt();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Mc(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function sp(e,t){var n=Pt();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Mc(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function ap(e,t,n){return ir&21?(Kt(n,t)||(n=uf(),Oe.lanes|=n,or|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,ot=!0),e.memoizedState=n)}function Yv(e,t){var n=_e;_e=n!==0&&4>n?n:4,e(!0);var r=Co.transition;Co.transition={};try{e(!1),t()}finally{_e=n,Co.transition=r}}function ip(){return Pt().memoizedState}function Xv(e,t,n){var r=In(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},op(e))lp(t,n);else if(n=Bf(e,t,n,r),n!==null){var s=rt();qt(n,e,r,s),cp(n,t,r)}}function Zv(e,t,n){var r=In(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(op(e))lp(t,s);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var i=t.lastRenderedState,l=a(i,n);if(s.hasEagerState=!0,s.eagerState=l,Kt(l,i)){var c=t.interleaved;c===null?(s.next=s,Ic(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}n=Bf(e,t,s,r),n!==null&&(s=rt(),qt(n,e,r,s),cp(n,t,r))}}function op(e){var t=e.alternate;return e===Oe||t!==null&&t===Oe}function lp(e,t){Rs=yi=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function cp(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,_c(e,n)}}var wi={readContext:Rt,useCallback:Xe,useContext:Xe,useEffect:Xe,useImperativeHandle:Xe,useInsertionEffect:Xe,useLayoutEffect:Xe,useMemo:Xe,useReducer:Xe,useRef:Xe,useState:Xe,useDebugValue:Xe,useDeferredValue:Xe,useTransition:Xe,useMutableSource:Xe,useSyncExternalStore:Xe,useId:Xe,unstable_isNewReconciler:!1},ey={readContext:Rt,useCallback:function(e,t){return Gt().memoizedState=[e,t===void 0?null:t],e},useContext:Rt,useEffect:hd,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Qa(4194308,4,tp.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Qa(4194308,4,e,t)},useInsertionEffect:function(e,t){return Qa(4,2,e,t)},useMemo:function(e,t){var n=Gt();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Gt();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Xv.bind(null,Oe,e),[r.memoizedState,e]},useRef:function(e){var t=Gt();return e={current:e},t.memoizedState=e},useState:dd,useDebugValue:Vc,useDeferredValue:function(e){return Gt().memoizedState=e},useTransition:function(){var e=dd(!1),t=e[0];return e=Yv.bind(null,e[1]),Gt().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Oe,s=Gt();if(Ce){if(n===void 0)throw Error(U(407));n=n()}else{if(n=t(),qe===null)throw Error(U(349));ir&30||Hf(r,t,n)}s.memoizedState=n;var a={value:n,getSnapshot:t};return s.queue=a,hd(Jf.bind(null,r,a,e),[e]),r.flags|=2048,Xs(9,Gf.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=Gt(),t=qe.identifierPrefix;if(Ce){var n=nn,r=tn;n=(r&~(1<<32-Wt(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Qs++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Qv++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ty={readContext:Rt,useCallback:rp,useContext:Rt,useEffect:Bc,useImperativeHandle:np,useInsertionEffect:Zf,useLayoutEffect:ep,useMemo:sp,useReducer:To,useRef:Xf,useState:function(){return To(Ys)},useDebugValue:Vc,useDeferredValue:function(e){var t=Pt();return ap(t,Be.memoizedState,e)},useTransition:function(){var e=To(Ys)[0],t=Pt().memoizedState;return[e,t]},useMutableSource:qf,useSyncExternalStore:Kf,useId:ip,unstable_isNewReconciler:!1},ny={readContext:Rt,useCallback:rp,useContext:Rt,useEffect:Bc,useImperativeHandle:np,useInsertionEffect:Zf,useLayoutEffect:ep,useMemo:sp,useReducer:Ro,useRef:Xf,useState:function(){return Ro(Ys)},useDebugValue:Vc,useDeferredValue:function(e){var t=Pt();return Be===null?t.memoizedState=e:ap(t,Be.memoizedState,e)},useTransition:function(){var e=Ro(Ys)[0],t=Pt().memoizedState;return[e,t]},useMutableSource:qf,useSyncExternalStore:Kf,useId:ip,unstable_isNewReconciler:!1};function Ut(e,t){if(e&&e.defaultProps){t=Ie({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function kl(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Ie({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Ui={isMounted:function(e){return(e=e._reactInternals)?ur(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=rt(),s=In(e),a=rn(r,s);a.payload=t,n!=null&&(a.callback=n),t=On(e,a,s),t!==null&&(qt(t,e,s,r),Ga(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=rt(),s=In(e),a=rn(r,s);a.tag=1,a.payload=t,n!=null&&(a.callback=n),t=On(e,a,s),t!==null&&(qt(t,e,s,r),Ga(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=rt(),r=In(e),s=rn(n,r);s.tag=2,t!=null&&(s.callback=t),t=On(e,s,r),t!==null&&(qt(t,e,r,n),Ga(t,e,r))}};function fd(e,t,n,r,s,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,a,i):t.prototype&&t.prototype.isPureReactComponent?!Ws(n,r)||!Ws(s,a):!0}function up(e,t,n){var r=!1,s=Un,a=t.contextType;return typeof a=="object"&&a!==null?a=Rt(a):(s=ct(t)?sr:tt.current,r=t.contextTypes,a=(r=r!=null)?Kr(e,s):Un),t=new t(n,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Ui,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=a),t}function pd(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Ui.enqueueReplaceState(t,t.state,null)}function Nl(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},$c(e);var a=t.contextType;typeof a=="object"&&a!==null?s.context=Rt(a):(a=ct(t)?sr:tt.current,s.context=Kr(e,a)),s.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(kl(e,t,a,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Ui.enqueueReplaceState(s,s.state,null),gi(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Qr(e,t){try{var n="",r=t;do n+=Rg(r),r=r.return;while(r);var s=n}catch(a){s=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:s,digest:null}}function Po(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function El(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var ry=typeof WeakMap=="function"?WeakMap:Map;function dp(e,t,n){n=rn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){xi||(xi=!0,Dl=r),El(e,t)},n}function hp(e,t,n){n=rn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){El(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){El(e,t),typeof r!="function"&&(An===null?An=new Set([this]):An.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),n}function md(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new ry;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=vy.bind(null,e,t,n),t.then(e,e))}function gd(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function vd(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=rn(-1,1),t.tag=2,On(n,t,1))),n.lanes|=1),e)}var sy=cn.ReactCurrentOwner,ot=!1;function nt(e,t,n,r){t.child=e===null?zf(t,null,n,r):Gr(t,e.child,n,r)}function yd(e,t,n,r,s){n=n.render;var a=t.ref;return Br(t,s),r=Fc(e,t,n,r,a,s),n=zc(),e!==null&&!ot?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ln(e,t,s)):(Ce&&n&&Cc(t),t.flags|=1,nt(e,t,r,s),t.child)}function wd(e,t,n,r,s){if(e===null){var a=n.type;return typeof a=="function"&&!Yc(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=a,fp(e,t,a,r,s)):(e=ei(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&s)){var i=a.memoizedProps;if(n=n.compare,n=n!==null?n:Ws,n(i,r)&&e.ref===t.ref)return ln(e,t,s)}return t.flags|=1,e=$n(a,r),e.ref=t.ref,e.return=t,t.child=e}function fp(e,t,n,r,s){if(e!==null){var a=e.memoizedProps;if(Ws(a,r)&&e.ref===t.ref)if(ot=!1,t.pendingProps=r=a,(e.lanes&s)!==0)e.flags&131072&&(ot=!0);else return t.lanes=e.lanes,ln(e,t,s)}return Cl(e,t,n,r,s)}function pp(e,t,n){var r=t.pendingProps,s=r.children,a=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},ke(Lr,pt),pt|=n;else{if(!(n&1073741824))return e=a!==null?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,ke(Lr,pt),pt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,ke(Lr,pt),pt|=r}else a!==null?(r=a.baseLanes|n,t.memoizedState=null):r=n,ke(Lr,pt),pt|=r;return nt(e,t,s,n),t.child}function mp(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Cl(e,t,n,r,s){var a=ct(n)?sr:tt.current;return a=Kr(t,a),Br(t,s),n=Fc(e,t,n,r,a,s),r=zc(),e!==null&&!ot?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,ln(e,t,s)):(Ce&&r&&Cc(t),t.flags|=1,nt(e,t,n,s),t.child)}function _d(e,t,n,r,s){if(ct(n)){var a=!0;di(t)}else a=!1;if(Br(t,s),t.stateNode===null)Ya(e,t),up(t,n,r),Nl(t,n,r,s),r=!0;else if(e===null){var i=t.stateNode,l=t.memoizedProps;i.props=l;var c=i.context,u=n.contextType;typeof u=="object"&&u!==null?u=Rt(u):(u=ct(n)?sr:tt.current,u=Kr(t,u));var d=n.getDerivedStateFromProps,m=typeof d=="function"||typeof i.getSnapshotBeforeUpdate=="function";m||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==r||c!==u)&&pd(t,i,r,u),_n=!1;var p=t.memoizedState;i.state=p,gi(t,r,i,s),c=t.memoizedState,l!==r||p!==c||lt.current||_n?(typeof d=="function"&&(kl(t,n,d,r),c=t.memoizedState),(l=_n||fd(t,n,l,r,p,c,u))?(m||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),i.props=r,i.state=c,i.context=u,r=l):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,Vf(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:Ut(t.type,l),i.props=u,m=t.pendingProps,p=i.context,c=n.contextType,typeof c=="object"&&c!==null?c=Rt(c):(c=ct(n)?sr:tt.current,c=Kr(t,c));var w=n.getDerivedStateFromProps;(d=typeof w=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(l!==m||p!==c)&&pd(t,i,r,c),_n=!1,p=t.memoizedState,i.state=p,gi(t,r,i,s);var y=t.memoizedState;l!==m||p!==y||lt.current||_n?(typeof w=="function"&&(kl(t,n,w,r),y=t.memoizedState),(u=_n||fd(t,n,u,r,p,y,c)||!1)?(d||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,y,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,y,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=y),i.props=r,i.state=y,i.context=c,r=u):(typeof i.componentDidUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return Tl(e,t,n,r,a,s)}function Tl(e,t,n,r,s,a){mp(e,t);var i=(t.flags&128)!==0;if(!r&&!i)return s&&ad(t,n,!1),ln(e,t,a);r=t.stateNode,sy.current=t;var l=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&i?(t.child=Gr(t,e.child,null,a),t.child=Gr(t,null,l,a)):nt(e,t,l,a),t.memoizedState=r.state,s&&ad(t,n,!0),t.child}function gp(e){var t=e.stateNode;t.pendingContext?sd(e,t.pendingContext,t.pendingContext!==t.context):t.context&&sd(e,t.context,!1),Lc(e,t.containerInfo)}function xd(e,t,n,r,s){return Hr(),Rc(s),t.flags|=256,nt(e,t,n,r),t.child}var Rl={dehydrated:null,treeContext:null,retryLane:0};function Pl(e){return{baseLanes:e,cachePool:null,transitions:null}}function vp(e,t,n){var r=t.pendingProps,s=Pe.current,a=!1,i=(t.flags&128)!==0,l;if((l=i)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),ke(Pe,s&1),e===null)return bl(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=r.children,e=r.fallback,a?(r=t.mode,a=t.child,i={mode:"hidden",children:i},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=zi(i,r,0,null),e=rr(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Pl(n),t.memoizedState=Rl,e):Wc(t,i));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return ay(e,t,i,r,l,s,n);if(a){a=r.fallback,i=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(i&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=$n(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?a=$n(l,a):(a=rr(a,i,n,null),a.flags|=2),a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,i=e.child.memoizedState,i=i===null?Pl(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~n,t.memoizedState=Rl,r}return a=e.child,e=a.sibling,r=$n(a,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Wc(e,t){return t=zi({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ia(e,t,n,r){return r!==null&&Rc(r),Gr(t,e.child,null,n),e=Wc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function ay(e,t,n,r,s,a,i){if(n)return t.flags&256?(t.flags&=-257,r=Po(Error(U(422))),Ia(e,t,i,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=r.fallback,s=t.mode,r=zi({mode:"visible",children:r.children},s,0,null),a=rr(a,s,i,null),a.flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,t.mode&1&&Gr(t,e.child,null,i),t.child.memoizedState=Pl(i),t.memoizedState=Rl,a);if(!(t.mode&1))return Ia(e,t,i,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,a=Error(U(419)),r=Po(a,r,void 0),Ia(e,t,i,r)}if(l=(i&e.childLanes)!==0,ot||l){if(r=qe,r!==null){switch(i&-i){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|i)?0:s,s!==0&&s!==a.retryLane&&(a.retryLane=s,on(e,s),qt(r,e,s,-1))}return Qc(),r=Po(Error(U(421))),Ia(e,t,i,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=yy.bind(null,e),s._reactRetry=t,null):(e=a.treeContext,yt=Pn(s.nextSibling),wt=t,Ce=!0,Bt=null,e!==null&&(kt[Nt++]=tn,kt[Nt++]=nn,kt[Nt++]=ar,tn=e.id,nn=e.overflow,ar=t),t=Wc(t,r.children),t.flags|=4096,t)}function jd(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),Sl(e.return,t,n)}function Oo(e,t,n,r,s){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=s)}function yp(e,t,n){var r=t.pendingProps,s=r.revealOrder,a=r.tail;if(nt(e,t,r.children,n),r=Pe.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&jd(e,n,t);else if(e.tag===19)jd(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(ke(Pe,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&vi(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),Oo(t,!1,s,n,a);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&vi(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}Oo(t,!0,n,null,a);break;case"together":Oo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ya(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function ln(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),or|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(U(153));if(t.child!==null){for(e=t.child,n=$n(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=$n(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function iy(e,t,n){switch(t.tag){case 3:gp(t),Hr();break;case 5:Wf(t);break;case 1:ct(t.type)&&di(t);break;case 4:Lc(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;ke(pi,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(ke(Pe,Pe.current&1),t.flags|=128,null):n&t.child.childLanes?vp(e,t,n):(ke(Pe,Pe.current&1),e=ln(e,t,n),e!==null?e.sibling:null);ke(Pe,Pe.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return yp(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),ke(Pe,Pe.current),r)break;return null;case 22:case 23:return t.lanes=0,pp(e,t,n)}return ln(e,t,n)}var wp,Ol,_p,xp;wp=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Ol=function(){};_p=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,er(Yt.current);var a=null;switch(n){case"input":s=el(e,s),r=el(e,r),a=[];break;case"select":s=Ie({},s,{value:void 0}),r=Ie({},r,{value:void 0}),a=[];break;case"textarea":s=rl(e,s),r=rl(e,r),a=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=ci)}al(n,r);var i;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(i in l)l.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Ds.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(i in l)!l.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&l[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(a||(a=[]),a.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Ds.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Ne("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};xp=function(e,t,n,r){n!==r&&(t.flags|=4)};function vs(e,t){if(!Ce)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ze(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function oy(e,t,n){var r=t.pendingProps;switch(Tc(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ze(t),null;case 1:return ct(t.type)&&ui(),Ze(t),null;case 3:return r=t.stateNode,Jr(),Ee(lt),Ee(tt),Uc(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Oa(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Bt!==null&&(Fl(Bt),Bt=null))),Ol(e,t),Ze(t),null;case 5:Dc(t);var s=er(Js.current);if(n=t.type,e!==null&&t.stateNode!=null)_p(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(U(166));return Ze(t),null}if(e=er(Yt.current),Oa(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[Jt]=t,r[Hs]=a,e=(t.mode&1)!==0,n){case"dialog":Ne("cancel",r),Ne("close",r);break;case"iframe":case"object":case"embed":Ne("load",r);break;case"video":case"audio":for(s=0;s<bs.length;s++)Ne(bs[s],r);break;case"source":Ne("error",r);break;case"img":case"image":case"link":Ne("error",r),Ne("load",r);break;case"details":Ne("toggle",r);break;case"input":Pu(r,a),Ne("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Ne("invalid",r);break;case"textarea":Au(r,a),Ne("invalid",r)}al(n,a),s=null;for(var i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="children"?typeof l=="string"?r.textContent!==l&&(a.suppressHydrationWarning!==!0&&Pa(r.textContent,l,e),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&Pa(r.textContent,l,e),s=["children",""+l]):Ds.hasOwnProperty(i)&&l!=null&&i==="onScroll"&&Ne("scroll",r)}switch(n){case"input":ba(r),Ou(r,a,!0);break;case"textarea":ba(r),Iu(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=ci)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{i=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Gh(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=i.createElement(n,{is:r.is}):(e=i.createElement(n),n==="select"&&(i=e,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):e=i.createElementNS(e,n),e[Jt]=t,e[Hs]=r,wp(e,t,!1,!1),t.stateNode=e;e:{switch(i=il(n,r),n){case"dialog":Ne("cancel",e),Ne("close",e),s=r;break;case"iframe":case"object":case"embed":Ne("load",e),s=r;break;case"video":case"audio":for(s=0;s<bs.length;s++)Ne(bs[s],e);s=r;break;case"source":Ne("error",e),s=r;break;case"img":case"image":case"link":Ne("error",e),Ne("load",e),s=r;break;case"details":Ne("toggle",e),s=r;break;case"input":Pu(e,r),s=el(e,r),Ne("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Ie({},r,{value:void 0}),Ne("invalid",e);break;case"textarea":Au(e,r),s=rl(e,r),Ne("invalid",e);break;default:s=r}al(n,s),l=s;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?Yh(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Jh(e,c)):a==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Us(e,c):typeof c=="number"&&Us(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(Ds.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Ne("scroll",e):c!=null&&pc(e,a,c,i))}switch(n){case"input":ba(e),Ou(e,r,!1);break;case"textarea":ba(e),Iu(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Dn(r.value));break;case"select":e.multiple=!!r.multiple,a=r.value,a!=null?Ur(e,!!r.multiple,a,!1):r.defaultValue!=null&&Ur(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=ci)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Ze(t),null;case 6:if(e&&t.stateNode!=null)xp(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(U(166));if(n=er(Js.current),er(Yt.current),Oa(t)){if(r=t.stateNode,n=t.memoizedProps,r[Jt]=t,(a=r.nodeValue!==n)&&(e=wt,e!==null))switch(e.tag){case 3:Pa(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Pa(r.nodeValue,n,(e.mode&1)!==0)}a&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Jt]=t,t.stateNode=r}return Ze(t),null;case 13:if(Ee(Pe),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ce&&yt!==null&&t.mode&1&&!(t.flags&128))Mf(),Hr(),t.flags|=98560,a=!1;else if(a=Oa(t),r!==null&&r.dehydrated!==null){if(e===null){if(!a)throw Error(U(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(U(317));a[Jt]=t}else Hr(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Ze(t),a=!1}else Bt!==null&&(Fl(Bt),Bt=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Pe.current&1?Ve===0&&(Ve=3):Qc())),t.updateQueue!==null&&(t.flags|=4),Ze(t),null);case 4:return Jr(),Ol(e,t),e===null&&qs(t.stateNode.containerInfo),Ze(t),null;case 10:return Ac(t.type._context),Ze(t),null;case 17:return ct(t.type)&&ui(),Ze(t),null;case 19:if(Ee(Pe),a=t.memoizedState,a===null)return Ze(t),null;if(r=(t.flags&128)!==0,i=a.rendering,i===null)if(r)vs(a,!1);else{if(Ve!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=vi(e),i!==null){for(t.flags|=128,vs(a,!1),r=i.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)a=n,e=r,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ke(Pe,Pe.current&1|2),t.child}e=e.sibling}a.tail!==null&&De()>Yr&&(t.flags|=128,r=!0,vs(a,!1),t.lanes=4194304)}else{if(!r)if(e=vi(i),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),vs(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!Ce)return Ze(t),null}else 2*De()-a.renderingStartTime>Yr&&n!==1073741824&&(t.flags|=128,r=!0,vs(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(n=a.last,n!==null?n.sibling=i:t.child=i,a.last=i)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=De(),t.sibling=null,n=Pe.current,ke(Pe,r?n&1|2:n&1),t):(Ze(t),null);case 22:case 23:return Jc(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?pt&1073741824&&(Ze(t),t.subtreeFlags&6&&(t.flags|=8192)):Ze(t),null;case 24:return null;case 25:return null}throw Error(U(156,t.tag))}function ly(e,t){switch(Tc(t),t.tag){case 1:return ct(t.type)&&ui(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Jr(),Ee(lt),Ee(tt),Uc(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Dc(t),null;case 13:if(Ee(Pe),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(U(340));Hr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ee(Pe),null;case 4:return Jr(),null;case 10:return Ac(t.type._context),null;case 22:case 23:return Jc(),null;case 24:return null;default:return null}}var $a=!1,et=!1,cy=typeof WeakSet=="function"?WeakSet:Set,H=null;function $r(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Le(e,t,r)}else n.current=null}function Al(e,t,n){try{n()}catch(r){Le(e,t,r)}}var bd=!1;function uy(e,t){if(gl=ii,e=Nf(),Ec(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var i=0,l=-1,c=-1,u=0,d=0,m=e,p=null;t:for(;;){for(var w;m!==n||s!==0&&m.nodeType!==3||(l=i+s),m!==a||r!==0&&m.nodeType!==3||(c=i+r),m.nodeType===3&&(i+=m.nodeValue.length),(w=m.firstChild)!==null;)p=m,m=w;for(;;){if(m===e)break t;if(p===n&&++u===s&&(l=i),p===a&&++d===r&&(c=i),(w=m.nextSibling)!==null)break;m=p,p=m.parentNode}m=w}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(vl={focusedElem:e,selectionRange:n},ii=!1,H=t;H!==null;)if(t=H,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,H=e;else for(;H!==null;){t=H;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var _=y.memoizedProps,b=y.memoizedState,f=t.stateNode,h=f.getSnapshotBeforeUpdate(t.elementType===t.type?_:Ut(t.type,_),b);f.__reactInternalSnapshotBeforeUpdate=h}break;case 3:var g=t.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(S){Le(t,t.return,S)}if(e=t.sibling,e!==null){e.return=t.return,H=e;break}H=t.return}return y=bd,bd=!1,y}function Ps(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var a=s.destroy;s.destroy=void 0,a!==void 0&&Al(t,n,a)}s=s.next}while(s!==r)}}function Mi(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Il(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function jp(e){var t=e.alternate;t!==null&&(e.alternate=null,jp(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Jt],delete t[Hs],delete t[_l],delete t[Kv],delete t[Hv])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function bp(e){return e.tag===5||e.tag===3||e.tag===4}function Sd(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||bp(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function $l(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=ci));else if(r!==4&&(e=e.child,e!==null))for($l(e,t,n),e=e.sibling;e!==null;)$l(e,t,n),e=e.sibling}function Ll(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Ll(e,t,n),e=e.sibling;e!==null;)Ll(e,t,n),e=e.sibling}var Ge=null,Ft=!1;function yn(e,t,n){for(n=n.child;n!==null;)Sp(e,t,n),n=n.sibling}function Sp(e,t,n){if(Qt&&typeof Qt.onCommitFiberUnmount=="function")try{Qt.onCommitFiberUnmount(Pi,n)}catch{}switch(n.tag){case 5:et||$r(n,t);case 6:var r=Ge,s=Ft;Ge=null,yn(e,t,n),Ge=r,Ft=s,Ge!==null&&(Ft?(e=Ge,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Ge.removeChild(n.stateNode));break;case 18:Ge!==null&&(Ft?(e=Ge,n=n.stateNode,e.nodeType===8?ko(e.parentNode,n):e.nodeType===1&&ko(e,n),Bs(e)):ko(Ge,n.stateNode));break;case 4:r=Ge,s=Ft,Ge=n.stateNode.containerInfo,Ft=!0,yn(e,t,n),Ge=r,Ft=s;break;case 0:case 11:case 14:case 15:if(!et&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var a=s,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&Al(n,t,i),s=s.next}while(s!==r)}yn(e,t,n);break;case 1:if(!et&&($r(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Le(n,t,l)}yn(e,t,n);break;case 21:yn(e,t,n);break;case 22:n.mode&1?(et=(r=et)||n.memoizedState!==null,yn(e,t,n),et=r):yn(e,t,n);break;default:yn(e,t,n)}}function kd(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new cy),t.forEach(function(r){var s=wy.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Lt(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var a=e,i=t,l=i;e:for(;l!==null;){switch(l.tag){case 5:Ge=l.stateNode,Ft=!1;break e;case 3:Ge=l.stateNode.containerInfo,Ft=!0;break e;case 4:Ge=l.stateNode.containerInfo,Ft=!0;break e}l=l.return}if(Ge===null)throw Error(U(160));Sp(a,i,s),Ge=null,Ft=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Le(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)kp(t,e),t=t.sibling}function kp(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Lt(t,e),Ht(e),r&4){try{Ps(3,e,e.return),Mi(3,e)}catch(_){Le(e,e.return,_)}try{Ps(5,e,e.return)}catch(_){Le(e,e.return,_)}}break;case 1:Lt(t,e),Ht(e),r&512&&n!==null&&$r(n,n.return);break;case 5:if(Lt(t,e),Ht(e),r&512&&n!==null&&$r(n,n.return),e.flags&32){var s=e.stateNode;try{Us(s,"")}catch(_){Le(e,e.return,_)}}if(r&4&&(s=e.stateNode,s!=null)){var a=e.memoizedProps,i=n!==null?n.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&Kh(s,a),il(l,i);var u=il(l,a);for(i=0;i<c.length;i+=2){var d=c[i],m=c[i+1];d==="style"?Yh(s,m):d==="dangerouslySetInnerHTML"?Jh(s,m):d==="children"?Us(s,m):pc(s,d,m,u)}switch(l){case"input":tl(s,a);break;case"textarea":Hh(s,a);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!a.multiple;var w=a.value;w!=null?Ur(s,!!a.multiple,w,!1):p!==!!a.multiple&&(a.defaultValue!=null?Ur(s,!!a.multiple,a.defaultValue,!0):Ur(s,!!a.multiple,a.multiple?[]:"",!1))}s[Hs]=a}catch(_){Le(e,e.return,_)}}break;case 6:if(Lt(t,e),Ht(e),r&4){if(e.stateNode===null)throw Error(U(162));s=e.stateNode,a=e.memoizedProps;try{s.nodeValue=a}catch(_){Le(e,e.return,_)}}break;case 3:if(Lt(t,e),Ht(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Bs(t.containerInfo)}catch(_){Le(e,e.return,_)}break;case 4:Lt(t,e),Ht(e);break;case 13:Lt(t,e),Ht(e),s=e.child,s.flags&8192&&(a=s.memoizedState!==null,s.stateNode.isHidden=a,!a||s.alternate!==null&&s.alternate.memoizedState!==null||(Hc=De())),r&4&&kd(e);break;case 22:if(d=n!==null&&n.memoizedState!==null,e.mode&1?(et=(u=et)||d,Lt(t,e),et=u):Lt(t,e),Ht(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(H=e,d=e.child;d!==null;){for(m=H=d;H!==null;){switch(p=H,w=p.child,p.tag){case 0:case 11:case 14:case 15:Ps(4,p,p.return);break;case 1:$r(p,p.return);var y=p.stateNode;if(typeof y.componentWillUnmount=="function"){r=p,n=p.return;try{t=r,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(_){Le(r,n,_)}}break;case 5:$r(p,p.return);break;case 22:if(p.memoizedState!==null){Ed(m);continue}}w!==null?(w.return=p,H=w):Ed(m)}d=d.sibling}e:for(d=null,m=e;;){if(m.tag===5){if(d===null){d=m;try{s=m.stateNode,u?(a=s.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=m.stateNode,c=m.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Qh("display",i))}catch(_){Le(e,e.return,_)}}}else if(m.tag===6){if(d===null)try{m.stateNode.nodeValue=u?"":m.memoizedProps}catch(_){Le(e,e.return,_)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;d===m&&(d=null),m=m.return}d===m&&(d=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:Lt(t,e),Ht(e),r&4&&kd(e);break;case 21:break;default:Lt(t,e),Ht(e)}}function Ht(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(bp(n)){var r=n;break e}n=n.return}throw Error(U(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Us(s,""),r.flags&=-33);var a=Sd(e);Ll(e,a,s);break;case 3:case 4:var i=r.stateNode.containerInfo,l=Sd(e);$l(e,l,i);break;default:throw Error(U(161))}}catch(c){Le(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function dy(e,t,n){H=e,Np(e)}function Np(e,t,n){for(var r=(e.mode&1)!==0;H!==null;){var s=H,a=s.child;if(s.tag===22&&r){var i=s.memoizedState!==null||$a;if(!i){var l=s.alternate,c=l!==null&&l.memoizedState!==null||et;l=$a;var u=et;if($a=i,(et=c)&&!u)for(H=s;H!==null;)i=H,c=i.child,i.tag===22&&i.memoizedState!==null?Cd(s):c!==null?(c.return=i,H=c):Cd(s);for(;a!==null;)H=a,Np(a),a=a.sibling;H=s,$a=l,et=u}Nd(e)}else s.subtreeFlags&8772&&a!==null?(a.return=s,H=a):Nd(e)}}function Nd(e){for(;H!==null;){var t=H;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:et||Mi(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!et)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:Ut(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&ud(t,a,r);break;case 3:var i=t.updateQueue;if(i!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}ud(t,i,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var m=d.dehydrated;m!==null&&Bs(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(U(163))}et||t.flags&512&&Il(t)}catch(p){Le(t,t.return,p)}}if(t===e){H=null;break}if(n=t.sibling,n!==null){n.return=t.return,H=n;break}H=t.return}}function Ed(e){for(;H!==null;){var t=H;if(t===e){H=null;break}var n=t.sibling;if(n!==null){n.return=t.return,H=n;break}H=t.return}}function Cd(e){for(;H!==null;){var t=H;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Mi(4,t)}catch(c){Le(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(c){Le(t,s,c)}}var a=t.return;try{Il(t)}catch(c){Le(t,a,c)}break;case 5:var i=t.return;try{Il(t)}catch(c){Le(t,i,c)}}}catch(c){Le(t,t.return,c)}if(t===e){H=null;break}var l=t.sibling;if(l!==null){l.return=t.return,H=l;break}H=t.return}}var hy=Math.ceil,_i=cn.ReactCurrentDispatcher,qc=cn.ReactCurrentOwner,Tt=cn.ReactCurrentBatchConfig,pe=0,qe=null,Me=null,Je=0,pt=0,Lr=Fn(0),Ve=0,Zs=null,or=0,Fi=0,Kc=0,Os=null,it=null,Hc=0,Yr=1/0,Xt=null,xi=!1,Dl=null,An=null,La=!1,Nn=null,ji=0,As=0,Ul=null,Xa=-1,Za=0;function rt(){return pe&6?De():Xa!==-1?Xa:Xa=De()}function In(e){return e.mode&1?pe&2&&Je!==0?Je&-Je:Jv.transition!==null?(Za===0&&(Za=uf()),Za):(e=_e,e!==0||(e=window.event,e=e===void 0?16:vf(e.type)),e):1}function qt(e,t,n,r){if(50<As)throw As=0,Ul=null,Error(U(185));ua(e,n,r),(!(pe&2)||e!==qe)&&(e===qe&&(!(pe&2)&&(Fi|=n),Ve===4&&bn(e,Je)),ut(e,r),n===1&&pe===0&&!(t.mode&1)&&(Yr=De()+500,Li&&zn()))}function ut(e,t){var n=e.callbackNode;Jg(e,t);var r=ai(e,e===qe?Je:0);if(r===0)n!==null&&Du(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Du(n),t===1)e.tag===0?Gv(Td.bind(null,e)):Lf(Td.bind(null,e)),Wv(function(){!(pe&6)&&zn()}),n=null;else{switch(df(r)){case 1:n=wc;break;case 4:n=lf;break;case 16:n=si;break;case 536870912:n=cf;break;default:n=si}n=Ip(n,Ep.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Ep(e,t){if(Xa=-1,Za=0,pe&6)throw Error(U(327));var n=e.callbackNode;if(Vr()&&e.callbackNode!==n)return null;var r=ai(e,e===qe?Je:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=bi(e,r);else{t=r;var s=pe;pe|=2;var a=Tp();(qe!==e||Je!==t)&&(Xt=null,Yr=De()+500,nr(e,t));do try{my();break}catch(l){Cp(e,l)}while(!0);Oc(),_i.current=a,pe=s,Me!==null?t=0:(qe=null,Je=0,t=Ve)}if(t!==0){if(t===2&&(s=dl(e),s!==0&&(r=s,t=Ml(e,s))),t===1)throw n=Zs,nr(e,0),bn(e,r),ut(e,De()),n;if(t===6)bn(e,r);else{if(s=e.current.alternate,!(r&30)&&!fy(s)&&(t=bi(e,r),t===2&&(a=dl(e),a!==0&&(r=a,t=Ml(e,a))),t===1))throw n=Zs,nr(e,0),bn(e,r),ut(e,De()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(U(345));case 2:Gn(e,it,Xt);break;case 3:if(bn(e,r),(r&130023424)===r&&(t=Hc+500-De(),10<t)){if(ai(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){rt(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=wl(Gn.bind(null,e,it,Xt),t);break}Gn(e,it,Xt);break;case 4:if(bn(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var i=31-Wt(r);a=1<<i,i=t[i],i>s&&(s=i),r&=~a}if(r=s,r=De()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*hy(r/1960))-r,10<r){e.timeoutHandle=wl(Gn.bind(null,e,it,Xt),r);break}Gn(e,it,Xt);break;case 5:Gn(e,it,Xt);break;default:throw Error(U(329))}}}return ut(e,De()),e.callbackNode===n?Ep.bind(null,e):null}function Ml(e,t){var n=Os;return e.current.memoizedState.isDehydrated&&(nr(e,t).flags|=256),e=bi(e,t),e!==2&&(t=it,it=n,t!==null&&Fl(t)),e}function Fl(e){it===null?it=e:it.push.apply(it,e)}function fy(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],a=s.getSnapshot;s=s.value;try{if(!Kt(a(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function bn(e,t){for(t&=~Kc,t&=~Fi,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Wt(t),r=1<<n;e[n]=-1,t&=~r}}function Td(e){if(pe&6)throw Error(U(327));Vr();var t=ai(e,0);if(!(t&1))return ut(e,De()),null;var n=bi(e,t);if(e.tag!==0&&n===2){var r=dl(e);r!==0&&(t=r,n=Ml(e,r))}if(n===1)throw n=Zs,nr(e,0),bn(e,t),ut(e,De()),n;if(n===6)throw Error(U(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Gn(e,it,Xt),ut(e,De()),null}function Gc(e,t){var n=pe;pe|=1;try{return e(t)}finally{pe=n,pe===0&&(Yr=De()+500,Li&&zn())}}function lr(e){Nn!==null&&Nn.tag===0&&!(pe&6)&&Vr();var t=pe;pe|=1;var n=Tt.transition,r=_e;try{if(Tt.transition=null,_e=1,e)return e()}finally{_e=r,Tt.transition=n,pe=t,!(pe&6)&&zn()}}function Jc(){pt=Lr.current,Ee(Lr)}function nr(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Vv(n)),Me!==null)for(n=Me.return;n!==null;){var r=n;switch(Tc(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ui();break;case 3:Jr(),Ee(lt),Ee(tt),Uc();break;case 5:Dc(r);break;case 4:Jr();break;case 13:Ee(Pe);break;case 19:Ee(Pe);break;case 10:Ac(r.type._context);break;case 22:case 23:Jc()}n=n.return}if(qe=e,Me=e=$n(e.current,null),Je=pt=t,Ve=0,Zs=null,Kc=Fi=or=0,it=Os=null,Zn!==null){for(t=0;t<Zn.length;t++)if(n=Zn[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,a=n.pending;if(a!==null){var i=a.next;a.next=s,r.next=i}n.pending=r}Zn=null}return e}function Cp(e,t){do{var n=Me;try{if(Oc(),Ja.current=wi,yi){for(var r=Oe.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}yi=!1}if(ir=0,We=Be=Oe=null,Rs=!1,Qs=0,qc.current=null,n===null||n.return===null){Ve=1,Zs=t,Me=null;break}e:{var a=e,i=n.return,l=n,c=t;if(t=Je,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,m=d.tag;if(!(d.mode&1)&&(m===0||m===11||m===15)){var p=d.alternate;p?(d.updateQueue=p.updateQueue,d.memoizedState=p.memoizedState,d.lanes=p.lanes):(d.updateQueue=null,d.memoizedState=null)}var w=gd(i);if(w!==null){w.flags&=-257,vd(w,i,l,a,t),w.mode&1&&md(a,u,t),t=w,c=u;var y=t.updateQueue;if(y===null){var _=new Set;_.add(c),t.updateQueue=_}else y.add(c);break e}else{if(!(t&1)){md(a,u,t),Qc();break e}c=Error(U(426))}}else if(Ce&&l.mode&1){var b=gd(i);if(b!==null){!(b.flags&65536)&&(b.flags|=256),vd(b,i,l,a,t),Rc(Qr(c,l));break e}}a=c=Qr(c,l),Ve!==4&&(Ve=2),Os===null?Os=[a]:Os.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var f=dp(a,c,t);cd(a,f);break e;case 1:l=c;var h=a.type,g=a.stateNode;if(!(a.flags&128)&&(typeof h.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(An===null||!An.has(g)))){a.flags|=65536,t&=-t,a.lanes|=t;var S=hp(a,l,t);cd(a,S);break e}}a=a.return}while(a!==null)}Pp(n)}catch(T){t=T,Me===n&&n!==null&&(Me=n=n.return);continue}break}while(!0)}function Tp(){var e=_i.current;return _i.current=wi,e===null?wi:e}function Qc(){(Ve===0||Ve===3||Ve===2)&&(Ve=4),qe===null||!(or&268435455)&&!(Fi&268435455)||bn(qe,Je)}function bi(e,t){var n=pe;pe|=2;var r=Tp();(qe!==e||Je!==t)&&(Xt=null,nr(e,t));do try{py();break}catch(s){Cp(e,s)}while(!0);if(Oc(),pe=n,_i.current=r,Me!==null)throw Error(U(261));return qe=null,Je=0,Ve}function py(){for(;Me!==null;)Rp(Me)}function my(){for(;Me!==null&&!Fg();)Rp(Me)}function Rp(e){var t=Ap(e.alternate,e,pt);e.memoizedProps=e.pendingProps,t===null?Pp(e):Me=t,qc.current=null}function Pp(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=ly(n,t),n!==null){n.flags&=32767,Me=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Ve=6,Me=null;return}}else if(n=oy(n,t,pt),n!==null){Me=n;return}if(t=t.sibling,t!==null){Me=t;return}Me=t=e}while(t!==null);Ve===0&&(Ve=5)}function Gn(e,t,n){var r=_e,s=Tt.transition;try{Tt.transition=null,_e=1,gy(e,t,n,r)}finally{Tt.transition=s,_e=r}return null}function gy(e,t,n,r){do Vr();while(Nn!==null);if(pe&6)throw Error(U(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(U(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(Qg(e,a),e===qe&&(Me=qe=null,Je=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||La||(La=!0,Ip(si,function(){return Vr(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=Tt.transition,Tt.transition=null;var i=_e;_e=1;var l=pe;pe|=4,qc.current=null,uy(e,n),kp(n,e),Lv(vl),ii=!!gl,vl=gl=null,e.current=n,dy(n),zg(),pe=l,_e=i,Tt.transition=a}else e.current=n;if(La&&(La=!1,Nn=e,ji=s),a=e.pendingLanes,a===0&&(An=null),Wg(n.stateNode),ut(e,De()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(xi)throw xi=!1,e=Dl,Dl=null,e;return ji&1&&e.tag!==0&&Vr(),a=e.pendingLanes,a&1?e===Ul?As++:(As=0,Ul=e):As=0,zn(),null}function Vr(){if(Nn!==null){var e=df(ji),t=Tt.transition,n=_e;try{if(Tt.transition=null,_e=16>e?16:e,Nn===null)var r=!1;else{if(e=Nn,Nn=null,ji=0,pe&6)throw Error(U(331));var s=pe;for(pe|=4,H=e.current;H!==null;){var a=H,i=a.child;if(H.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(H=u;H!==null;){var d=H;switch(d.tag){case 0:case 11:case 15:Ps(8,d,a)}var m=d.child;if(m!==null)m.return=d,H=m;else for(;H!==null;){d=H;var p=d.sibling,w=d.return;if(jp(d),d===u){H=null;break}if(p!==null){p.return=w,H=p;break}H=w}}}var y=a.alternate;if(y!==null){var _=y.child;if(_!==null){y.child=null;do{var b=_.sibling;_.sibling=null,_=b}while(_!==null)}}H=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,H=i;else e:for(;H!==null;){if(a=H,a.flags&2048)switch(a.tag){case 0:case 11:case 15:Ps(9,a,a.return)}var f=a.sibling;if(f!==null){f.return=a.return,H=f;break e}H=a.return}}var h=e.current;for(H=h;H!==null;){i=H;var g=i.child;if(i.subtreeFlags&2064&&g!==null)g.return=i,H=g;else e:for(i=h;H!==null;){if(l=H,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Mi(9,l)}}catch(T){Le(l,l.return,T)}if(l===i){H=null;break e}var S=l.sibling;if(S!==null){S.return=l.return,H=S;break e}H=l.return}}if(pe=s,zn(),Qt&&typeof Qt.onPostCommitFiberRoot=="function")try{Qt.onPostCommitFiberRoot(Pi,e)}catch{}r=!0}return r}finally{_e=n,Tt.transition=t}}return!1}function Rd(e,t,n){t=Qr(n,t),t=dp(e,t,1),e=On(e,t,1),t=rt(),e!==null&&(ua(e,1,t),ut(e,t))}function Le(e,t,n){if(e.tag===3)Rd(e,e,n);else for(;t!==null;){if(t.tag===3){Rd(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(An===null||!An.has(r))){e=Qr(n,e),e=hp(t,e,1),t=On(t,e,1),e=rt(),t!==null&&(ua(t,1,e),ut(t,e));break}}t=t.return}}function vy(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=rt(),e.pingedLanes|=e.suspendedLanes&n,qe===e&&(Je&n)===n&&(Ve===4||Ve===3&&(Je&130023424)===Je&&500>De()-Hc?nr(e,0):Kc|=n),ut(e,t)}function Op(e,t){t===0&&(e.mode&1?(t=Na,Na<<=1,!(Na&130023424)&&(Na=4194304)):t=1);var n=rt();e=on(e,t),e!==null&&(ua(e,t,n),ut(e,n))}function yy(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Op(e,n)}function wy(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(U(314))}r!==null&&r.delete(t),Op(e,n)}var Ap;Ap=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||lt.current)ot=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return ot=!1,iy(e,t,n);ot=!!(e.flags&131072)}else ot=!1,Ce&&t.flags&1048576&&Df(t,fi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ya(e,t),e=t.pendingProps;var s=Kr(t,tt.current);Br(t,n),s=Fc(null,t,r,e,s,n);var a=zc();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ct(r)?(a=!0,di(t)):a=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,$c(t),s.updater=Ui,t.stateNode=s,s._reactInternals=t,Nl(t,r,e,n),t=Tl(null,t,r,!0,a,n)):(t.tag=0,Ce&&a&&Cc(t),nt(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ya(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=xy(r),e=Ut(r,e),s){case 0:t=Cl(null,t,r,e,n);break e;case 1:t=_d(null,t,r,e,n);break e;case 11:t=yd(null,t,r,e,n);break e;case 14:t=wd(null,t,r,Ut(r.type,e),n);break e}throw Error(U(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ut(r,s),Cl(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ut(r,s),_d(e,t,r,s,n);case 3:e:{if(gp(t),e===null)throw Error(U(387));r=t.pendingProps,a=t.memoizedState,s=a.element,Vf(e,t),gi(t,r,null,n);var i=t.memoizedState;if(r=i.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){s=Qr(Error(U(423)),t),t=xd(e,t,r,n,s);break e}else if(r!==s){s=Qr(Error(U(424)),t),t=xd(e,t,r,n,s);break e}else for(yt=Pn(t.stateNode.containerInfo.firstChild),wt=t,Ce=!0,Bt=null,n=zf(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Hr(),r===s){t=ln(e,t,n);break e}nt(e,t,r,n)}t=t.child}return t;case 5:return Wf(t),e===null&&bl(t),r=t.type,s=t.pendingProps,a=e!==null?e.memoizedProps:null,i=s.children,yl(r,s)?i=null:a!==null&&yl(r,a)&&(t.flags|=32),mp(e,t),nt(e,t,i,n),t.child;case 6:return e===null&&bl(t),null;case 13:return vp(e,t,n);case 4:return Lc(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=Gr(t,null,r,n):nt(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ut(r,s),yd(e,t,r,s,n);case 7:return nt(e,t,t.pendingProps,n),t.child;case 8:return nt(e,t,t.pendingProps.children,n),t.child;case 12:return nt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,a=t.memoizedProps,i=s.value,ke(pi,r._currentValue),r._currentValue=i,a!==null)if(Kt(a.value,i)){if(a.children===s.children&&!lt.current){t=ln(e,t,n);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var l=a.dependencies;if(l!==null){i=a.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(a.tag===1){c=rn(-1,n&-n),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=n,c=a.alternate,c!==null&&(c.lanes|=n),Sl(a.return,n,t),l.lanes|=n;break}c=c.next}}else if(a.tag===10)i=a.type===t.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(U(341));i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),Sl(i,n,t),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===t){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}nt(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,Br(t,n),s=Rt(s),r=r(s),t.flags|=1,nt(e,t,r,n),t.child;case 14:return r=t.type,s=Ut(r,t.pendingProps),s=Ut(r.type,s),wd(e,t,r,s,n);case 15:return fp(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ut(r,s),Ya(e,t),t.tag=1,ct(r)?(e=!0,di(t)):e=!1,Br(t,n),up(t,r,s),Nl(t,r,s,n),Tl(null,t,r,!0,e,n);case 19:return yp(e,t,n);case 22:return pp(e,t,n)}throw Error(U(156,t.tag))};function Ip(e,t){return of(e,t)}function _y(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ct(e,t,n,r){return new _y(e,t,n,r)}function Yc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function xy(e){if(typeof e=="function")return Yc(e)?1:0;if(e!=null){if(e=e.$$typeof,e===gc)return 11;if(e===vc)return 14}return 2}function $n(e,t){var n=e.alternate;return n===null?(n=Ct(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ei(e,t,n,r,s,a){var i=2;if(r=e,typeof e=="function")Yc(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Nr:return rr(n.children,s,a,t);case mc:i=8,s|=8;break;case Qo:return e=Ct(12,n,t,s|2),e.elementType=Qo,e.lanes=a,e;case Yo:return e=Ct(13,n,t,s),e.elementType=Yo,e.lanes=a,e;case Xo:return e=Ct(19,n,t,s),e.elementType=Xo,e.lanes=a,e;case Vh:return zi(n,s,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case zh:i=10;break e;case Bh:i=9;break e;case gc:i=11;break e;case vc:i=14;break e;case wn:i=16,r=null;break e}throw Error(U(130,e==null?e:typeof e,""))}return t=Ct(i,n,t,s),t.elementType=e,t.type=r,t.lanes=a,t}function rr(e,t,n,r){return e=Ct(7,e,r,t),e.lanes=n,e}function zi(e,t,n,r){return e=Ct(22,e,r,t),e.elementType=Vh,e.lanes=n,e.stateNode={isHidden:!1},e}function Ao(e,t,n){return e=Ct(6,e,null,t),e.lanes=n,e}function Io(e,t,n){return t=Ct(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function jy(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=po(0),this.expirationTimes=po(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=po(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Xc(e,t,n,r,s,a,i,l,c){return e=new jy(e,t,n,l,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=Ct(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},$c(a),e}function by(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:kr,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function $p(e){if(!e)return Un;e=e._reactInternals;e:{if(ur(e)!==e||e.tag!==1)throw Error(U(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ct(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(U(171))}if(e.tag===1){var n=e.type;if(ct(n))return $f(e,n,t)}return t}function Lp(e,t,n,r,s,a,i,l,c){return e=Xc(n,r,!0,e,s,a,i,l,c),e.context=$p(null),n=e.current,r=rt(),s=In(n),a=rn(r,s),a.callback=t??null,On(n,a,s),e.current.lanes=s,ua(e,s,r),ut(e,r),e}function Bi(e,t,n,r){var s=t.current,a=rt(),i=In(s);return n=$p(n),t.context===null?t.context=n:t.pendingContext=n,t=rn(a,i),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=On(s,t,i),e!==null&&(qt(e,s,i,a),Ga(e,s,i)),i}function Si(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Pd(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Zc(e,t){Pd(e,t),(e=e.alternate)&&Pd(e,t)}function Sy(){return null}var Dp=typeof reportError=="function"?reportError:function(e){console.error(e)};function eu(e){this._internalRoot=e}Vi.prototype.render=eu.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(U(409));Bi(e,t,null,null)};Vi.prototype.unmount=eu.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;lr(function(){Bi(null,e,null,null)}),t[an]=null}};function Vi(e){this._internalRoot=e}Vi.prototype.unstable_scheduleHydration=function(e){if(e){var t=pf();e={blockedOn:null,target:e,priority:t};for(var n=0;n<jn.length&&t!==0&&t<jn[n].priority;n++);jn.splice(n,0,e),n===0&&gf(e)}};function tu(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Wi(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Od(){}function ky(e,t,n,r,s){if(s){if(typeof r=="function"){var a=r;r=function(){var u=Si(i);a.call(u)}}var i=Lp(t,r,e,0,null,!1,!1,"",Od);return e._reactRootContainer=i,e[an]=i.current,qs(e.nodeType===8?e.parentNode:e),lr(),i}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=Si(c);l.call(u)}}var c=Xc(e,0,!1,null,null,!1,!1,"",Od);return e._reactRootContainer=c,e[an]=c.current,qs(e.nodeType===8?e.parentNode:e),lr(function(){Bi(t,c,n,r)}),c}function qi(e,t,n,r,s){var a=n._reactRootContainer;if(a){var i=a;if(typeof s=="function"){var l=s;s=function(){var c=Si(i);l.call(c)}}Bi(t,i,e,s)}else i=ky(n,t,e,s,r);return Si(i)}hf=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=js(t.pendingLanes);n!==0&&(_c(t,n|1),ut(t,De()),!(pe&6)&&(Yr=De()+500,zn()))}break;case 13:lr(function(){var r=on(e,1);if(r!==null){var s=rt();qt(r,e,1,s)}}),Zc(e,1)}};xc=function(e){if(e.tag===13){var t=on(e,134217728);if(t!==null){var n=rt();qt(t,e,134217728,n)}Zc(e,134217728)}};ff=function(e){if(e.tag===13){var t=In(e),n=on(e,t);if(n!==null){var r=rt();qt(n,e,t,r)}Zc(e,t)}};pf=function(){return _e};mf=function(e,t){var n=_e;try{return _e=e,t()}finally{_e=n}};ll=function(e,t,n){switch(t){case"input":if(tl(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=$i(r);if(!s)throw Error(U(90));qh(r),tl(r,s)}}}break;case"textarea":Hh(e,n);break;case"select":t=n.value,t!=null&&Ur(e,!!n.multiple,t,!1)}};ef=Gc;tf=lr;var Ny={usingClientEntryPoint:!1,Events:[ha,Rr,$i,Xh,Zh,Gc]},ys={findFiberByHostInstance:Xn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Ey={bundleType:ys.bundleType,version:ys.version,rendererPackageName:ys.rendererPackageName,rendererConfig:ys.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:cn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=sf(e),e===null?null:e.stateNode},findFiberByHostInstance:ys.findFiberByHostInstance||Sy,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Da=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Da.isDisabled&&Da.supportsFiber)try{Pi=Da.inject(Ey),Qt=Da}catch{}}xt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ny;xt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!tu(t))throw Error(U(200));return by(e,t,null,n)};xt.createRoot=function(e,t){if(!tu(e))throw Error(U(299));var n=!1,r="",s=Dp;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=Xc(e,1,!1,null,null,n,!1,r,s),e[an]=t.current,qs(e.nodeType===8?e.parentNode:e),new eu(t)};xt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(U(188)):(e=Object.keys(e).join(","),Error(U(268,e)));return e=sf(t),e=e===null?null:e.stateNode,e};xt.flushSync=function(e){return lr(e)};xt.hydrate=function(e,t,n){if(!Wi(t))throw Error(U(200));return qi(null,e,t,!0,n)};xt.hydrateRoot=function(e,t,n){if(!tu(e))throw Error(U(405));var r=n!=null&&n.hydratedSources||null,s=!1,a="",i=Dp;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),t=Lp(t,null,e,1,n??null,s,!1,a,i),e[an]=t.current,qs(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Vi(t)};xt.render=function(e,t,n){if(!Wi(t))throw Error(U(200));return qi(null,e,t,!1,n)};xt.unmountComponentAtNode=function(e){if(!Wi(e))throw Error(U(40));return e._reactRootContainer?(lr(function(){qi(null,null,e,!1,function(){e._reactRootContainer=null,e[an]=null})}),!0):!1};xt.unstable_batchedUpdates=Gc;xt.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Wi(n))throw Error(U(200));if(e==null||e._reactInternals===void 0)throw Error(U(38));return qi(e,t,n,!1,r)};xt.version="18.3.1-next-f1338f8080-20240426";function Up(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Up)}catch(e){console.error(e)}}Up(),Dh.exports=xt;var Cy=Dh.exports,Ad=Cy;Go.createRoot=Ad.createRoot,Go.hydrateRoot=Ad.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ea(){return ea=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ea.apply(this,arguments)}var En;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(En||(En={}));const Id="popstate";function Ty(e){e===void 0&&(e={});function t(r,s){let{pathname:a,search:i,hash:l}=r.location;return zl("",{pathname:a,search:i,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:ki(s)}return Py(t,n,null,e)}function Ae(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function nu(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Ry(){return Math.random().toString(36).substr(2,8)}function $d(e,t){return{usr:e.state,key:e.key,idx:t}}function zl(e,t,n,r){return n===void 0&&(n=null),ea({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?rs(t):t,{state:n,key:t&&t.key||r||Ry()})}function ki(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function rs(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function Py(e,t,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:a=!1}=r,i=s.history,l=En.Pop,c=null,u=d();u==null&&(u=0,i.replaceState(ea({},i.state,{idx:u}),""));function d(){return(i.state||{idx:null}).idx}function m(){l=En.Pop;let b=d(),f=b==null?null:b-u;u=b,c&&c({action:l,location:_.location,delta:f})}function p(b,f){l=En.Push;let h=zl(_.location,b,f);u=d()+1;let g=$d(h,u),S=_.createHref(h);try{i.pushState(g,"",S)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;s.location.assign(S)}a&&c&&c({action:l,location:_.location,delta:1})}function w(b,f){l=En.Replace;let h=zl(_.location,b,f);u=d();let g=$d(h,u),S=_.createHref(h);i.replaceState(g,"",S),a&&c&&c({action:l,location:_.location,delta:0})}function y(b){let f=s.location.origin!=="null"?s.location.origin:s.location.href,h=typeof b=="string"?b:ki(b);return h=h.replace(/ $/,"%20"),Ae(f,"No window.location.(origin|href) available to create URL for href: "+h),new URL(h,f)}let _={get action(){return l},get location(){return e(s,i)},listen(b){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(Id,m),c=b,()=>{s.removeEventListener(Id,m),c=null}},createHref(b){return t(s,b)},createURL:y,encodeLocation(b){let f=y(b);return{pathname:f.pathname,search:f.search,hash:f.hash}},push:p,replace:w,go(b){return i.go(b)}};return _}var Ld;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Ld||(Ld={}));function Oy(e,t,n){return n===void 0&&(n="/"),Ay(e,t,n)}function Ay(e,t,n,r){let s=typeof t=="string"?rs(t):t,a=Xr(s.pathname||"/",n);if(a==null)return null;let i=Mp(e);Iy(i);let l=null;for(let c=0;l==null&&c<i.length;++c){let u=qy(a);l=Vy(i[c],u)}return l}function Mp(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(a,i,l)=>{let c={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:i,route:a};c.relativePath.startsWith("/")&&(Ae(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=Ln([r,c.relativePath]),d=n.concat(c);a.children&&a.children.length>0&&(Ae(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),Mp(a.children,t,d,u)),!(a.path==null&&!a.index)&&t.push({path:u,score:zy(u,a.index),routesMeta:d})};return e.forEach((a,i)=>{var l;if(a.path===""||!((l=a.path)!=null&&l.includes("?")))s(a,i);else for(let c of Fp(a.path))s(a,i,c)}),t}function Fp(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,s=n.endsWith("?"),a=n.replace(/\?$/,"");if(r.length===0)return s?[a,""]:[a];let i=Fp(r.join("/")),l=[];return l.push(...i.map(c=>c===""?a:[a,c].join("/"))),s&&l.push(...i),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function Iy(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:By(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const $y=/^:[\w-]+$/,Ly=3,Dy=2,Uy=1,My=10,Fy=-2,Dd=e=>e==="*";function zy(e,t){let n=e.split("/"),r=n.length;return n.some(Dd)&&(r+=Fy),t&&(r+=Dy),n.filter(s=>!Dd(s)).reduce((s,a)=>s+($y.test(a)?Ly:a===""?Uy:My),r)}function By(e,t){return e.length===t.length&&e.slice(0,-1).every((r,s)=>r===t[s])?e[e.length-1]-t[t.length-1]:0}function Vy(e,t,n){let{routesMeta:r}=e,s={},a="/",i=[];for(let l=0;l<r.length;++l){let c=r[l],u=l===r.length-1,d=a==="/"?t:t.slice(a.length)||"/",m=Bl({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),p=c.route;if(!m)return null;Object.assign(s,m.params),i.push({params:s,pathname:Ln([a,m.pathname]),pathnameBase:Qy(Ln([a,m.pathnameBase])),route:p}),m.pathnameBase!=="/"&&(a=Ln([a,m.pathnameBase]))}return i}function Bl(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=Wy(e.path,e.caseSensitive,e.end),s=t.match(n);if(!s)return null;let a=s[0],i=a.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,d,m)=>{let{paramName:p,isOptional:w}=d;if(p==="*"){let _=l[m]||"";i=a.slice(0,a.length-_.length).replace(/(.)\/+$/,"$1")}const y=l[m];return w&&!y?u[p]=void 0:u[p]=(y||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:i,pattern:e}}function Wy(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),nu(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),r]}function qy(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return nu(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Xr(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}const Ky=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Hy=e=>Ky.test(e);function Gy(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:s=""}=typeof e=="string"?rs(e):e,a;if(n)if(Hy(n))a=n;else{if(n.includes("//")){let i=n;n=n.replace(/\/\/+/g,"/"),nu(!1,"Pathnames cannot have embedded double slashes - normalizing "+(i+" -> "+n))}n.startsWith("/")?a=Ud(n.substring(1),"/"):a=Ud(n,t)}else a=t;return{pathname:a,search:Yy(r),hash:Xy(s)}}function Ud(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function $o(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Jy(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function ru(e,t){let n=Jy(e);return t?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function su(e,t,n,r){r===void 0&&(r=!1);let s;typeof e=="string"?s=rs(e):(s=ea({},e),Ae(!s.pathname||!s.pathname.includes("?"),$o("?","pathname","search",s)),Ae(!s.pathname||!s.pathname.includes("#"),$o("#","pathname","hash",s)),Ae(!s.search||!s.search.includes("#"),$o("#","search","hash",s)));let a=e===""||s.pathname==="",i=a?"/":s.pathname,l;if(i==null)l=n;else{let m=t.length-1;if(!r&&i.startsWith("..")){let p=i.split("/");for(;p[0]==="..";)p.shift(),m-=1;s.pathname=p.join("/")}l=m>=0?t[m]:"/"}let c=Gy(s,l),u=i&&i!=="/"&&i.endsWith("/"),d=(a||i===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Ln=e=>e.join("/").replace(/\/\/+/g,"/"),Qy=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Yy=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Xy=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function Zy(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const zp=["post","put","patch","delete"];new Set(zp);const e0=["get",...zp];new Set(e0);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ta(){return ta=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ta.apply(this,arguments)}const Ki=x.createContext(null),Bp=x.createContext(null),un=x.createContext(null),Hi=x.createContext(null),dn=x.createContext({outlet:null,matches:[],isDataRoute:!1}),Vp=x.createContext(null);function t0(e,t){let{relative:n}=t===void 0?{}:t;ss()||Ae(!1);let{basename:r,navigator:s}=x.useContext(un),{hash:a,pathname:i,search:l}=Ji(e,{relative:n}),c=i;return r!=="/"&&(c=i==="/"?r:Ln([r,i])),s.createHref({pathname:c,search:l,hash:a})}function ss(){return x.useContext(Hi)!=null}function dr(){return ss()||Ae(!1),x.useContext(Hi).location}function Wp(e){x.useContext(un).static||x.useLayoutEffect(e)}function Gi(){let{isDataRoute:e}=x.useContext(dn);return e?g0():n0()}function n0(){ss()||Ae(!1);let e=x.useContext(Ki),{basename:t,future:n,navigator:r}=x.useContext(un),{matches:s}=x.useContext(dn),{pathname:a}=dr(),i=JSON.stringify(ru(s,n.v7_relativeSplatPath)),l=x.useRef(!1);return Wp(()=>{l.current=!0}),x.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){r.go(u);return}let m=su(u,JSON.parse(i),a,d.relative==="path");e==null&&t!=="/"&&(m.pathname=m.pathname==="/"?t:Ln([t,m.pathname])),(d.replace?r.replace:r.push)(m,d.state,d)},[t,r,i,a,e])}const r0=x.createContext(null);function s0(e){let t=x.useContext(dn).outlet;return t&&x.createElement(r0.Provider,{value:e},t)}function Ji(e,t){let{relative:n}=t===void 0?{}:t,{future:r}=x.useContext(un),{matches:s}=x.useContext(dn),{pathname:a}=dr(),i=JSON.stringify(ru(s,r.v7_relativeSplatPath));return x.useMemo(()=>su(e,JSON.parse(i),a,n==="path"),[e,i,a,n])}function a0(e,t){return i0(e,t)}function i0(e,t,n,r){ss()||Ae(!1);let{navigator:s}=x.useContext(un),{matches:a}=x.useContext(dn),i=a[a.length-1],l=i?i.params:{};i&&i.pathname;let c=i?i.pathnameBase:"/";i&&i.route;let u=dr(),d;if(t){var m;let b=typeof t=="string"?rs(t):t;c==="/"||(m=b.pathname)!=null&&m.startsWith(c)||Ae(!1),d=b}else d=u;let p=d.pathname||"/",w=p;if(c!=="/"){let b=c.replace(/^\//,"").split("/");w="/"+p.replace(/^\//,"").split("/").slice(b.length).join("/")}let y=Oy(e,{pathname:w}),_=d0(y&&y.map(b=>Object.assign({},b,{params:Object.assign({},l,b.params),pathname:Ln([c,s.encodeLocation?s.encodeLocation(b.pathname).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?c:Ln([c,s.encodeLocation?s.encodeLocation(b.pathnameBase).pathname:b.pathnameBase])})),a,n,r);return t&&_?x.createElement(Hi.Provider,{value:{location:ta({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:En.Pop}},_):_}function o0(){let e=m0(),t=Zy(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return x.createElement(x.Fragment,null,x.createElement("h2",null,"Unexpected Application Error!"),x.createElement("h3",{style:{fontStyle:"italic"}},t),n?x.createElement("pre",{style:s},n):null,null)}const l0=x.createElement(o0,null);class c0 extends x.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?x.createElement(dn.Provider,{value:this.props.routeContext},x.createElement(Vp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function u0(e){let{routeContext:t,match:n,children:r}=e,s=x.useContext(Ki);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),x.createElement(dn.Provider,{value:t},r)}function d0(e,t,n,r){var s;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var a;if(!n)return null;if(n.errors)e=n.matches;else if((a=r)!=null&&a.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let i=e,l=(s=n)==null?void 0:s.errors;if(l!=null){let d=i.findIndex(m=>m.route.id&&(l==null?void 0:l[m.route.id])!==void 0);d>=0||Ae(!1),i=i.slice(0,Math.min(i.length,d+1))}let c=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<i.length;d++){let m=i[d];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(u=d),m.route.id){let{loaderData:p,errors:w}=n,y=m.route.loader&&p[m.route.id]===void 0&&(!w||w[m.route.id]===void 0);if(m.route.lazy||y){c=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}return i.reduceRight((d,m,p)=>{let w,y=!1,_=null,b=null;n&&(w=l&&m.route.id?l[m.route.id]:void 0,_=m.route.errorElement||l0,c&&(u<0&&p===0?(v0("route-fallback"),y=!0,b=null):u===p&&(y=!0,b=m.route.hydrateFallbackElement||null)));let f=t.concat(i.slice(0,p+1)),h=()=>{let g;return w?g=_:y?g=b:m.route.Component?g=x.createElement(m.route.Component,null):m.route.element?g=m.route.element:g=d,x.createElement(u0,{match:m,routeContext:{outlet:d,matches:f,isDataRoute:n!=null},children:g})};return n&&(m.route.ErrorBoundary||m.route.errorElement||p===0)?x.createElement(c0,{location:n.location,revalidation:n.revalidation,component:_,error:w,children:h(),routeContext:{outlet:null,matches:f,isDataRoute:!0}}):h()},null)}var qp=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(qp||{}),Kp=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Kp||{});function h0(e){let t=x.useContext(Ki);return t||Ae(!1),t}function f0(e){let t=x.useContext(Bp);return t||Ae(!1),t}function p0(e){let t=x.useContext(dn);return t||Ae(!1),t}function Hp(e){let t=p0(),n=t.matches[t.matches.length-1];return n.route.id||Ae(!1),n.route.id}function m0(){var e;let t=x.useContext(Vp),n=f0(),r=Hp();return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function g0(){let{router:e}=h0(qp.UseNavigateStable),t=Hp(Kp.UseNavigateStable),n=x.useRef(!1);return Wp(()=>{n.current=!0}),x.useCallback(function(s,a){a===void 0&&(a={}),n.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,ta({fromRouteId:t},a)))},[e,t])}const Md={};function v0(e,t,n){Md[e]||(Md[e]=!0)}function y0(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Vl(e){let{to:t,replace:n,state:r,relative:s}=e;ss()||Ae(!1);let{future:a,static:i}=x.useContext(un),{matches:l}=x.useContext(dn),{pathname:c}=dr(),u=Gi(),d=su(t,ru(l,a.v7_relativeSplatPath),c,s==="path"),m=JSON.stringify(d);return x.useEffect(()=>u(JSON.parse(m),{replace:n,state:r,relative:s}),[u,m,s,n,r]),null}function w0(e){return s0(e.context)}function ht(e){Ae(!1)}function _0(e){let{basename:t="/",children:n=null,location:r,navigationType:s=En.Pop,navigator:a,static:i=!1,future:l}=e;ss()&&Ae(!1);let c=t.replace(/^\/*/,"/"),u=x.useMemo(()=>({basename:c,navigator:a,static:i,future:ta({v7_relativeSplatPath:!1},l)}),[c,l,a,i]);typeof r=="string"&&(r=rs(r));let{pathname:d="/",search:m="",hash:p="",state:w=null,key:y="default"}=r,_=x.useMemo(()=>{let b=Xr(d,c);return b==null?null:{location:{pathname:b,search:m,hash:p,state:w,key:y},navigationType:s}},[c,d,m,p,w,y,s]);return _==null?null:x.createElement(un.Provider,{value:u},x.createElement(Hi.Provider,{children:n,value:_}))}function x0(e){let{children:t,location:n}=e;return a0(Wl(t),n)}new Promise(()=>{});function Wl(e,t){t===void 0&&(t=[]);let n=[];return x.Children.forEach(e,(r,s)=>{if(!x.isValidElement(r))return;let a=[...t,s];if(r.type===x.Fragment){n.push.apply(n,Wl(r.props.children,a));return}r.type!==ht&&Ae(!1),!r.props.index||!r.props.children||Ae(!1);let i={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(i.children=Wl(r.props.children,a)),n.push(i)}),n}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ni(){return Ni=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ni.apply(this,arguments)}function Gp(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,a;for(a=0;a<r.length;a++)s=r[a],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function j0(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function b0(e,t){return e.button===0&&(!t||t==="_self")&&!j0(e)}function ql(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function S0(e,t){let n=ql(e);return t&&t.forEach((r,s)=>{n.has(s)||t.getAll(s).forEach(a=>{n.append(s,a)})}),n}const k0=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],N0=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],E0="6";try{window.__reactRouterVersion=E0}catch{}const C0=x.createContext({isTransitioning:!1}),T0="startTransition",Fd=vg[T0];function R0(e){let{basename:t,children:n,future:r,window:s}=e,a=x.useRef();a.current==null&&(a.current=Ty({window:s,v5Compat:!0}));let i=a.current,[l,c]=x.useState({action:i.action,location:i.location}),{v7_startTransition:u}=r||{},d=x.useCallback(m=>{u&&Fd?Fd(()=>c(m)):c(m)},[c,u]);return x.useLayoutEffect(()=>i.listen(d),[i,d]),x.useEffect(()=>y0(r),[r]),x.createElement(_0,{basename:t,children:n,location:l.location,navigationType:l.action,navigator:i,future:r})}const P0=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",O0=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,au=x.forwardRef(function(t,n){let{onClick:r,relative:s,reloadDocument:a,replace:i,state:l,target:c,to:u,preventScrollReset:d,viewTransition:m}=t,p=Gp(t,k0),{basename:w}=x.useContext(un),y,_=!1;if(typeof u=="string"&&O0.test(u)&&(y=u,P0))try{let g=new URL(window.location.href),S=u.startsWith("//")?new URL(g.protocol+u):new URL(u),T=Xr(S.pathname,w);S.origin===g.origin&&T!=null?u=T+S.search+S.hash:_=!0}catch{}let b=t0(u,{relative:s}),f=I0(u,{replace:i,state:l,target:c,preventScrollReset:d,relative:s,viewTransition:m});function h(g){r&&r(g),g.defaultPrevented||f(g)}return x.createElement("a",Ni({},p,{href:y||b,onClick:_||a?r:h,ref:n,target:c}))}),zd=x.forwardRef(function(t,n){let{"aria-current":r="page",caseSensitive:s=!1,className:a="",end:i=!1,style:l,to:c,viewTransition:u,children:d}=t,m=Gp(t,N0),p=Ji(c,{relative:m.relative}),w=dr(),y=x.useContext(Bp),{navigator:_,basename:b}=x.useContext(un),f=y!=null&&L0(p)&&u===!0,h=_.encodeLocation?_.encodeLocation(p).pathname:p.pathname,g=w.pathname,S=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;s||(g=g.toLowerCase(),S=S?S.toLowerCase():null,h=h.toLowerCase()),S&&b&&(S=Xr(S,b)||S);const T=h!=="/"&&h.endsWith("/")?h.length-1:h.length;let k=g===h||!i&&g.startsWith(h)&&g.charAt(T)==="/",P=S!=null&&(S===h||!i&&S.startsWith(h)&&S.charAt(h.length)==="/"),O={isActive:k,isPending:P,isTransitioning:f},M=k?r:void 0,z;typeof a=="function"?z=a(O):z=[a,k?"active":null,P?"pending":null,f?"transitioning":null].filter(Boolean).join(" ");let J=typeof l=="function"?l(O):l;return x.createElement(au,Ni({},m,{"aria-current":M,className:z,ref:n,style:J,to:c,viewTransition:u}),typeof d=="function"?d(O):d)});var Kl;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Kl||(Kl={}));var Bd;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Bd||(Bd={}));function A0(e){let t=x.useContext(Ki);return t||Ae(!1),t}function I0(e,t){let{target:n,replace:r,state:s,preventScrollReset:a,relative:i,viewTransition:l}=t===void 0?{}:t,c=Gi(),u=dr(),d=Ji(e,{relative:i});return x.useCallback(m=>{if(b0(m,n)){m.preventDefault();let p=r!==void 0?r:ki(u)===ki(d);c(e,{replace:p,state:s,preventScrollReset:a,relative:i,viewTransition:l})}},[u,c,d,r,s,n,e,a,i,l])}function $0(e){let t=x.useRef(ql(e)),n=x.useRef(!1),r=dr(),s=x.useMemo(()=>S0(r.search,n.current?null:t.current),[r.search]),a=Gi(),i=x.useCallback((l,c)=>{const u=ql(typeof l=="function"?l(s):l);n.current=!0,a("?"+u,c)},[a,s]);return[s,i]}function L0(e,t){t===void 0&&(t={});let n=x.useContext(C0);n==null&&Ae(!1);let{basename:r}=A0(Kl.useViewTransitionState),s=Ji(e,{relative:t.relative});if(!n.isTransitioning)return!1;let a=Xr(n.currentLocation.pathname,r)||n.currentLocation.pathname,i=Xr(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Bl(s.pathname,i)!=null||Bl(s.pathname,a)!=null}function Qi(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n}function D0(e,t,n,r){function s(a){return a instanceof n?a:new n(function(i){i(a)})}return new(n||(n=Promise))(function(a,i){function l(d){try{u(r.next(d))}catch(m){i(m)}}function c(d){try{u(r.throw(d))}catch(m){i(m)}}function u(d){d.done?a(d.value):s(d.value).then(l,c)}u((r=r.apply(e,t||[])).next())})}const U0=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class iu extends Error{constructor(t,n="FunctionsError",r){super(t),this.name=n,this.context=r}}class M0 extends iu{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class Vd extends iu{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class Wd extends iu{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Hl;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Hl||(Hl={}));class F0{constructor(t,{headers:n={},customFetch:r,region:s=Hl.Any}={}){this.url=t,this.headers=n,this.region=s,this.fetch=U0(r)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return D0(this,arguments,void 0,function*(n,r={}){var s;let a,i;try{const{headers:l,method:c,body:u,signal:d,timeout:m}=r;let p={},{region:w}=r;w||(w=this.region);const y=new URL(`${this.url}/${n}`);w&&w!=="any"&&(p["x-region"]=w,y.searchParams.set("forceFunctionRegion",w));let _;u&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&u instanceof Blob||u instanceof ArrayBuffer?(p["Content-Type"]="application/octet-stream",_=u):typeof u=="string"?(p["Content-Type"]="text/plain",_=u):typeof FormData<"u"&&u instanceof FormData?_=u:(p["Content-Type"]="application/json",_=JSON.stringify(u)):_=u;let b=d;m&&(i=new AbortController,a=setTimeout(()=>i.abort(),m),d?(b=i.signal,d.addEventListener("abort",()=>i.abort())):b=i.signal);const f=yield this.fetch(y.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},p),this.headers),l),body:_,signal:b}).catch(T=>{throw new M0(T)}),h=f.headers.get("x-relay-error");if(h&&h==="true")throw new Vd(f);if(!f.ok)throw new Wd(f);let g=((s=f.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),S;return g==="application/json"?S=yield f.json():g==="application/octet-stream"||g==="application/pdf"?S=yield f.blob():g==="text/event-stream"?S=f:g==="multipart/form-data"?S=yield f.formData():S=yield f.text(),{data:S,error:null,response:f}}catch(l){return{data:null,error:l,response:l instanceof Wd||l instanceof Vd?l.context:void 0}}finally{a&&clearTimeout(a)}})}}var z0=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},B0=class{constructor(e){var t,n;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(n=e.isMaybeSingle)!==null&&n!==void 0?n:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var n=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const r=this.fetch;let s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async a=>{let i=null,l=null,c=null,u=a.status,d=a.statusText;if(a.ok){var m,p;if(n.method!=="HEAD"){var w;const f=await a.text();f===""||(n.headers.get("Accept")==="text/csv"||n.headers.get("Accept")&&(!((w=n.headers.get("Accept"))===null||w===void 0)&&w.includes("application/vnd.pgrst.plan+text"))?l=f:l=JSON.parse(f))}const _=(m=n.headers.get("Prefer"))===null||m===void 0?void 0:m.match(/count=(exact|planned|estimated)/),b=(p=a.headers.get("content-range"))===null||p===void 0?void 0:p.split("/");_&&b&&b.length>1&&(c=parseInt(b[1])),n.isMaybeSingle&&n.method==="GET"&&Array.isArray(l)&&(l.length>1?(i={code:"PGRST116",details:`Results contain ${l.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},l=null,c=null,u=406,d="Not Acceptable"):l.length===1?l=l[0]:l=null)}else{var y;const _=await a.text();try{i=JSON.parse(_),Array.isArray(i)&&a.status===404&&(l=[],i=null,u=200,d="OK")}catch{a.status===404&&_===""?(u=204,d="No Content"):i={message:_}}if(i&&n.isMaybeSingle&&(!(i==null||(y=i.details)===null||y===void 0)&&y.includes("0 rows"))&&(i=null,u=200,d="OK"),i&&n.shouldThrowOnError)throw new z0(i)}return{error:i,data:l,count:c,status:u,statusText:d}});return this.shouldThrowOnError||(s=s.catch(a=>{var i;let l="";const c=a==null?void 0:a.cause;if(c){var u,d,m,p;const y=(u=c==null?void 0:c.message)!==null&&u!==void 0?u:"",_=(d=c==null?void 0:c.code)!==null&&d!==void 0?d:"";l=`${(m=a==null?void 0:a.name)!==null&&m!==void 0?m:"FetchError"}: ${a==null?void 0:a.message}`,l+=`

Caused by: ${(p=c==null?void 0:c.name)!==null&&p!==void 0?p:"Error"}: ${y}`,_&&(l+=` (${_})`),c!=null&&c.stack&&(l+=`
${c.stack}`)}else{var w;l=(w=a==null?void 0:a.stack)!==null&&w!==void 0?w:""}return{error:{message:`${(i=a==null?void 0:a.name)!==null&&i!==void 0?i:"FetchError"}: ${a==null?void 0:a.message}`,details:l,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}},V0=class extends B0{select(e){let t=!1;const n=(e??"*").split("").map(r=>/\s/.test(r)&&!t?"":(r==='"'&&(t=!t),r)).join("");return this.url.searchParams.set("select",n),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:n,foreignTable:r,referencedTable:s=r}={}){const a=s?`${s}.order`:"order",i=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${i?`${i},`:""}${e}.${t?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:n=t}={}){const r=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:n,referencedTable:r=n}={}){const s=typeof r>"u"?"offset":`${r}.offset`,a=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(a,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:n=!1,buffers:r=!1,wal:s=!1,format:a="text"}={}){var i;const l=[e?"analyze":null,t?"verbose":null,n?"settings":null,r?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(i=this.headers.get("Accept"))!==null&&i!==void 0?i:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${a}; for="${c}"; options=${l};`),a==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const qd=new RegExp("[,()]");var jr=class extends V0{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const n=Array.from(new Set(t)).map(r=>typeof r=="string"&&qd.test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(e,`in.(${n})`),this}notIn(e,t){const n=Array.from(new Set(t)).map(r=>typeof r=="string"&&qd.test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(e,`not.in.(${n})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:n,type:r}={}){let s="";r==="plain"?s="pl":r==="phrase"?s="ph":r==="websearch"&&(s="w");const a=n===void 0?"":`(${n})`;return this.url.searchParams.append(e,`${s}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,n])=>{this.url.searchParams.append(t,`eq.${n}`)}),this}not(e,t,n){return this.url.searchParams.append(e,`not.${t}.${n}`),this}or(e,{foreignTable:t,referencedTable:n=t}={}){const r=n?`${n}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,n){return this.url.searchParams.append(e,`${t}.${n}`),this}},W0=class{constructor(e,{headers:t={},schema:n,fetch:r}){this.url=e,this.headers=new Headers(t),this.schema=n,this.fetch=r}select(e,t){const{head:n=!1,count:r}=t??{},s=n?"HEAD":"GET";let a=!1;const i=(e??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",i),r&&this.headers.append("Prefer",`count=${r}`),new jr({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:n=!0}={}){var r;const s="POST";if(t&&this.headers.append("Prefer",`count=${t}`),n||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const a=e.reduce((i,l)=>i.concat(Object.keys(l)),[]);if(a.length>0){const i=[...new Set(a)].map(l=>`"${l}"`);this.url.searchParams.set("columns",i.join(","))}}return new jr({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:n=!1,count:r,defaultToNull:s=!0}={}){var a;const i="POST";if(this.headers.append("Prefer",`resolution=${n?"ignore":"merge"}-duplicates`),t!==void 0&&this.url.searchParams.set("on_conflict",t),r&&this.headers.append("Prefer",`count=${r}`),s||this.headers.append("Prefer","missing=default"),Array.isArray(e)){const l=e.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(l.length>0){const c=[...new Set(l)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new jr({method:i,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}update(e,{count:t}={}){var n;const r="PATCH";return t&&this.headers.append("Prefer",`count=${t}`),new jr({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}delete({count:e}={}){var t;const n="DELETE";return e&&this.headers.append("Prefer",`count=${e}`),new jr({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},q0=class Jp{constructor(t,{headers:n={},schema:r,fetch:s}={}){this.url=t,this.headers=new Headers(n),this.schemaName=r,this.fetch=s}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new W0(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new Jp(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,n={},{head:r=!1,get:s=!1,count:a}={}){var i;let l;const c=new URL(`${this.url}/rpc/${t}`);let u;r||s?(l=r?"HEAD":"GET",Object.entries(n).filter(([m,p])=>p!==void 0).map(([m,p])=>[m,Array.isArray(p)?`{${p.join(",")}}`:`${p}`]).forEach(([m,p])=>{c.searchParams.append(m,p)})):(l="POST",u=n);const d=new Headers(this.headers);return a&&d.set("Prefer",`count=${a}`),new jr({method:l,url:c,headers:d,schema:this.schemaName,body:u,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}};class K0{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const n=process.versions;if(n&&n.node){const r=n.node,s=parseInt(r.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let n=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(n+=`

Suggested solution: ${t.workaround}`),new Error(n)}static createWebSocket(t,n){const r=this.getWebSocketConstructor();return new r(t,n)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const H0="2.89.0",G0=`realtime-js/${H0}`,Qp="1.0.0",J0="2.0.0",Kd=Qp,Gl=1e4,Q0=1e3,Y0=100;var xn;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(xn||(xn={}));var ze;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(ze||(ze={}));var zt;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(zt||(zt={}));var Jl;(function(e){e.websocket="websocket"})(Jl||(Jl={}));var Qn;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Qn||(Qn={}));class X0{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,n){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return n(this._binaryEncodeUserBroadcastPush(t));let r=[t.join_ref,t.ref,t.topic,t.event,t.payload];return n(JSON.stringify(r))}_binaryEncodeUserBroadcastPush(t){var n;return this._isArrayBuffer((n=t.payload)===null||n===void 0?void 0:n.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var n,r;const s=(r=(n=t.payload)===null||n===void 0?void 0:n.payload)!==null&&r!==void 0?r:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(t){var n,r;const s=(r=(n=t.payload)===null||n===void 0?void 0:n.payload)!==null&&r!==void 0?r:{},i=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,i)}_encodeUserBroadcastPush(t,n,r){var s,a;const i=t.topic,l=(s=t.ref)!==null&&s!==void 0?s:"",c=(a=t.join_ref)!==null&&a!==void 0?a:"",u=t.payload.event,d=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},m=Object.keys(d).length===0?"":JSON.stringify(d);if(c.length>255)throw new Error(`joinRef length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`ref length ${l.length} exceeds maximum of 255`);if(i.length>255)throw new Error(`topic length ${i.length} exceeds maximum of 255`);if(u.length>255)throw new Error(`userEvent length ${u.length} exceeds maximum of 255`);if(m.length>255)throw new Error(`metadata length ${m.length} exceeds maximum of 255`);const p=this.USER_BROADCAST_PUSH_META_LENGTH+c.length+l.length+i.length+u.length+m.length,w=new ArrayBuffer(this.HEADER_LENGTH+p);let y=new DataView(w),_=0;y.setUint8(_++,this.KINDS.userBroadcastPush),y.setUint8(_++,c.length),y.setUint8(_++,l.length),y.setUint8(_++,i.length),y.setUint8(_++,u.length),y.setUint8(_++,m.length),y.setUint8(_++,n),Array.from(c,f=>y.setUint8(_++,f.charCodeAt(0))),Array.from(l,f=>y.setUint8(_++,f.charCodeAt(0))),Array.from(i,f=>y.setUint8(_++,f.charCodeAt(0))),Array.from(u,f=>y.setUint8(_++,f.charCodeAt(0))),Array.from(m,f=>y.setUint8(_++,f.charCodeAt(0)));var b=new Uint8Array(w.byteLength+r.byteLength);return b.set(new Uint8Array(w),0),b.set(new Uint8Array(r),w.byteLength),b.buffer}decode(t,n){if(this._isArrayBuffer(t)){let r=this._binaryDecode(t);return n(r)}if(typeof t=="string"){const r=JSON.parse(t),[s,a,i,l,c]=r;return n({join_ref:s,ref:a,topic:i,event:l,payload:c})}return n({})}_binaryDecode(t){const n=new DataView(t),r=n.getUint8(0),s=new TextDecoder;switch(r){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,n,s)}}_decodeUserBroadcast(t,n,r){const s=n.getUint8(1),a=n.getUint8(2),i=n.getUint8(3),l=n.getUint8(4);let c=this.HEADER_LENGTH+4;const u=r.decode(t.slice(c,c+s));c=c+s;const d=r.decode(t.slice(c,c+a));c=c+a;const m=r.decode(t.slice(c,c+i));c=c+i;const p=t.slice(c,t.byteLength),w=l===this.JSON_ENCODING?JSON.parse(r.decode(p)):p,y={type:this.BROADCAST_EVENT,event:d,payload:w};return i>0&&(y.meta=JSON.parse(m)),{join_ref:null,ref:null,topic:u,event:this.BROADCAST_EVENT,payload:y}}_isArrayBuffer(t){var n;return t instanceof ArrayBuffer||((n=t==null?void 0:t.constructor)===null||n===void 0?void 0:n.name)==="ArrayBuffer"}_pick(t,n){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([r])=>n.includes(r)))}}class Yp{constructor(t,n){this.callback=t,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Se;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Se||(Se={}));const Hd=(e,t,n={})=>{var r;const s=(r=n.skipTypes)!==null&&r!==void 0?r:[];return t?Object.keys(t).reduce((a,i)=>(a[i]=Z0(i,e,t,s),a),{}):{}},Z0=(e,t,n,r)=>{const s=t.find(l=>l.name===e),a=s==null?void 0:s.type,i=n[e];return a&&!r.includes(a)?Xp(a,i):Ql(i)},Xp=(e,t)=>{if(e.charAt(0)==="_"){const n=e.slice(1,e.length);return rw(t,n)}switch(e){case Se.bool:return ew(t);case Se.float4:case Se.float8:case Se.int2:case Se.int4:case Se.int8:case Se.numeric:case Se.oid:return tw(t);case Se.json:case Se.jsonb:return nw(t);case Se.timestamp:return sw(t);case Se.abstime:case Se.date:case Se.daterange:case Se.int4range:case Se.int8range:case Se.money:case Se.reltime:case Se.text:case Se.time:case Se.timestamptz:case Se.timetz:case Se.tsrange:case Se.tstzrange:return Ql(t);default:return Ql(t)}},Ql=e=>e,ew=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},tw=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},nw=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},rw=(e,t)=>{if(typeof e!="string")return e;const n=e.length-1,r=e[n];if(e[0]==="{"&&r==="}"){let a;const i=e.slice(1,n);try{a=JSON.parse("["+i+"]")}catch{a=i?i.split(","):[]}return a.map(l=>Xp(t,l))}return e},sw=e=>typeof e=="string"?e.replace(" ","T"):e,Zp=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Lo{constructor(t,n,r={},s=Gl){this.channel=t,this.event=n,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,n){var r;return this._hasReceived(t)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:t,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:n}){this.recHooks.filter(r=>r.status===t).forEach(r=>r.callback(n))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Gd;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Gd||(Gd={}));class Is{constructor(t,n){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:a,onLeave:i,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Is.syncState(this.state,s,a,i),this.pendingDiffs.forEach(c=>{this.state=Is.syncDiff(this.state,c,a,i)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},s=>{const{onJoin:a,onLeave:i,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Is.syncDiff(this.state,s,a,i),l())}),this.onJoin((s,a,i)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:a,newPresences:i})}),this.onLeave((s,a,i)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:a,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,n,r,s){const a=this.cloneDeep(t),i=this.transformState(n),l={},c={};return this.map(a,(u,d)=>{i[u]||(c[u]=d)}),this.map(i,(u,d)=>{const m=a[u];if(m){const p=d.map(b=>b.presence_ref),w=m.map(b=>b.presence_ref),y=d.filter(b=>w.indexOf(b.presence_ref)<0),_=m.filter(b=>p.indexOf(b.presence_ref)<0);y.length>0&&(l[u]=y),_.length>0&&(c[u]=_)}else l[u]=d}),this.syncDiff(a,{joins:l,leaves:c},r,s)}static syncDiff(t,n,r,s){const{joins:a,leaves:i}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(a,(l,c)=>{var u;const d=(u=t[l])!==null&&u!==void 0?u:[];if(t[l]=this.cloneDeep(c),d.length>0){const m=t[l].map(w=>w.presence_ref),p=d.filter(w=>m.indexOf(w.presence_ref)<0);t[l].unshift(...p)}r(l,d,c)}),this.map(i,(l,c)=>{let u=t[l];if(!u)return;const d=c.map(m=>m.presence_ref);u=u.filter(m=>d.indexOf(m.presence_ref)<0),t[l]=u,s(l,u,c),u.length===0&&delete t[l]}),t}static map(t,n){return Object.getOwnPropertyNames(t).map(r=>n(r,t[r]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((n,r)=>{const s=t[r];return"metas"in s?n[r]=s.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):n[r]=s,n},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Jd;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(Jd||(Jd={}));var $s;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})($s||($s={}));var Zt;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Zt||(Zt={}));class Dr{constructor(t,n={config:{}},r){var s,a;if(this.topic=t,this.params=n,this.socket=r,this.bindings={},this.state=ze.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Lo(this,zt.join,this.params,this.timeout),this.rejoinTimer=new Yp(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ze.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(i=>i.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ze.closed,this.socket._remove(this)}),this._onError(i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=ze.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ze.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",i=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,i),this.state=ze.errored,this.rejoinTimer.scheduleTimeout())}),this._on(zt.reply,{},(i,l)=>{this._trigger(this._replyEventName(l),i)}),this.presence=new Is(this),this.broadcastEndpointURL=Zp(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,n=this.timeout){var r,s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==ze.closed){const{config:{broadcast:i,presence:l,private:c}}=this.params,u=(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(w=>w.filter))!==null&&s!==void 0?s:[],d=!!this.bindings[$s.PRESENCE]&&this.bindings[$s.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,m={},p={broadcast:i,presence:Object.assign(Object.assign({},l),{enabled:d}),postgres_changes:u,private:c};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(w=>t==null?void 0:t(Zt.CHANNEL_ERROR,w)),this._onClose(()=>t==null?void 0:t(Zt.CLOSED)),this.updateJoinPayload(Object.assign({config:p},m)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:w})=>{var y;if(this.socket._isManualToken()||this.socket.setAuth(),w===void 0){t==null||t(Zt.SUBSCRIBED);return}else{const _=this.bindings.postgres_changes,b=(y=_==null?void 0:_.length)!==null&&y!==void 0?y:0,f=[];for(let h=0;h<b;h++){const g=_[h],{filter:{event:S,schema:T,table:k,filter:P}}=g,O=w&&w[h];if(O&&O.event===S&&Dr.isFilterValueEqual(O.schema,T)&&Dr.isFilterValueEqual(O.table,k)&&Dr.isFilterValueEqual(O.filter,P))f.push(Object.assign(Object.assign({},g),{id:O.id}));else{this.unsubscribe(),this.state=ze.errored,t==null||t(Zt.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=f,t&&t(Zt.SUBSCRIBED);return}}).receive("error",w=>{this.state=ze.errored,t==null||t(Zt.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(w).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Zt.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,n={}){return await this.send({type:"presence",event:"track",payload:t},n.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,n,r){return this.state===ze.joined&&t===$s.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,n,r)}async httpSend(t,n,r={}){var s;if(n==null)return Promise.reject("Payload is required for httpSend()");const a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const i={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:n,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,i,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const u=await l.json();c=u.error||u.message||c}catch{}return Promise.reject(new Error(c))}async send(t,n={}){var r,s;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:i}=t,l={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(l.Authorization=`Bearer ${this.socket.accessTokenValue}`);const c={method:"POST",headers:l,body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var i,l,c;const u=this._push(t.type,t,n.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(i=this.params)===null||i===void 0?void 0:i.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),u.receive("ok",()=>a("ok")),u.receive("error",()=>a("error")),u.receive("timeout",()=>a("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=ze.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(zt.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new Lo(this,zt.leave,{},t),r.receive("ok",()=>{n(),s("ok")}).receive("timeout",()=>{n(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ze.closed,this.bindings={}}async _fetchWithTimeout(t,n,r){const s=new AbortController,a=setTimeout(()=>s.abort(),r),i=await this.socket.fetch(t,Object.assign(Object.assign({},n),{signal:s.signal}));return clearTimeout(a),i}_push(t,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Lo(this,t,n,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>Y0){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(t,n,r){return n}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,n,r){var s,a;const i=t.toLocaleLowerCase(),{close:l,error:c,leave:u,join:d}=zt;if(r&&[l,c,u,d].indexOf(i)>=0&&r!==this._joinRef())return;let p=this._onMessage(i,n,r);if(n&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(w=>{var y,_,b;return((y=w.filter)===null||y===void 0?void 0:y.event)==="*"||((b=(_=w.filter)===null||_===void 0?void 0:_.event)===null||b===void 0?void 0:b.toLocaleLowerCase())===i}).map(w=>w.callback(p,r)):(a=this.bindings[i])===null||a===void 0||a.filter(w=>{var y,_,b,f,h,g;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in w){const S=w.id,T=(y=w.filter)===null||y===void 0?void 0:y.event;return S&&((_=n.ids)===null||_===void 0?void 0:_.includes(S))&&(T==="*"||(T==null?void 0:T.toLocaleLowerCase())===((b=n.data)===null||b===void 0?void 0:b.type.toLocaleLowerCase()))}else{const S=(h=(f=w==null?void 0:w.filter)===null||f===void 0?void 0:f.event)===null||h===void 0?void 0:h.toLocaleLowerCase();return S==="*"||S===((g=n==null?void 0:n.event)===null||g===void 0?void 0:g.toLocaleLowerCase())}else return w.type.toLocaleLowerCase()===i}).map(w=>{if(typeof p=="object"&&"ids"in p){const y=p.data,{schema:_,table:b,commit_timestamp:f,type:h,errors:g}=y;p=Object.assign(Object.assign({},{schema:_,table:b,commit_timestamp:f,eventType:h,new:{},old:{},errors:g}),this._getPayloadRecords(y))}w.callback(p,r)})}_isClosed(){return this.state===ze.closed}_isJoined(){return this.state===ze.joined}_isJoining(){return this.state===ze.joining}_isLeaving(){return this.state===ze.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,n,r){const s=t.toLocaleLowerCase(),a={type:s,filter:n,callback:r};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(t,n){const r=t.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(s=>{var a;return!(((a=s.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===r&&Dr.isEqual(s.filter,n))})),this}static isEqual(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const r in t)if(t[r]!==n[r])return!1;return!0}static isFilterValueEqual(t,n){return(t??void 0)===(n??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(zt.close,{},t)}_onError(t){this._on(zt.error,{},n=>t(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ze.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const n={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(n.new=Hd(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(n.old=Hd(t.columns,t.old_record)),n}}const Do=()=>{},Ua={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},aw=[1e3,2e3,5e3,1e4],iw=1e4,ow=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class lw{constructor(t,n){var r;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Gl,this.transport=null,this.heartbeatIntervalMs=Ua.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Do,this.ref=0,this.reconnectTimer=null,this.vsn=Kd,this.logger=Do,this.conn=null,this.sendBuffer=[],this.serializer=new X0,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>s?(...a)=>s(...a):(...a)=>fetch(...a),!(!((r=n==null?void 0:n.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${t}/${Jl.websocket}`,this.httpEndpoint=Zp(t),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=K0.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const n=t.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,n??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const n=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const t=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,n,r){this.logger(t,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case xn.connecting:return Qn.Connecting;case xn.open:return Qn.Open;case xn.closing:return Qn.Closing;default:return Qn.Closed}}isConnected(){return this.connectionState()===Qn.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,n={config:{}}){const r=`realtime:${t}`,s=this.getChannels().find(a=>a.topic===r);if(s)return s;{const a=new Dr(`realtime:${t}`,n,this);return this.channels.push(a),a}}push(t){const{topic:n,event:r,payload:s,ref:a}=t,i=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${n} ${r} (${a})`,s),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(n){this.log("error","error in heartbeat callback",n)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(n){this.log("error","error in heartbeat callback",n)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(Q0,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},Ua.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(n){this.log("error","error in heartbeat callback",n)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let n=this.channels.find(r=>r.topic===t&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${t}"`),n.unsubscribe())}_remove(t){this.channels=this.channels.filter(n=>n.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,n=>{if(n.topic==="phoenix"&&n.event==="phx_reply")try{this.heartbeatCallback(n.payload.status==="ok"?"ok":"error")}catch(u){this.log("error","error in heartbeat callback",u)}n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:s,payload:a,ref:i}=n,l=i?`(${i})`:"",c=a.status||"";this.log("receive",`${c} ${r} ${s} ${l}`.trim(),a),this.channels.filter(u=>u._isMember(r)).forEach(u=>u._trigger(s,a,i)),this._triggerStateCallbacks("message",n)})}_clearTimer(t){var n;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===xn.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===xn.open||this.conn.readyState===xn.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(n=>{this.log("error","error waiting for auth on connect",n),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this._terminateWorker()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var n;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(zt.error))}_appendParams(t,n){if(Object.keys(n).length===0)return t;const r=t.match(/\?/)?"&":"?",s=new URLSearchParams(n);return`${t}${r}${s}`}_workerObjectUrl(t){let n;if(t)n=t;else{const r=new Blob([ow],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}_setConnectionState(t,n=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(t=null){let n,r=!1;if(t)n=t,r=!0;else if(this.accessToken)try{n=await this.accessToken()}catch(s){this.log("error","Error fetching access token from callback",s),n=this.accessTokenValue}else n=this.accessTokenValue;r?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(s=>{const a={access_token:n,version:G0};n&&s.updateJoinPayload(a),s.joinedOnce&&s._isJoined()&&s._push(zt.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(n=>{this.log("error",`Error setting auth in ${t}`,n)})}_triggerStateCallbacks(t,n){try{this.stateChangeCallbacks[t].forEach(r=>{try{r(n)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(r){this.log("error",`error triggering ${t} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new Yp(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ua.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var n,r,s,a,i,l,c,u,d,m,p,w;switch(this.transport=(n=t==null?void 0:t.transport)!==null&&n!==void 0?n:null,this.timeout=(r=t==null?void 0:t.timeout)!==null&&r!==void 0?r:Gl,this.heartbeatIntervalMs=(s=t==null?void 0:t.heartbeatIntervalMs)!==null&&s!==void 0?s:Ua.HEARTBEAT_INTERVAL,this.worker=(a=t==null?void 0:t.worker)!==null&&a!==void 0?a:!1,this.accessToken=(i=t==null?void 0:t.accessToken)!==null&&i!==void 0?i:null,this.heartbeatCallback=(l=t==null?void 0:t.heartbeatCallback)!==null&&l!==void 0?l:Do,this.vsn=(c=t==null?void 0:t.vsn)!==null&&c!==void 0?c:Kd,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(u=t==null?void 0:t.reconnectAfterMs)!==null&&u!==void 0?u:y=>aw[y-1]||iw,this.vsn){case Qp:this.encode=(d=t==null?void 0:t.encode)!==null&&d!==void 0?d:(y,_)=>_(JSON.stringify(y)),this.decode=(m=t==null?void 0:t.decode)!==null&&m!==void 0?m:(y,_)=>_(JSON.parse(y));break;case J0:this.encode=(p=t==null?void 0:t.encode)!==null&&p!==void 0?p:this.serializer.encode.bind(this.serializer),this.decode=(w=t==null?void 0:t.decode)!==null&&w!==void 0?w:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var na=class extends Error{constructor(e,t){var n;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((n=t.icebergType)==null?void 0:n.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function cw(e,t,n){const r=new URL(t,e);if(n)for(const[s,a]of Object.entries(n))a!==void 0&&r.searchParams.set(s,a);return r.toString()}async function uw(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function dw(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:n,path:r,query:s,body:a,headers:i}){const l=cw(e.baseUrl,r,s),c=await uw(e.auth),u=await t(l,{method:n,headers:{...a?{"Content-Type":"application/json"}:{},...c,...i},body:a?JSON.stringify(a):void 0}),d=await u.text(),m=(u.headers.get("content-type")||"").includes("application/json"),p=m&&d?JSON.parse(d):d;if(!u.ok){const w=m?p:void 0,y=w==null?void 0:w.error;throw new na((y==null?void 0:y.message)??`Request failed with status ${u.status}`,{status:u.status,icebergType:y==null?void 0:y.type,icebergCode:y==null?void 0:y.code,details:w})}return{status:u.status,headers:u.headers,data:p}}}}function Ma(e){return e.join("")}var hw=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:Ma(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(r=>({namespace:r}))}async createNamespace(e,t){const n={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:n})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Ma(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Ma(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Ma(e.namespace)}`}),!0}catch(t){if(t instanceof na&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(n){if(n instanceof na&&n.status===409)return;throw n}}};function gr(e){return e.join("")}var fw=class{constructor(e,t="",n){this.client=e,this.prefix=t,this.accessDelegation=n}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${gr(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const n={};return this.accessDelegation&&(n["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${gr(e.namespace)}/tables`,body:t,headers:n})).data.metadata}async updateTable(e,t){const n=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${gr(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":n.data["metadata-location"],metadata:n.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${gr(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${gr(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${gr(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(n){if(n instanceof na&&n.status===404)return!1;throw n}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(n){if(n instanceof na&&n.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw n}}},pw=class{constructor(e){var r;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const n=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=dw({baseUrl:n,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(r=e.accessDelegation)==null?void 0:r.join(","),this.namespaceOps=new hw(this.client,t),this.tableOps=new fw(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},Yi=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function Re(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var mw=class extends Yi{constructor(e,t,n){super(e),this.name="StorageApiError",this.status=t,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Yl=class extends Yi{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const ou=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),gw=()=>Response,Xl=e=>{if(Array.isArray(e))return e.map(n=>Xl(n));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([n,r])=>{const s=n.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));t[s]=Xl(r)}),t},vw=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},yw=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function ra(e){"@babel/helpers - typeof";return ra=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ra(e)}function ww(e,t){if(ra(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(ra(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _w(e){var t=ww(e,"string");return ra(t)=="symbol"?t:t+""}function xw(e,t,n){return(t=_w(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Qd(Object(n),!0).forEach(function(r){xw(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qd(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}const Uo=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},jw=async(e,t,n)=>{e instanceof await gw()&&!(n!=null&&n.noResolveJson)?e.json().then(r=>{const s=e.status||500,a=(r==null?void 0:r.statusCode)||s+"";t(new mw(Uo(r),s,a))}).catch(r=>{t(new Yl(Uo(r),r))}):t(new Yl(Uo(e),e))},bw=(e,t,n,r)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!r?s:(vw(r)?(s.headers=re({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(r)):s.body=r,t!=null&&t.duplex&&(s.duplex=t.duplex),re(re({},s),n))};async function pa(e,t,n,r,s,a){return new Promise((i,l)=>{e(n,bw(t,r,s,a)).then(c=>{if(!c.ok)throw c;return r!=null&&r.noResolveJson?c:c.json()}).then(c=>i(c)).catch(c=>jw(c,l,r))})}async function sa(e,t,n,r){return pa(e,"GET",t,n,r)}async function Mt(e,t,n,r,s){return pa(e,"POST",t,r,s,n)}async function Zl(e,t,n,r,s){return pa(e,"PUT",t,r,s,n)}async function Sw(e,t,n,r){return pa(e,"HEAD",t,re(re({},n),{},{noResolveJson:!0}),r)}async function lu(e,t,n,r,s){return pa(e,"DELETE",t,r,s,n)}var kw=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Re(t))return{data:null,error:t};throw t}}};let em;em=Symbol.toStringTag;var Nw=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[em]="BlobDownloadBuilder",this.promise=null}asStream(){return new kw(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Re(t))return{data:null,error:t};throw t}}};const Ew={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Yd={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Cw=class{constructor(e,t={},n,r){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=n,this.fetch=ou(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,n,r){var s=this;try{let a;const i=re(re({},Yd),r);let l=re(re({},s.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const c=i.metadata;typeof Blob<"u"&&n instanceof Blob?(a=new FormData,a.append("cacheControl",i.cacheControl),c&&a.append("metadata",s.encodeMetadata(c)),a.append("",n)):typeof FormData<"u"&&n instanceof FormData?(a=n,a.has("cacheControl")||a.append("cacheControl",i.cacheControl),c&&!a.has("metadata")&&a.append("metadata",s.encodeMetadata(c))):(a=n,l["cache-control"]=`max-age=${i.cacheControl}`,l["content-type"]=i.contentType,c&&(l["x-metadata"]=s.toBase64(s.encodeMetadata(c))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!i.duplex&&(i.duplex="half")),r!=null&&r.headers&&(l=re(re({},l),r.headers));const u=s._removeEmptyFolders(t),d=s._getFinalPath(u),m=await(e=="PUT"?Zl:Mt)(s.fetch,`${s.url}/object/${d}`,a,re({headers:l},i!=null&&i.duplex?{duplex:i.duplex}:{}));return{data:{path:u,id:m.Id,fullPath:m.Key},error:null}}catch(a){if(s.shouldThrowOnError)throw a;if(Re(a))return{data:null,error:a};throw a}}async upload(e,t,n){return this.uploadOrUpdate("POST",e,t,n)}async uploadToSignedUrl(e,t,n,r){var s=this;const a=s._removeEmptyFolders(e),i=s._getFinalPath(a),l=new URL(s.url+`/object/upload/sign/${i}`);l.searchParams.set("token",t);try{let c;const u=re({upsert:Yd.upsert},r),d=re(re({},s.headers),{"x-upsert":String(u.upsert)});return typeof Blob<"u"&&n instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",n)):typeof FormData<"u"&&n instanceof FormData?(c=n,c.append("cacheControl",u.cacheControl)):(c=n,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType),{data:{path:a,fullPath:(await Zl(s.fetch,l.toString(),c,{headers:d})).Key},error:null}}catch(c){if(s.shouldThrowOnError)throw c;if(Re(c))return{data:null,error:c};throw c}}async createSignedUploadUrl(e,t){var n=this;try{let r=n._getFinalPath(e);const s=re({},n.headers);t!=null&&t.upsert&&(s["x-upsert"]="true");const a=await Mt(n.fetch,`${n.url}/object/upload/sign/${r}`,{},{headers:s}),i=new URL(n.url+a.url),l=i.searchParams.get("token");if(!l)throw new Yi("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:l},error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(Re(r))return{data:null,error:r};throw r}}async update(e,t,n){return this.uploadOrUpdate("PUT",e,t,n)}async move(e,t,n){var r=this;try{return{data:await Mt(r.fetch,`${r.url}/object/move`,{bucketId:r.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:r.headers}),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Re(s))return{data:null,error:s};throw s}}async copy(e,t,n){var r=this;try{return{data:{path:(await Mt(r.fetch,`${r.url}/object/copy`,{bucketId:r.bucketId,sourceKey:e,destinationKey:t,destinationBucket:n==null?void 0:n.destinationBucket},{headers:r.headers})).Key},error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Re(s))return{data:null,error:s};throw s}}async createSignedUrl(e,t,n){var r=this;try{let s=r._getFinalPath(e),a=await Mt(r.fetch,`${r.url}/object/sign/${s}`,re({expiresIn:t},n!=null&&n.transform?{transform:n.transform}:{}),{headers:r.headers});const i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return a={signedUrl:encodeURI(`${r.url}${a.signedURL}${i}`)},{data:a,error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Re(s))return{data:null,error:s};throw s}}async createSignedUrls(e,t,n){var r=this;try{const s=await Mt(r.fetch,`${r.url}/object/sign/${r.bucketId}`,{expiresIn:t,paths:e},{headers:r.headers}),a=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:s.map(i=>re(re({},i),{},{signedUrl:i.signedURL?encodeURI(`${r.url}${i.signedURL}${a}`):null})),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Re(s))return{data:null,error:s};throw s}}download(e,t){const n=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",r=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),s=r?`?${r}`:"",a=this._getFinalPath(e),i=()=>sa(this.fetch,`${this.url}/${n}/${a}${s}`,{headers:this.headers,noResolveJson:!0});return new Nw(i,this.shouldThrowOnError)}async info(e){var t=this;const n=t._getFinalPath(e);try{return{data:Xl(await sa(t.fetch,`${t.url}/object/info/${n}`,{headers:t.headers})),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Re(r))return{data:null,error:r};throw r}}async exists(e){var t=this;const n=t._getFinalPath(e);try{return await Sw(t.fetch,`${t.url}/object/${n}`,{headers:t.headers}),{data:!0,error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Re(r)&&r instanceof Yl){const s=r.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:r}}throw r}}getPublicUrl(e,t){const n=this._getFinalPath(e),r=[],s=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";s!==""&&r.push(s);const a=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});i!==""&&r.push(i);let l=r.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${n}${l}`)}}}async remove(e){var t=this;try{return{data:await lu(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Re(n))return{data:null,error:n};throw n}}async list(e,t,n){var r=this;try{const s=re(re(re({},Ew),t),{},{prefix:e||""});return{data:await Mt(r.fetch,`${r.url}/object/list/${r.bucketId}`,s,{headers:r.headers},n),error:null}}catch(s){if(r.shouldThrowOnError)throw s;if(Re(s))return{data:null,error:s};throw s}}async listV2(e,t){var n=this;try{const r=re({},e);return{data:await Mt(n.fetch,`${n.url}/object/list-v2/${n.bucketId}`,r,{headers:n.headers},t),error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(Re(r))return{data:null,error:r};throw r}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const tm="2.89.0",nm={"X-Client-Info":`storage-js/${tm}`};var Tw=class{constructor(e,t={},n,r){this.shouldThrowOnError=!1;const s=new URL(e);r!=null&&r.useNewHostname&&/supabase\.(co|in|red)$/.test(s.hostname)&&!s.hostname.includes("storage.supabase.")&&(s.hostname=s.hostname.replace("supabase.","storage.supabase.")),this.url=s.href.replace(/\/$/,""),this.headers=re(re({},nm),t),this.fetch=ou(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const n=t.listBucketOptionsToQueryString(e);return{data:await sa(t.fetch,`${t.url}/bucket${n}`,{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Re(n))return{data:null,error:n};throw n}}async getBucket(e){var t=this;try{return{data:await sa(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Re(n))return{data:null,error:n};throw n}}async createBucket(e,t={public:!1}){var n=this;try{return{data:await Mt(n.fetch,`${n.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:n.headers}),error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(Re(r))return{data:null,error:r};throw r}}async updateBucket(e,t){var n=this;try{return{data:await Zl(n.fetch,`${n.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:n.headers}),error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(Re(r))return{data:null,error:r};throw r}}async emptyBucket(e){var t=this;try{return{data:await Mt(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Re(n))return{data:null,error:n};throw n}}async deleteBucket(e){var t=this;try{return{data:await lu(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Re(n))return{data:null,error:n};throw n}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},Rw=class{constructor(e,t={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=re(re({},nm),t),this.fetch=ou(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Mt(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Re(n))return{data:null,error:n};throw n}}async listBuckets(e){var t=this;try{const n=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&n.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&n.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&n.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&n.set("sortOrder",e.sortOrder),e!=null&&e.search&&n.set("search",e.search);const r=n.toString(),s=r?`${t.url}/bucket?${r}`:`${t.url}/bucket`;return{data:await sa(t.fetch,s,{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Re(n))return{data:null,error:n};throw n}}async deleteBucket(e){var t=this;try{return{data:await lu(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Re(n))return{data:null,error:n};throw n}}from(e){var t=this;if(!yw(e))throw new Yi("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const n=new pw({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),r=this.shouldThrowOnError;return new Proxy(n,{get(s,a){const i=s[a];return typeof i!="function"?i:async(...l)=>{try{return{data:await i.apply(s,l),error:null}}catch(c){if(r)throw c;return{data:null,error:c}}}}})}};const cu={"X-Client-Info":`storage-js/${tm}`,"Content-Type":"application/json"};var rm=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function gt(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var Mo=class extends rm{constructor(e,t,n){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=n}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Pw=class extends rm{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const uu=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Ow=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Xd=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Aw=async(e,t,n)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(n!=null&&n.noResolveJson)){const r=e.status||500,s=e;if(typeof s.json=="function")s.json().then(a=>{const i=(a==null?void 0:a.statusCode)||(a==null?void 0:a.code)||r+"";t(new Mo(Xd(a),r,i))}).catch(()=>{const a=r+"";t(new Mo(s.statusText||`HTTP ${r} error`,r,a))});else{const a=r+"";t(new Mo(s.statusText||`HTTP ${r} error`,r,a))}}else t(new Pw(Xd(e),e))},Iw=(e,t,n,r)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return r?(Ow(r)?(s.headers=re({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(r)):s.body=r,re(re({},s),n)):s};async function $w(e,t,n,r,s,a){return new Promise((i,l)=>{e(n,Iw(t,r,s,a)).then(c=>{if(!c.ok)throw c;if(r!=null&&r.noResolveJson)return c;const u=c.headers.get("content-type");return!u||!u.includes("application/json")?{}:c.json()}).then(c=>i(c)).catch(c=>Aw(c,l,r))})}async function vt(e,t,n,r,s){return $w(e,"POST",t,r,s,n)}var Lw=class{constructor(e,t={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=re(re({},cu),t),this.fetch=uu(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await vt(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}}async getIndex(e,t){var n=this;try{return{data:await vt(n.fetch,`${n.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:n.headers}),error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(gt(r))return{data:null,error:r};throw r}}async listIndexes(e){var t=this;try{return{data:await vt(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}}async deleteIndex(e,t){var n=this;try{return{data:await vt(n.fetch,`${n.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:n.headers})||{},error:null}}catch(r){if(n.shouldThrowOnError)throw r;if(gt(r))return{data:null,error:r};throw r}}},Dw=class{constructor(e,t={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=re(re({},cu),t),this.fetch=uu(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await vt(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}}async getVectors(e){var t=this;try{return{data:await vt(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await vt(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}}async queryVectors(e){var t=this;try{return{data:await vt(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await vt(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}}},Uw=class{constructor(e,t={},n){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=re(re({},cu),t),this.fetch=uu(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await vt(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}}async getBucket(e){var t=this;try{return{data:await vt(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}}async listBuckets(e={}){var t=this;try{return{data:await vt(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}}async deleteBucket(e){var t=this;try{return{data:await vt(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(gt(n))return{data:null,error:n};throw n}}},Mw=class extends Uw{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new Fw(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,n=this;return t().call(n,e)}async getBucket(e){var t=()=>super.getBucket,n=this;return t().call(n,e)}async listBuckets(e={}){var t=()=>super.listBuckets,n=this;return t().call(n,e)}async deleteBucket(e){var t=()=>super.deleteBucket,n=this;return t().call(n,e)}},Fw=class extends Lw{constructor(e,t,n,r){super(e,t,r),this.vectorBucketName=n}async createIndex(e){var t=()=>super.createIndex,n=this;return t().call(n,re(re({},e),{},{vectorBucketName:n.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,n=this;return t().call(n,re(re({},e),{},{vectorBucketName:n.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,n=this;return t().call(n,n.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,n=this;return t().call(n,n.vectorBucketName,e)}index(e){return new zw(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},zw=class extends Dw{constructor(e,t,n,r,s){super(e,t,s),this.vectorBucketName=n,this.indexName=r}async putVectors(e){var t=()=>super.putVectors,n=this;return t().call(n,re(re({},e),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async getVectors(e){var t=()=>super.getVectors,n=this;return t().call(n,re(re({},e),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,n=this;return t().call(n,re(re({},e),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,n=this;return t().call(n,re(re({},e),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,n=this;return t().call(n,re(re({},e),{},{vectorBucketName:n.vectorBucketName,indexName:n.indexName}))}},Bw=class extends Tw{constructor(e,t={},n,r){super(e,t,n,r)}from(e){return new Cw(this.url,this.headers,e,this.fetch)}get vectors(){return new Mw(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Rw(this.url+"/iceberg",this.headers,this.fetch)}};const sm="2.89.0",br=30*1e3,ec=3,Fo=ec*br,Vw="http://localhost:9999",Ww="supabase.auth.token",qw={"X-Client-Info":`gotrue-js/${sm}`},tc="X-Supabase-Api-Version",am={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Kw=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Hw=10*60*1e3;class aa extends Error{constructor(t,n,r){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function Y(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Gw extends aa{constructor(t,n,r){super(t,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function Jw(e){return Y(e)&&e.name==="AuthApiError"}class Yn extends aa{constructor(t,n){super(t),this.name="AuthUnknownError",this.originalError=n}}class hn extends aa{constructor(t,n,r,s){super(t,r,s),this.name=n,this.status=r}}class ft extends hn{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Qw(e){return Y(e)&&e.name==="AuthSessionMissingError"}class vr extends hn{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Fa extends hn{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class za extends hn{constructor(t,n=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Yw(e){return Y(e)&&e.name==="AuthImplicitGrantRedirectError"}class Zd extends hn{constructor(t,n=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Xw extends hn{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class nc extends hn{constructor(t,n){super(t,"AuthRetryableFetchError",n,void 0)}}function zo(e){return Y(e)&&e.name==="AuthRetryableFetchError"}class eh extends hn{constructor(t,n,r){super(t,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class rc extends hn{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Ei="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),th=` 	
\r=`.split(""),Zw=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<th.length;t+=1)e[th[t].charCodeAt(0)]=-2;for(let t=0;t<Ei.length;t+=1)e[Ei[t].charCodeAt(0)]=t;return e})();function nh(e,t,n){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;n(Ei[r]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;n(Ei[r]),t.queuedBits-=6}}function im(e,t,n){const r=Zw[e];if(r>-1)for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function rh(e){const t=[],n=i=>{t.push(String.fromCodePoint(i))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=i=>{n_(i,r,n)};for(let i=0;i<e.length;i+=1)im(e.charCodeAt(i),s,a);return t.join("")}function e_(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function t_(e,t){for(let n=0;n<e.length;n+=1){let r=e.charCodeAt(n);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(e.charCodeAt(n+1)-56320&65535|s)+65536,n+=1}e_(r,t)}}function n_(e,t,n){if(t.utf8seq===0){if(e<=127){n(e);return}for(let r=1;r<6;r+=1)if(!(e>>7-r&1)){t.utf8seq=r;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&n(t.codepoint)}}function Wr(e){const t=[],n={queue:0,queuedBits:0},r=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)im(e.charCodeAt(s),n,r);return new Uint8Array(t)}function r_(e){const t=[];return t_(e,n=>t.push(n)),new Uint8Array(t)}function tr(e){const t=[],n={queue:0,queuedBits:0},r=s=>{t.push(s)};return e.forEach(s=>nh(s,n,r)),nh(null,n,r),t.join("")}function s_(e){return Math.round(Date.now()/1e3)+e}function a_(){return Symbol("auth-callback")}const He=()=>typeof window<"u"&&typeof document<"u",qn={tested:!1,writable:!1},om=()=>{if(!He())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(qn.tested)return qn.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),qn.tested=!0,qn.writable=!0}catch{qn.tested=!0,qn.writable=!1}return qn.writable};function i_(e){const t={},n=new URL(e);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((s,a)=>{t[a]=s})}catch{}return n.searchParams.forEach((r,s)=>{t[s]=r}),t}const lm=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),o_=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Sr=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},Kn=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Ke=async(e,t)=>{await e.removeItem(t)};class Xi{constructor(){this.promise=new Xi.promiseConstructor((t,n)=>{this.resolve=t,this.reject=n})}}Xi.promiseConstructor=Promise;function Bo(e){const t=e.split(".");if(t.length!==3)throw new rc("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!Kw.test(t[r]))throw new rc("JWT not in base64url format");return{header:JSON.parse(rh(t[0])),payload:JSON.parse(rh(t[1])),signature:Wr(t[2]),raw:{header:t[0],payload:t[1]}}}async function l_(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function c_(e,t){return new Promise((r,s)=>{(async()=>{for(let a=0;a<1/0;a++)try{const i=await e(a);if(!t(a,null,i)){r(i);return}}catch(i){if(!t(a,i)){s(i);return}}})()})}function u_(e){return("0"+e.toString(16)).substr(-2)}function d_(){const t=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let s="";for(let a=0;a<56;a++)s+=n.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(t),Array.from(t,u_).join("")}async function h_(e){const n=new TextEncoder().encode(e),r=await crypto.subtle.digest("SHA-256",n),s=new Uint8Array(r);return Array.from(s).map(a=>String.fromCharCode(a)).join("")}async function f_(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const n=await h_(e);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function yr(e,t,n=!1){const r=d_();let s=r;n&&(s+="/PASSWORD_RECOVERY"),await Sr(e,`${t}-code-verifier`,s);const a=await f_(r);return[a,r===a?"plain":"s256"]}const p_=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function m_(e){const t=e.headers.get(tc);if(!t||!t.match(p_))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function g_(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function v_(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const y_=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function wr(e){if(!y_.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Vo(){const e={};return new Proxy(e,{get:(t,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function w_(e,t){return new Proxy(e,{get:(n,r,s)=>{if(r==="__isInsecureUserWarningProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(n,r,s)}return!t.value&&typeof r=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(n,r,s)}})}function sh(e){return JSON.parse(JSON.stringify(e))}const Jn=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),__=[502,503,504];async function ah(e){var t;if(!o_(e))throw new nc(Jn(e),0);if(__.includes(e.status))throw new nc(Jn(e),e.status);let n;try{n=await e.json()}catch(a){throw new Yn(Jn(a),a)}let r;const s=m_(e);if(s&&s.getTime()>=am["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new eh(Jn(n),e.status,((t=n.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(r==="session_not_found")throw new ft}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((a,i)=>a&&typeof i=="string",!0))throw new eh(Jn(n),e.status,n.weak_password.reasons);throw new Gw(Jn(n),e.status||500,r)}const x_=(e,t,n,r)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),n))};async function ne(e,t,n,r){var s;const a=Object.assign({},r==null?void 0:r.headers);a[tc]||(a[tc]=am["2024-01-01"].name),r!=null&&r.jwt&&(a.Authorization=`Bearer ${r.jwt}`);const i=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(i.redirect_to=r.redirectTo);const l=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",c=await j_(e,t,n+l,{headers:a,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(c):{data:Object.assign({},c),error:null}}async function j_(e,t,n,r,s,a){const i=x_(t,r,s,a);let l;try{l=await e(n,Object.assign({},i))}catch(c){throw console.error(c),new nc(Jn(c),0)}if(l.ok||await ah(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(c){await ah(c)}}function Dt(e){var t;let n=null;k_(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=s_(e.expires_in)));const r=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:n,user:r},error:null}}function ih(e){const t=Dt(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Sn(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function b_(e){return{data:e,error:null}}function S_(e){const{action_link:t,email_otp:n,hashed_token:r,redirect_to:s,verification_type:a}=e,i=Qi(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:n,hashed_token:r,redirect_to:s,verification_type:a},c=Object.assign({},i);return{data:{properties:l,user:c},error:null}}function oh(e){return e}function k_(e){return e.access_token&&e.refresh_token&&e.expires_in}const Wo=["global","local","others"];class N_{constructor({url:t="",headers:n={},fetch:r}){this.url=t,this.headers=n,this.fetch=lm(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,n=Wo[0]){if(Wo.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Wo.join(", ")}`);try{return await ne(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Y(r))return{data:null,error:r};throw r}}async inviteUserByEmail(t,n={}){try{return await ne(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:Sn})}catch(r){if(Y(r))return{data:{user:null},error:r};throw r}}async generateLink(t){try{const{options:n}=t,r=Qi(t,["options"]),s=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await ne(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:S_,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(Y(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(t){try{return await ne(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Sn})}catch(n){if(Y(n))return{data:{user:null},error:n};throw n}}async listUsers(t){var n,r,s,a,i,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await ne(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(a=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:oh});if(d.error)throw d.error;const m=await d.json(),p=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,w=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return w.length>0&&(w.forEach(y=>{const _=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(y.split(";")[1].split("=")[1]);u[`${b}Page`]=_}),u.total=parseInt(p)),{data:Object.assign(Object.assign({},m),u),error:null}}catch(u){if(Y(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){wr(t);try{return await ne(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Sn})}catch(n){if(Y(n))return{data:{user:null},error:n};throw n}}async updateUserById(t,n){wr(t);try{return await ne(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:n,headers:this.headers,xform:Sn})}catch(r){if(Y(r))return{data:{user:null},error:r};throw r}}async deleteUser(t,n=!1){wr(t);try{return await ne(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:n},xform:Sn})}catch(r){if(Y(r))return{data:{user:null},error:r};throw r}}async _listFactors(t){wr(t.userId);try{const{data:n,error:r}=await ne(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:n,error:r}}catch(n){if(Y(n))return{data:null,error:n};throw n}}async _deleteFactor(t){wr(t.userId),wr(t.id);try{return{data:await ne(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(n){if(Y(n))return{data:null,error:n};throw n}}async _listOAuthClients(t){var n,r,s,a,i,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await ne(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(a=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:oh});if(d.error)throw d.error;const m=await d.json(),p=(i=d.headers.get("x-total-count"))!==null&&i!==void 0?i:0,w=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return w.length>0&&(w.forEach(y=>{const _=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),b=JSON.parse(y.split(";")[1].split("=")[1]);u[`${b}Page`]=_}),u.total=parseInt(p)),{data:Object.assign(Object.assign({},m),u),error:null}}catch(u){if(Y(u))return{data:{clients:[]},error:u};throw u}}async _createOAuthClient(t){try{return await ne(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Y(n))return{data:null,error:n};throw n}}async _getOAuthClient(t){try{return await ne(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Y(n))return{data:null,error:n};throw n}}async _updateOAuthClient(t,n){try{return await ne(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:n,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Y(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(t){try{return await ne(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Y(n))return{data:null,error:n};throw n}}async _regenerateOAuthClientSecret(t){try{return await ne(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Y(n))return{data:null,error:n};throw n}}}function lh(e={}){return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}const _r={debug:!!(globalThis&&om()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class cm extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class E_ extends cm{}async function C_(e,t,n){_r.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),_r.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){_r.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await n()}finally{_r.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw _r.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new E_(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(_r.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}function T_(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function um(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function R_(e){return parseInt(e,16)}function P_(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,r=>r.toString(16).padStart(2,"0")).join("")}function O_(e){var t;const{chainId:n,domain:r,expirationTime:s,issuedAt:a=new Date,nonce:i,notBefore:l,requestId:c,resources:u,scheme:d,uri:m,version:p}=e;{if(!Number.isInteger(n))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${n}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(i&&i.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${i}`);if(!m)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(p!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${p}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const w=um(e.address),y=d?`${d}://${r}`:r,_=e.statement?`${e.statement}
`:"",b=`${y} wants you to sign in with your Ethereum account:
${w}

${_}`;let f=`URI: ${m}
Version: ${p}
Chain ID: ${n}${i?`
Nonce: ${i}`:""}
Issued At: ${a.toISOString()}`;if(s&&(f+=`
Expiration Time: ${s.toISOString()}`),l&&(f+=`
Not Before: ${l.toISOString()}`),c&&(f+=`
Request ID: ${c}`),u){let h=`
Resources:`;for(const g of u){if(!g||typeof g!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${g}`);h+=`
- ${g}`}f+=h}return`${b}
${f}`}class Ue extends Error{constructor({message:t,code:n,cause:r,name:s}){var a;super(t,{cause:r}),this.__isWebAuthnError=!0,this.name=(a=s??(r instanceof Error?r.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=n}}class Ci extends Ue{constructor(t,n){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n,message:t}),this.name="WebAuthnUnknownError",this.originalError=n}}function A_({error:e,options:t}){var n,r,s;const{publicKey:a}=t;if(!a)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Ue({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((n=a.authenticatorSelection)===null||n===void 0?void 0:n.requireResidentKey)===!0)return new Ue({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((r=a.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new Ue({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Ue({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Ue({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Ue({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return a.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Ue({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Ue({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const i=window.location.hostname;if(dm(i)){if(a.rp.id!==i)return new Ue({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Ue({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new Ue({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Ue({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Ue({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function I_({error:e,options:t}){const{publicKey:n}=t;if(!n)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Ue({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Ue({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const r=window.location.hostname;if(dm(r)){if(n.rpId!==r)return new Ue({message:`The RP ID "${n.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Ue({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Ue({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Ue({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class $_{createNewAbortSignal(){if(this.controller){const n=new Error("Cancelling existing WebAuthn API call for new one");n.name="AbortError",this.controller.abort(n)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const L_=new $_;function D_(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:n,excludeCredentials:r}=e,s=Qi(e,["challenge","user","excludeCredentials"]),a=Wr(t).buffer,i=Object.assign(Object.assign({},n),{id:Wr(n.id).buffer}),l=Object.assign(Object.assign({},s),{challenge:a,user:i});if(r&&r.length>0){l.excludeCredentials=new Array(r.length);for(let c=0;c<r.length;c++){const u=r[c];l.excludeCredentials[c]=Object.assign(Object.assign({},u),{id:Wr(u.id).buffer,type:u.type||"public-key",transports:u.transports})}}return l}function U_(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:n}=e,r=Qi(e,["challenge","allowCredentials"]),s=Wr(t).buffer,a=Object.assign(Object.assign({},r),{challenge:s});if(n&&n.length>0){a.allowCredentials=new Array(n.length);for(let i=0;i<n.length;i++){const l=n[i];a.allowCredentials[i]=Object.assign(Object.assign({},l),{id:Wr(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return a}function M_(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const n=e;return{id:e.id,rawId:e.id,response:{attestationObject:tr(new Uint8Array(e.response.attestationObject)),clientDataJSON:tr(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=n.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function F_(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const n=e,r=e.getClientExtensionResults(),s=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:tr(new Uint8Array(s.authenticatorData)),clientDataJSON:tr(new Uint8Array(s.clientDataJSON)),signature:tr(new Uint8Array(s.signature)),userHandle:s.userHandle?tr(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:(t=n.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function dm(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function ch(){var e,t;return!!(He()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function z_(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ci("Browser returned unexpected credential type",t)}:{data:null,error:new Ci("Empty credential response",t)}}catch(t){return{data:null,error:A_({error:t,options:e})}}}async function B_(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Ci("Browser returned unexpected credential type",t)}:{data:null,error:new Ci("Empty credential response",t)}}catch(t){return{data:null,error:I_({error:t,options:e})}}}const V_={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},W_={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function Ti(...e){const t=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),n=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),r={};for(const s of e)if(s)for(const a in s){const i=s[a];if(i!==void 0)if(Array.isArray(i))r[a]=i;else if(n(i))r[a]=i;else if(t(i)){const l=r[a];t(l)?r[a]=Ti(l,i):r[a]=Ti(i)}else r[a]=i}return r}function q_(e,t){return Ti(V_,e,t||{})}function K_(e,t){return Ti(W_,e,t||{})}class H_{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:n,friendlyName:r,signal:s},a){try{const{data:i,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:n});if(!i)return{data:null,error:l};const c=s??L_.createNewAbortSignal();if(i.webauthn.type==="create"){const{user:u}=i.webauthn.credential_options.publicKey;u.name||(u.name=`${u.id}:${r}`),u.displayName||(u.displayName=u.name)}switch(i.webauthn.type){case"create":{const u=q_(i.webauthn.credential_options.publicKey,a==null?void 0:a.create),{data:d,error:m}=await z_({publicKey:u,signal:c});return d?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:d}},error:null}:{data:null,error:m}}case"request":{const u=K_(i.webauthn.credential_options.publicKey,a==null?void 0:a.request),{data:d,error:m}=await B_(Object.assign(Object.assign({},i.webauthn.credential_options),{publicKey:u,signal:c}));return d?{data:{factorId:t,challengeId:i.id,webauthn:{type:i.webauthn.type,credential_response:d}},error:null}:{data:null,error:m}}}}catch(i){return Y(i)?{data:null,error:i}:{data:null,error:new Yn("Unexpected error in challenge",i)}}}async _verify({challengeId:t,factorId:n,webauthn:r}){return this.client.mfa.verify({factorId:n,challengeId:t,webauthn:r})}async _authenticate({factorId:t,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},a){if(!n)return{data:null,error:new aa("rpId is required for WebAuthn authentication")};try{if(!ch())return{data:null,error:new Yn("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this.challenge({factorId:t,webauthn:{rpId:n,rpOrigins:r},signal:s},{request:a});if(!i)return{data:null,error:l};const{webauthn:c}=i;return this._verify({factorId:t,challengeId:i.challengeId,webauthn:{type:c.type,rpId:n,rpOrigins:r,credential_response:c.credential_response}})}catch(i){return Y(i)?{data:null,error:i}:{data:null,error:new Yn("Unexpected error in authenticate",i)}}}async _register({friendlyName:t,webauthn:{rpId:n=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},a){if(!n)return{data:null,error:new aa("rpId is required for WebAuthn registration")};try{if(!ch())return{data:null,error:new Yn("Browser does not support WebAuthn",null)};const{data:i,error:l}=await this._enroll({friendlyName:t});if(!i)return await this.client.mfa.listFactors().then(d=>{var m;return(m=d.data)===null||m===void 0?void 0:m.all.find(p=>p.factor_type==="webauthn"&&p.friendly_name===t&&p.status!=="unverified")}).then(d=>d?this.client.mfa.unenroll({factorId:d==null?void 0:d.id}):void 0),{data:null,error:l};const{data:c,error:u}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:n,rpOrigins:r},signal:s},{create:a});return c?this._verify({factorId:i.id,challengeId:c.challengeId,webauthn:{rpId:n,rpOrigins:r,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:u}}catch(i){return Y(i)?{data:null,error:i}:{data:null,error:new Yn("Unexpected error in register",i)}}}}T_();const G_={url:Vw,storageKey:Ww,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:qw,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function uh(e,t,n){return await n()}const xr={};class ia{get jwks(){var t,n;return(n=(t=xr[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(t){xr[this.storageKey]=Object.assign(Object.assign({},xr[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,n;return(n=(t=xr[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){xr[this.storageKey]=Object.assign(Object.assign({},xr[this.storageKey]),{cachedAt:t})}constructor(t){var n,r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},G_),t);if(this.storageKey=a.storageKey,this.instanceID=(n=ia.nextInstanceID[this.storageKey])!==null&&n!==void 0?n:0,ia.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&He()){const i=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(i),this.logDebugMessages&&console.trace(i)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new N_({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=lm(a.fetch),this.lock=a.lock||uh,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,a.lock?this.lock=a.lock:this.persistSession&&He()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=C_:this.lock=uh,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new H_(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:om()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=lh(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=lh(this.memoryStorage)),He()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${sm}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let n={},r="none";if(He()&&(n=i_(window.location.href),this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce")),He()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:a}=await this._getSessionFromURL(n,r);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),Yw(a)){const c=(t=a.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:i,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",i,"redirect type",l),await this._saveSession(i),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Y(n)?this._returnResult({error:n}):this._returnResult({error:new Yn("Unexpected error during initialization",n)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var n,r,s;try{const a=await ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:Dt}),{data:i,error:l}=a;if(l||!i)return this._returnResult({data:{user:null,session:null},error:l});const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(a){if(Y(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(t){var n,r,s;try{let a;if("email"in t){const{email:d,password:m,options:p}=t;let w=null,y=null;this.flowType==="pkce"&&([w,y]=await yr(this.storage,this.storageKey)),a=await ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:d,password:m,data:(n=p==null?void 0:p.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:w,code_challenge_method:y},xform:Dt})}else if("phone"in t){const{phone:d,password:m,options:p}=t;a=await ne(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:m,data:(r=p==null?void 0:p.data)!==null&&r!==void 0?r:{},channel:(s=p==null?void 0:p.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:Dt})}else throw new Fa("You must provide either an email or phone number and a password");const{data:i,error:l}=a;if(l||!i)return await Ke(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:l});const c=i.session,u=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(a){if(await Ke(this.storage,`${this.storageKey}-code-verifier`),Y(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(t){try{let n;if("email"in t){const{email:a,password:i,options:l}=t;n=await ne(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:ih})}else if("phone"in t){const{phone:a,password:i,options:l}=t;n=await ne(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:i,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:ih})}else throw new Fa("You must provide either an email or phone number and a password");const{data:r,error:s}=n;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!r||!r.session||!r.user){const a=new vr;return this._returnResult({data:{user:null,session:null},error:a})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(n){if(Y(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOAuth(t){var n,r,s,a;return await this._handleProviderSignIn(t.provider,{redirectTo:(n=t.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=t.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(a=t.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:n}=t;switch(n){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}}async signInWithEthereum(t){var n,r,s,a,i,l,c,u,d,m,p;let w,y;if("message"in t)w=t.message,y=t.signature;else{const{chain:_,wallet:b,statement:f,options:h}=t;let g;if(He())if(typeof b=="object")g=b;else{const M=window;if("ethereum"in M&&typeof M.ethereum=="object"&&"request"in M.ethereum&&typeof M.ethereum.request=="function")g=M.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof b!="object"||!(h!=null&&h.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");g=b}const S=new URL((n=h==null?void 0:h.url)!==null&&n!==void 0?n:window.location.href),T=await g.request({method:"eth_requestAccounts"}).then(M=>M).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!T||T.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const k=um(T[0]);let P=(r=h==null?void 0:h.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!P){const M=await g.request({method:"eth_chainId"});P=R_(M)}const O={domain:S.host,address:k,statement:f,uri:S.href,version:"1",chainId:P,nonce:(s=h==null?void 0:h.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(i=(a=h==null?void 0:h.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&i!==void 0?i:new Date,expirationTime:(l=h==null?void 0:h.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=h==null?void 0:h.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(u=h==null?void 0:h.signInWithEthereum)===null||u===void 0?void 0:u.requestId,resources:(d=h==null?void 0:h.signInWithEthereum)===null||d===void 0?void 0:d.resources};w=O_(O),y=await g.request({method:"personal_sign",params:[P_(w),k]})}try{const{data:_,error:b}=await ne(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:w,signature:y},!((m=t.options)===null||m===void 0)&&m.captchaToken?{gotrue_meta_security:{captcha_token:(p=t.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Dt});if(b)throw b;if(!_||!_.session||!_.user){const f=new vr;return this._returnResult({data:{user:null,session:null},error:f})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:b})}catch(_){if(Y(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async signInWithSolana(t){var n,r,s,a,i,l,c,u,d,m,p,w;let y,_;if("message"in t)y=t.message,_=t.signature;else{const{chain:b,wallet:f,statement:h,options:g}=t;let S;if(He())if(typeof f=="object")S=f;else{const k=window;if("solana"in k&&typeof k.solana=="object"&&("signIn"in k.solana&&typeof k.solana.signIn=="function"||"signMessage"in k.solana&&typeof k.solana.signMessage=="function"))S=k.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof f!="object"||!(g!=null&&g.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=f}const T=new URL((n=g==null?void 0:g.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in S&&S.signIn){const k=await S.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},g==null?void 0:g.signInWithSolana),{version:"1",domain:T.host,uri:T.href}),h?{statement:h}:null));let P;if(Array.isArray(k)&&k[0]&&typeof k[0]=="object")P=k[0];else if(k&&typeof k=="object"&&"signedMessage"in k&&"signature"in k)P=k;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in P&&"signature"in P&&(typeof P.signedMessage=="string"||P.signedMessage instanceof Uint8Array)&&P.signature instanceof Uint8Array)y=typeof P.signedMessage=="string"?P.signedMessage:new TextDecoder().decode(P.signedMessage),_=P.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in S)||typeof S.signMessage!="function"||!("publicKey"in S)||typeof S!="object"||!S.publicKey||!("toBase58"in S.publicKey)||typeof S.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${T.host} wants you to sign in with your Solana account:`,S.publicKey.toBase58(),...h?["",h,""]:[""],"Version: 1",`URI: ${T.href}`,`Issued At: ${(s=(r=g==null?void 0:g.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((a=g==null?void 0:g.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${g.signInWithSolana.notBefore}`]:[],...!((i=g==null?void 0:g.signInWithSolana)===null||i===void 0)&&i.expirationTime?[`Expiration Time: ${g.signInWithSolana.expirationTime}`]:[],...!((l=g==null?void 0:g.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${g.signInWithSolana.chainId}`]:[],...!((c=g==null?void 0:g.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${g.signInWithSolana.nonce}`]:[],...!((u=g==null?void 0:g.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${g.signInWithSolana.requestId}`]:[],...!((m=(d=g==null?void 0:g.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||m===void 0)&&m.length?["Resources",...g.signInWithSolana.resources.map(P=>`- ${P}`)]:[]].join(`
`);const k=await S.signMessage(new TextEncoder().encode(y),"utf8");if(!k||!(k instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");_=k}}try{const{data:b,error:f}=await ne(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:tr(_)},!((p=t.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(w=t.options)===null||w===void 0?void 0:w.captchaToken}}:null),xform:Dt});if(f)throw f;if(!b||!b.session||!b.user){const h=new vr;return this._returnResult({data:{user:null,session:null},error:h})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:f})}catch(b){if(Y(b))return this._returnResult({data:{user:null,session:null},error:b});throw b}}async _exchangeCodeForSession(t){const n=await Kn(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(n??"").split("/");try{if(!r&&this.flowType==="pkce")throw new Xw;const{data:a,error:i}=await ne(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:r},xform:Dt});if(await Ke(this.storage,`${this.storageKey}-code-verifier`),i)throw i;if(!a||!a.session||!a.user){const l=new vr;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:s??null}),error:i})}catch(a){if(await Ke(this.storage,`${this.storageKey}-code-verifier`),Y(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(t){try{const{options:n,provider:r,token:s,access_token:a,nonce:i}=t,l=await ne(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:Dt}),{data:c,error:u}=l;if(u)return this._returnResult({data:{user:null,session:null},error:u});if(!c||!c.session||!c.user){const d=new vr;return this._returnResult({data:{user:null,session:null},error:d})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:u})}catch(n){if(Y(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async signInWithOtp(t){var n,r,s,a,i;try{if("email"in t){const{email:l,options:c}=t;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await yr(this.storage,this.storageKey));const{error:m}=await ne(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(r=c==null?void 0:c.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:m})}if("phone"in t){const{phone:l,options:c}=t,{data:u,error:d}=await ne(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(a=c==null?void 0:c.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(i=c==null?void 0:c.channel)!==null&&i!==void 0?i:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d})}throw new Fa("You must provide either an email or phone number.")}catch(l){if(await Ke(this.storage,`${this.storageKey}-code-verifier`),Y(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(t){var n,r;try{let s,a;"options"in t&&(s=(n=t.options)===null||n===void 0?void 0:n.redirectTo,a=(r=t.options)===null||r===void 0?void 0:r.captchaToken);const{data:i,error:l}=await ne(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:Dt});if(l)throw l;if(!i)throw new Error("An error occurred on token verification.");const c=i.session,u=i.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:u,session:c},error:null})}catch(s){if(Y(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(t){var n,r,s,a,i;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await yr(this.storage,this.storageKey));const u=await ne(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(r=(n=t.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:b_});return!((a=u.data)===null||a===void 0)&&a.url&&He()&&!(!((i=t.options)===null||i===void 0)&&i.skipBrowserRedirect)&&window.location.assign(u.data.url),this._returnResult(u)}catch(l){if(await Ke(this.storage,`${this.storageKey}-code-verifier`),Y(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:n},error:r}=t;if(r)throw r;if(!n)throw new ft;const{error:s}=await ne(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(t){if(Y(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const n=`${this.url}/resend`;if("email"in t){const{email:r,type:s,options:a}=t,{error:i}=await ne(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},redirectTo:a==null?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:i})}else if("phone"in t){const{phone:r,type:s,options:a}=t,{data:i,error:l}=await ne(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:l})}throw new Fa("You must provide either an email or phone number and a type")}catch(n){if(Y(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(t,n){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await t(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const n=await Kn(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?t=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const r=t.expires_at?t.expires_at*1e3-Date.now()<Fo:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",t.expires_at),!r){if(this.userStorage){const i=await Kn(this.userStorage,this.storageKey+"-user");i!=null&&i.user?t.user=i.user:t.user=Vo()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const i={value:this.suppressGetSessionWarning};t.user=w_(t.user,i),i.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const n=await this._acquireLock(-1,async()=>await this._getUser());return n.data.user&&(this.suppressGetSessionWarning=!0),n}async _getUser(t){try{return t?await ne(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Sn}):await this._useSession(async n=>{var r,s,a;const{data:i,error:l}=n;if(l)throw l;return!(!((r=i.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ft}:await ne(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0,xform:Sn})})}catch(n){if(Y(n))return Qw(n)&&(await this._removeSession(),await Ke(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:n});throw n}}async updateUser(t,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,n))}async _updateUser(t,n={}){try{return await this._useSession(async r=>{const{data:s,error:a}=r;if(a)throw a;if(!s.session)throw new ft;const i=s.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await yr(this.storage,this.storageKey));const{data:u,error:d}=await ne(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:i.access_token,xform:Sn});if(d)throw d;return i.user=u.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),this._returnResult({data:{user:i.user},error:null})})}catch(r){if(await Ke(this.storage,`${this.storageKey}-code-verifier`),Y(r))return this._returnResult({data:{user:null},error:r});throw r}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new ft;const n=Date.now()/1e3;let r=n,s=!0,a=null;const{payload:i}=Bo(t.access_token);if(i.exp&&(r=i.exp,s=r<=n),s){const{data:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;a={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(n){if(Y(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async n=>{var r;if(!t){const{data:i,error:l}=n;if(l)throw l;t=(r=i.session)!==null&&r!==void 0?r:void 0}if(!(t!=null&&t.refresh_token))throw new ft;const{data:s,error:a}=await this._callRefreshToken(t.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(n){if(Y(n))return this._returnResult({data:{user:null,session:null},error:n});throw n}}async _getSessionFromURL(t,n){try{if(!He())throw new za("No browser detected.");if(t.error||t.error_description||t.error_code)throw new za(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Zd("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new za("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new Zd("No code detected.");const{data:h,error:g}=await this._exchangeCodeForSession(t.code);if(g)throw g;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:h.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:a,refresh_token:i,expires_in:l,expires_at:c,token_type:u}=t;if(!a||!l||!i||!u)throw new za("No session defined in URL");const d=Math.round(Date.now()/1e3),m=parseInt(l);let p=d+m;c&&(p=parseInt(c));const w=p-d;w*1e3<=br&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${w}s, should have been closer to ${m}s`);const y=p-m;d-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,p,d):d-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,p,d);const{data:_,error:b}=await this._getUser(a);if(b)throw b;const f={provider_token:r,provider_refresh_token:s,access_token:a,expires_in:m,expires_at:p,refresh_token:i,token_type:u,user:_.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:f,redirectType:t.type},error:null})}catch(r){if(Y(r))return this._returnResult({data:{session:null,redirectType:null},error:r});throw r}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const n=await Kn(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&n)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:s,error:a}=n;if(a)return this._returnResult({error:a});const i=(r=s.session)===null||r===void 0?void 0:r.access_token;if(i){const{error:l}=await this.admin.signOut(i,t);if(l&&!(Jw(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return t!=="others"&&(await this._removeSession(),await Ke(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const n=a_(),r={id:n,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(t){return await this._useSession(async n=>{var r,s;try{const{data:{session:a},error:i}=n;if(i)throw i;await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",t,"session",a)}catch(a){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",a),console.error(a)}})}async resetPasswordForEmail(t,n={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await yr(this.storage,this.storageKey,!0));try{return await ne(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(a){if(await Ke(this.storage,`${this.storageKey}-code-verifier`),Y(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var t;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:(t=n.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(n){if(Y(n))return this._returnResult({data:null,error:n});throw n}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var n;try{const{data:r,error:s}=await this._useSession(async a=>{var i,l,c,u,d;const{data:m,error:p}=a;if(p)throw p;const w=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await ne(this.fetch,"GET",w,{headers:this.headers,jwt:(d=(u=m.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return He()&&!(!((n=t.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),this._returnResult({data:{provider:t.provider,url:r==null?void 0:r.url},error:null})}catch(r){if(Y(r))return this._returnResult({data:{provider:t.provider,url:null},error:r});throw r}}async linkIdentityIdToken(t){return await this._useSession(async n=>{var r;try{const{error:s,data:{session:a}}=n;if(s)throw s;const{options:i,provider:l,token:c,access_token:u,nonce:d}=t,m=await ne(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(r=a==null?void 0:a.access_token)!==null&&r!==void 0?r:void 0,body:{provider:l,id_token:c,access_token:u,nonce:d,link_identity:!0,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},xform:Dt}),{data:p,error:w}=m;return w?this._returnResult({data:{user:null,session:null},error:w}):!p||!p.session||!p.user?this._returnResult({data:{user:null,session:null},error:new vr}):(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("USER_UPDATED",p.session)),this._returnResult({data:p,error:w}))}catch(s){if(await Ke(this.storage,`${this.storageKey}-code-verifier`),Y(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(t){try{return await this._useSession(async n=>{var r,s;const{data:a,error:i}=n;if(i)throw i;return await ne(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(n){if(Y(n))return this._returnResult({data:null,error:n});throw n}}async _refreshAccessToken(t){const n=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await c_(async s=>(s>0&&await l_(200*Math.pow(2,s-1)),this._debug(n,"refreshing attempt",s),await ne(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Dt})),(s,a)=>{const i=200*Math.pow(2,s);return a&&zo(a)&&Date.now()+i-r<br})}catch(r){if(this._debug(n,"error",r),Y(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}finally{this._debug(n,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",n,"url",r),He()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:t,url:r},error:null}}async _recoverAndRefresh(){var t,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await Kn(this.storage,this.storageKey);if(s&&this.userStorage){let i=await Kn(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!i&&(i={user:s.user},await Sr(this.userStorage,this.storageKey+"-user",i)),s.user=(t=i==null?void 0:i.user)!==null&&t!==void 0?t:Vo()}else if(s&&!s.user&&!s.user){const i=await Kn(this.storage,this.storageKey+"-user");i&&(i!=null&&i.user)?(s.user=i.user,await Ke(this.storage,this.storageKey+"-user"),await Sr(this.storage,this.storageKey,s)):s.user=Vo()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const a=((n=s.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Fo;if(this._debug(r,`session has${a?"":" not"} expired with margin of ${Fo}s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:i}=await this._callRefreshToken(s.refresh_token);i&&(console.error(i),zo(i)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:i,error:l}=await this._getUser(s.access_token);!l&&(i!=null&&i.user)?(s.user=i.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(i){console.error("Error getting user data:",i),this._debug(r,"error getting user data, skipping SIGNED_IN notification",i)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var n,r;if(!t)throw new ft;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Xi;const{data:a,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!a.session)throw new ft;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={data:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(s,"error",a),Y(a)){const i={data:null,error:a};return zo(a)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(i),i}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,n,r=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:t,session:n});const a=[],i=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,n)}catch(c){a.push(c)}});if(await Promise.all(i),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Ke(this.storage,`${this.storageKey}-code-verifier`);const n=Object.assign({},t),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await Sr(this.userStorage,this.storageKey+"-user",{user:n.user});const s=Object.assign({},n);delete s.user;const a=sh(s);await Sr(this.storage,this.storageKey,a)}else{const s=sh(n);await Sr(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Ke(this.storage,this.storageKey),await Ke(this.storage,this.storageKey+"-code-verifier"),await Ke(this.storage,this.storageKey+"-user"),this.userStorage&&await Ke(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&He()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),br);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-t)/br);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${br}ms, refresh threshold is ${ec} ticks`),s<=ec&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof cm)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!He()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const n=`#_onVisibilityChanged(${t})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,n,r){const s=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[a,i]=await yr(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(i)}`});s.push(l.toString())}if(r!=null&&r.queryParams){const a=new URLSearchParams(r.queryParams);s.push(a.toString())}return r!=null&&r.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async n=>{var r;const{data:s,error:a}=n;return a?this._returnResult({data:null,error:a}):await ne(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Y(n))return this._returnResult({data:null,error:n});throw n}}async _enroll(t){try{return await this._useSession(async n=>{var r,s;const{data:a,error:i}=n;if(i)return this._returnResult({data:null,error:i});const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:c,error:u}=await ne(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=a==null?void 0:a.session)===null||r===void 0?void 0:r.access_token});return u?this._returnResult({data:null,error:u}):(t.factorType==="totp"&&c.type==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(n){if(Y(n))return this._returnResult({data:null,error:n});throw n}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:a}=n;if(a)return this._returnResult({data:null,error:a});const i=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?M_(t.webauthn.credential_response):F_(t.webauthn.credential_response)})}:{code:t.code}),{data:l,error:c}=await ne(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:i,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(n){if(Y(n))return this._returnResult({data:null,error:n});throw n}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:a}=n;if(a)return this._returnResult({data:null,error:a});const i=await ne(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});if(i.error)return i;const{data:l}=i;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:D_(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:U_(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(n){if(Y(n))return this._returnResult({data:null,error:n});throw n}})}async _challengeAndVerify(t){const{data:n,error:r}=await this._challenge({factorId:t.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:t.factorId,challengeId:n.id,code:t.code})}async _listFactors(){var t;const{data:{user:n},error:r}=await this.getUser();if(r)return{data:null,error:r};const s={all:[],phone:[],totp:[],webauthn:[]};for(const a of(t=n==null?void 0:n.factors)!==null&&t!==void 0?t:[])s.all.push(a),a.status==="verified"&&s[a.factor_type].push(a);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var t,n;const{data:{session:r},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=Bo(r.access_token);let i=null;a.aal&&(i=a.aal);let l=i;((n=(t=r.user.factors)===null||t===void 0?void 0:t.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const u=a.amr||[];return{data:{currentLevel:i,nextLevel:l,currentAuthenticationMethods:u},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async n=>{const{data:{session:r},error:s}=n;return s?this._returnResult({data:null,error:s}):r?await ne(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:r.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new ft})})}catch(n){if(Y(n))return this._returnResult({data:null,error:n});throw n}}async _approveAuthorization(t,n){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new ft});const i=await ne(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return i.data&&i.data.redirect_url&&He()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(r){if(Y(r))return this._returnResult({data:null,error:r});throw r}}async _denyAuthorization(t,n){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new ft});const i=await ne(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return i.data&&i.data.redirect_url&&He()&&!(n!=null&&n.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(r){if(Y(r))return this._returnResult({data:null,error:r});throw r}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:n},error:r}=t;return r?this._returnResult({data:null,error:r}):n?await ne(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new ft})})}catch(t){if(Y(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async n=>{const{data:{session:r},error:s}=n;return s?this._returnResult({data:null,error:s}):r?(await ne(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new ft})})}catch(n){if(Y(n))return this._returnResult({data:null,error:n});throw n}}async fetchJwk(t,n={keys:[]}){let r=n.keys.find(l=>l.kid===t);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(l=>l.kid===t),r&&this.jwks_cached_at+Hw>s)return r;const{data:a,error:i}=await ne(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=s,r=a.keys.find(l=>l.kid===t),!r)?null:r}async getClaims(t,n={}){try{let r=t;if(!r){const{data:w,error:y}=await this.getSession();if(y||!w.session)return this._returnResult({data:null,error:y});r=w.session.access_token}const{header:s,payload:a,signature:i,raw:{header:l,payload:c}}=Bo(r);n!=null&&n.allowExpired||g_(a.exp);const u=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!u){const{error:w}=await this.getUser(r);if(w)throw w;return{data:{claims:a,header:s,signature:i},error:null}}const d=v_(s.alg),m=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,m,i,r_(`${l}.${c}`)))throw new rc("Invalid JWT signature");return{data:{claims:a,header:s,signature:i},error:null}}catch(r){if(Y(r))return this._returnResult({data:null,error:r});throw r}}}ia.nextInstanceID={};const J_=ia,Q_="2.89.0";let Ss="";typeof Deno<"u"?Ss="deno":typeof document<"u"?Ss="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ss="react-native":Ss="node";const Y_={"X-Client-Info":`supabase-js-${Ss}/${Q_}`},X_={headers:Y_},Z_={schema:"public"},ex={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},tx={};function oa(e){"@babel/helpers - typeof";return oa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oa(e)}function nx(e,t){if(oa(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(oa(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function rx(e){var t=nx(e,"string");return oa(t)=="symbol"?t:t+""}function sx(e,t,n){return(t=rx(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?dh(Object(n),!0).forEach(function(r){sx(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dh(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}const ax=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),ix=()=>Headers,ox=(e,t,n)=>{const r=ax(n),s=ix();return async(a,i)=>{var l;const c=(l=await t())!==null&&l!==void 0?l:e;let u=new s(i==null?void 0:i.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),r(a,$e($e({},i),{},{headers:u}))}};function lx(e){return e.endsWith("/")?e:e+"/"}function cx(e,t){var n,r;const{db:s,auth:a,realtime:i,global:l}=e,{db:c,auth:u,realtime:d,global:m}=t,p={db:$e($e({},c),s),auth:$e($e({},u),a),realtime:$e($e({},d),i),storage:{},global:$e($e($e({},m),l),{},{headers:$e($e({},(n=m==null?void 0:m.headers)!==null&&n!==void 0?n:{}),(r=l==null?void 0:l.headers)!==null&&r!==void 0?r:{})}),accessToken:async()=>""};return e.accessToken?p.accessToken=e.accessToken:delete p.accessToken,p}function ux(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(lx(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var dx=class extends J_{constructor(e){super(e)}},hx=class{constructor(e,t,n){var r,s;this.supabaseUrl=e,this.supabaseKey=t;const a=ux(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);const i=`sb-${a.hostname.split(".")[0]}-auth-token`,l={db:Z_,realtime:tx,auth:$e($e({},ex),{},{storageKey:i}),global:X_},c=cx(n??{},l);if(this.storageKey=(r=c.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(s=c.global.headers)!==null&&s!==void 0?s:{},c.accessToken)this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(d,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}});else{var u;this.auth=this._initSupabaseAuthClient((u=c.auth)!==null&&u!==void 0?u:{},this.headers,c.global.fetch)}this.fetch=ox(t,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient($e({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.accessToken&&this.accessToken().then(d=>this.realtime.setAuth(d)).catch(d=>console.warn("Failed to set initial Realtime auth token:",d)),this.rest=new q0(new URL("rest/v1",a).href,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),this.storage=new Bw(this.storageUrl.href,this.headers,this.fetch,n==null?void 0:n.storage),c.accessToken||this._listenForAuthEvents()}get functions(){return new F0(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},n={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,n)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,n;if(e.accessToken)return await e.accessToken();const{data:r}=await e.auth.getSession();return(t=(n=r.session)===null||n===void 0?void 0:n.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:r,userStorage:s,storageKey:a,flowType:i,lock:l,debug:c,throwOnError:u},d,m){const p={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new dx({url:this.authUrl.href,headers:$e($e({},p),d),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:n,storage:r,userStorage:s,flowType:i,lock:l,debug:c,throwOnError:u,fetch:m,hasCustomAuthorizationHeader:Object.keys(this.headers).some(w=>w.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new lw(this.realtimeUrl.href,$e($e({},e),{},{params:$e($e({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,n){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==n?(this.changedAccessToken=n,this.realtime.setAuth(n)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const fx=(e,t,n)=>new hx(e,t,n);function px(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}px()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const mx="https://qiryotbpalcwckgtimlj.supabase.co",gx="sb_publishable_hB8UsGZzUXgpxPzsRKIs9g_cZ10xbuW",me=fx(mx,gx),hm=x.createContext(void 0),vx=({children:e})=>{const[t,n]=x.useState(null),[r,s]=x.useState(!0);x.useEffect(()=>{me.auth.getSession().then(({data:l,error:c})=>{c&&console.error(c),n(l.session??null),s(!1)});const{data:i}=me.auth.onAuthStateChange((l,c)=>{n(c)});return()=>{i.subscription.unsubscribe()}},[]);const a=x.useMemo(()=>({session:t,loading:r,signIn:async(i,l)=>{const{error:c}=await me.auth.signInWithPassword({email:i,password:l});if(c)throw c},signUp:async(i,l)=>{const{error:c}=await me.auth.signUp({email:i,password:l});if(c)throw c},signOut:async()=>{const{error:i}=await me.auth.signOut();if(i)throw i}}),[t,r]);return o.jsx(hm.Provider,{value:a,children:e})},hr=()=>{const e=x.useContext(hm);if(!e)throw new Error("useAuth must be used within AuthProvider");return e},yx="/assets/logo-BdeMil-c.png",wx=[{to:"/",label:"Dashboard"},{to:"/portfolio",label:"Portafoglio"},{to:"/transactions",label:"Transazioni",children:[{to:"/transactions/filter",label:"Filtra per"}]},{to:"/goals",label:"Obiettivi"},{to:"/categories",label:"Categorie"},{to:"/analytics",label:"Analytics",children:[{to:"/analytics/stress-test",label:"Stress test"}]},{to:"/settings",label:"Impostazioni"}],_x=e=>{if(!e)return"Utente";const t=e.split("@")[0];return t.length<=2?`${t.charAt(0)}**`:`${t.slice(0,Math.min(5,t.length))}**`},xx=()=>{const{session:e,signOut:t}=hr();return o.jsxs("div",{className:"app-shell",children:[o.jsxs("aside",{className:"sidebar",children:[o.jsxs("div",{className:"sidebar-brand",children:[o.jsx("div",{className:"brand-mark",children:o.jsx("img",{className:"brand-logo",src:yx,alt:"Portfolio Pro"})}),o.jsxs("div",{className:"brand-text",children:[o.jsx("strong",{children:"Portfolio Pro"}),o.jsx("span",{children:"Control room"})]})]}),o.jsx("nav",{className:"nav-list",children:wx.map(n=>o.jsxs("div",{className:"nav-group",children:[o.jsxs(zd,{to:n.to,className:({isActive:r})=>r?"nav-link active":"nav-link",children:[o.jsx("span",{className:"nav-dot"}),n.label]}),n.children&&o.jsx("div",{className:"nav-sublist",children:n.children.map(r=>o.jsx(zd,{to:r.to,className:({isActive:s})=>s?"nav-sublink active":"nav-sublink",children:r.label},r.to))})]},n.to))})]}),o.jsxs("div",{className:"content",children:[o.jsxs("header",{className:"topbar",children:[o.jsxs("div",{children:[o.jsx("strong",{children:_x(e==null?void 0:e.user.email)}),o.jsx("div",{className:"pill",children:"EUR / USD"})]}),o.jsx("div",{className:"topbar-actions",children:o.jsx("button",{className:"button secondary",onClick:t,children:"Esci"})})]}),o.jsx("main",{className:"page",children:o.jsx(w0,{})})]})]})},jx=()=>{const{signIn:e}=hr(),[t,n]=x.useState(""),[r,s]=x.useState(""),[a,i]=x.useState(null),[l,c]=x.useState(!1),u=async d=>{d.preventDefault(),i(null),c(!0);try{await e(t,r)}catch(m){i(m.message)}finally{c(!1)}};return o.jsx("div",{className:"auth-shell",children:o.jsxs("form",{className:"auth-card",onSubmit:u,children:[o.jsxs("div",{className:"sidebar-brand",children:[o.jsx("div",{className:"brand-mark",children:"PP"}),o.jsxs("div",{className:"brand-text",children:[o.jsx("strong",{children:"Portfolio Pro"}),o.jsx("span",{children:"Accesso sicuro"})]})]}),o.jsx("h1",{children:"Accedi"}),o.jsxs("label",{children:["Email",o.jsx("input",{className:"input",type:"email",value:t,onChange:d=>n(d.target.value),required:!0})]}),o.jsxs("label",{children:["Password",o.jsx("input",{className:"input",type:"password",value:r,onChange:d=>s(d.target.value),required:!0})]}),a&&o.jsx("div",{className:"error",children:a}),o.jsx("button",{className:"button",type:"submit",disabled:l,children:l?"Accesso...":"Entra"}),o.jsxs("div",{className:"auth-toggle",children:["Non hai un account? ",o.jsx(au,{to:"/register",children:"Registrati"})]})]})})},bx=()=>{const{signUp:e}=hr(),[t,n]=x.useState(""),[r,s]=x.useState(""),[a,i]=x.useState(null),[l,c]=x.useState(!1),u=async d=>{d.preventDefault(),i(null),c(!0);try{await e(t,r)}catch(m){i(m.message)}finally{c(!1)}};return o.jsx("div",{className:"auth-shell",children:o.jsxs("form",{className:"auth-card",onSubmit:u,children:[o.jsxs("div",{className:"sidebar-brand",children:[o.jsx("div",{className:"brand-mark",children:"PP"}),o.jsxs("div",{className:"brand-text",children:[o.jsx("strong",{children:"Portfolio Pro"}),o.jsx("span",{children:"Nuovo account"})]})]}),o.jsx("h1",{children:"Registrati"}),o.jsx("div",{className:"notice",children:"Dopo la registrazione riceverai una email di conferma."}),o.jsxs("label",{children:["Email",o.jsx("input",{className:"input",type:"email",value:t,onChange:d=>n(d.target.value),required:!0})]}),o.jsxs("label",{children:["Password",o.jsx("input",{className:"input",type:"password",value:r,onChange:d=>s(d.target.value),required:!0})]}),a&&o.jsx("div",{className:"error",children:a}),o.jsx("button",{className:"button",type:"submit",disabled:l,children:l?"Creazione...":"Crea account"}),o.jsxs("div",{className:"auth-toggle",children:["Hai gia un account? ",o.jsx(au,{to:"/login",children:"Accedi"})]})]})})},je=e=>{if(e)throw e},Vt=e=>e==null?0:Number(e),sc=e=>{if(!e||typeof e!="object")return!1;const t=e;return t.code==="42P01"?!0:typeof t.message!="string"?!1:!!(/does not exist/i.test(t.message)||/schema cache/i.test(t.message)||/Could not find the table/i.test(t.message))},ac=async()=>{const{data:e,error:t}=await me.from("categories").select("*").order("sort_order",{ascending:!0}).order("name");return je(t),e??[]},hh=async()=>{const{data:e,error:t}=await me.from("accounts").select("*").order("created_at",{ascending:!0});return je(t),(e??[]).map(n=>({...n,opening_balance:Vt(n.opening_balance)}))},fm=async e=>{const{error:t}=await me.from("accounts").insert(e);je(t)},Sx=async(e,t)=>{const{error:n}=await me.from("accounts").update(t).eq("id",e);je(n)},kx=async e=>{const{error:t}=await me.from("accounts").delete().eq("id",e);je(t)},ic=async e=>{const{error:t}=await me.from("categories").insert(e);je(t)},pm=async(e,t)=>{const{error:n}=await me.from("categories").update(t).eq("id",e);je(n)},Nx=async e=>{const{error:t}=await me.from("categories").delete().eq("id",e);je(t)},mm=async()=>{const{error:e}=await me.rpc("seed_default_categories");je(e)},Ex=async()=>{const{data:e,error:t}=await me.from("transactions").select("*").order("date",{ascending:!1});return je(t),(e??[]).map(n=>({...n,amount:Vt(n.amount)}))},Cx=async e=>{const{error:t}=await me.from("transactions").insert(e);je(t)},gm=async e=>{if(e.length===0)return;const{error:t}=await me.from("transactions").insert(e);je(t)},Tx=async(e,t)=>{const{error:n}=await me.from("transactions").update(t).eq("id",e);je(n)},Rx=async e=>{const{error:t}=await me.from("transactions").delete().eq("id",e);je(t)},Px=async()=>{const{data:e,error:t}=await me.from("holdings").select("*").order("created_at",{ascending:!1});return je(t),(e??[]).map(n=>({...n,emoji:n.emoji??null,target_pct:n.target_pct??null,quantity:Vt(n.quantity),avg_cost:Vt(n.avg_cost),total_cap:Vt(n.total_cap),current_value:Vt(n.current_value)}))},Ox=async e=>{const{error:t}=await me.from("holdings").insert(e);je(t)},Ax=async e=>{if(e.length===0)return;const{error:t}=await me.from("holdings").insert(e);je(t)},ws=async(e,t)=>{const{error:n}=await me.from("holdings").update(t).eq("id",e);je(n)},Ix=async e=>{const{error:t}=await me.from("holdings").delete().eq("id",e);je(t)},$x=async()=>{const{data:e,error:t}=await me.from("goals").select("*").order("created_at",{ascending:!1});return je(t),(e??[]).map(n=>({...n,target_amount:Vt(n.target_amount)}))},Lx=async e=>{const{error:t}=await me.from("goals").insert(e);je(t)},Dx=async(e,t)=>{const{error:n}=await me.from("goals").update(t).eq("id",e);je(n)},Ux=async e=>{const{error:t}=await me.from("goals").delete().eq("id",e);je(t)},Mx=async()=>{const{data:e,error:t}=await me.from("settings").select("*").maybeSingle();return je(t),e?{...e,emergency_fund:Vt(e.emergency_fund),emergency_fund_months:e.emergency_fund_months===null||e.emergency_fund_months===void 0?null:Vt(e.emergency_fund_months),cash_target_cap:e.cash_target_cap===null?null:Vt(e.cash_target_cap),target_cash_pct:e.target_cash_pct??null,target_etf_pct:e.target_etf_pct??null,target_bond_pct:e.target_bond_pct??null,target_emergency_pct:e.target_emergency_pct??null,rebalance_months:e.rebalance_months??null}:null},vm=async e=>{const{error:t}=await me.from("settings").upsert(e,{onConflict:"user_id"});je(t)},Fx=async()=>{const{data:e,error:t}=await me.from("allocation_targets").select("*").order("sort_order",{ascending:!0}).order("created_at",{ascending:!0});return sc(t)?[]:(je(t),(e??[]).map(n=>({...n,pct:Vt(n.pct),sort_order:n.sort_order??null,color:n.color??null})))},zx=async e=>{if(e.length===0)return!0;const t=e[0].user_id,{error:n}=await me.from("allocation_targets").delete().eq("user_id",t);if(sc(n))return!1;je(n);const{error:r}=await me.from("allocation_targets").insert(e);return sc(r)?!1:(je(r),!0)},fn=()=>{const[e,t]=x.useState([]),[n,r]=x.useState([]),[s,a]=x.useState([]),[i,l]=x.useState([]),[c,u]=x.useState([]),[d,m]=x.useState(null),[p,w]=x.useState(!0),[y,_]=x.useState(null),b=x.useRef(!1),f=g=>g.some(S=>/emergenza|emergency/i.test(S.name)),h=x.useCallback(async()=>{w(!0),_(null);try{const[g,S,T,k,P,O]=await Promise.all([hh(),ac(),$x(),Ex(),Px(),Mx()]);let M=g;if(!f(g)&&!b.current){b.current=!0;try{await fm({name:"Fondo emergenza",type:"bank",emoji:null,currency:(O==null?void 0:O.base_currency)??"EUR",opening_balance:0}),M=await hh()}catch(z){console.error("Impossibile creare il conto Fondo emergenza.",z)}finally{b.current=!1}}t(M),r(S),a(T),l(k),u(P),m(O)}catch(g){_(g.message)}finally{w(!1)}},[]);return x.useEffect(()=>{h()},[h]),{accounts:e,categories:n,goals:s,transactions:i,holdings:c,settings:d,loading:p,error:y,refresh:h}},Zr=e=>e||0,la=e=>e.reduce((t,n)=>t+Zr(n.current_value),0),du=e=>e.reduce((t,n)=>t+Zr(n.total_cap),0),ym=e=>{const t=du(e);return t===0?0:(la(e)-t)/t},wm=e=>{let t=0,n=0;const r=new Date,s=1/12;return e.forEach(a=>{const i=Zr(a.total_cap),l=Zr(a.current_value);if(i<=0||l<=0)return;const c=new Date(a.start_date),u=(r.getTime()-c.getTime())/(365*24*60*60*1e3);if(u<s)return;const d=Math.pow(l/i,1/u)-1;t+=d*i,n+=i}),n===0?Number.NaN:t/n},_m=e=>{const t=e.filter(r=>r.type==="income").reduce((r,s)=>r+s.amount,0);if(t===0)return 0;const n=e.filter(r=>r.type==="expense").reduce((r,s)=>r+s.amount,0);return(t-n)/t},xm=(e,t)=>{const n=new Set(t.filter(i=>i.is_fixed).map(i=>i.id)),r=new Date,s=new Date(r.getTime()-30*24*60*60*1e3),a=e.filter(i=>i.type==="expense"&&n.has(i.category_id)&&new Date(i.date)>=s).reduce((i,l)=>i+l.amount,0);return a>0?a:e.filter(i=>i.type==="expense"&&new Date(i.date)>=s).reduce((i,l)=>i+l.amount,0)},fh=e=>`${e.getFullYear()}-${e.getMonth()+1}`,jm=e=>new Intl.DateTimeFormat("it-IT",{month:"short",year:"2-digit"}).format(e),bm=(e,t=6)=>{const n=[],r=new Map,s=new Date;for(let a=t-1;a>=0;a-=1){const i=new Date(s.getFullYear(),s.getMonth()-a,1),l={label:jm(i),value:0,income:0,expense:0};n.push(l),r.set(fh(i),l)}return e.forEach(a=>{const i=r.get(fh(new Date(a.date)));i&&(a.type==="income"?(i.income+=a.amount,i.value+=a.amount):a.type==="expense"?(i.expense+=a.amount,i.value-=a.amount):i.value+=a.flow==="in"?a.amount:-a.amount)}),n},Bx=(e,t=12)=>{const n=[],r=new Date;for(let s=t-1;s>=0;s-=1){const a=new Date(r.getFullYear(),r.getMonth()-s,1);n.push({label:jm(a),value:0,income:0,expense:0})}return n.forEach((s,a)=>{const i=new Date(r.getFullYear(),r.getMonth()-(t-1-a),1);e.forEach(l=>{const c=new Date(l.start_date),u=(r.getFullYear()-c.getFullYear())*12+(r.getMonth()-c.getMonth());if(u<=0){a===n.length-1&&(s.value+=l.current_value);return}const d=(i.getFullYear()-c.getFullYear())*12+(i.getMonth()-c.getMonth());if(d<0)return;const m=Math.min(d/u,1),p=l.total_cap+(l.current_value-l.total_cap)*m;s.value+=p})}),n},Sm=(e,t)=>{const n=new Map(t.map(s=>[s.id,s])),r=new Map;return e.filter(s=>s.type==="expense").forEach(s=>{var i;const a=((i=n.get(s.category_id))==null?void 0:i.name)??"Altro";r.set(a,(r.get(a)??0)+s.amount)}),Array.from(r.entries()).map(([s,a])=>({label:s,value:a})).sort((s,a)=>a.value-s.value)},hu=e=>{const t=new Map;return e.forEach(n=>{const r=n.asset_class||"Altro";t.set(r,(t.get(r)??0)+n.current_value)}),Array.from(t.entries()).map(([n,r])=>({label:n,value:r})).sort((n,r)=>r.value-n.value)},Zi=(e,t)=>{const n=new Map;return e.forEach(r=>{n.set(r.id,Zr(r.opening_balance))}),t.forEach(r=>{if(!r.account_id)return;const s=n.get(r.account_id)??0,a=r.flow==="in"?r.amount:-r.amount;n.set(r.account_id,s+a)}),e.map(r=>({...r,balance:n.get(r.id)??0}))},km=(e,t=0)=>{const n=e.filter(r=>/emergenza|emergency/i.test(r.name));return n.length===0?t:n.reduce((r,s)=>r+Zr(s.balance),0)},Et=(e,t)=>new Intl.NumberFormat("it-IT",{style:"currency",currency:t,maximumFractionDigits:2}).format(e),te=(e,t)=>Number.isFinite(e)?Et(e,t):"N/D",Nm=e=>new Intl.NumberFormat("it-IT",{style:"percent",maximumFractionDigits:1}).format(e),mt=(e,t=9.99)=>!Number.isFinite(e)||Math.abs(e)>t?"N/D":Nm(e),oc=e=>new Intl.NumberFormat("it-IT",{maximumFractionDigits:2}).format(e),Em=e=>new Intl.DateTimeFormat("it-IT",{day:"2-digit",month:"short",year:"numeric"}).format(new Date(e)),Cm=({data:e})=>{if(e.length===0)return o.jsx("div",{className:"empty",children:"Nessun dato disponibile."});const t=x.useRef(null),[n,r]=x.useState(null),[s,a]=x.useState({x:0,y:0}),i=520,l=220,c=24,u=Math.max(1,...e.map(y=>Math.max(y.income,y.expense))),d=(i-c*2)/e.length,m=d*.3,p=y=>{const _=y.currentTarget.getBoundingClientRect(),f=(y.clientX-_.left)/_.width*i,h=Math.round((f-c)/d),g=Math.min(Math.max(h,0),e.length-1),S=c+g*d+d/2;r(g),a({x:S/i*_.width,y:_.height*.1})},w=()=>{r(null)};return o.jsxs("div",{className:"chart-interactive",ref:t,children:[o.jsx("svg",{viewBox:`0 0 ${i} ${l}`,width:"100%",height:"220",onMouseMove:p,onMouseLeave:w,children:e.map((y,_)=>{const b=c+_*d+d/2,f=y.income/u*(l-c*2),h=y.expense/u*(l-c*2);return o.jsxs("g",{children:[o.jsx("rect",{x:b-m-4,y:l-c-f,width:m,height:f,fill:"#1f6f5c",rx:"6"}),o.jsx("rect",{x:b+4,y:l-c-h,width:m,height:h,fill:"#c8782b",rx:"6"})]},y.label)})}),n!==null&&o.jsxs("div",{className:"chart-tooltip",style:{left:s.x,top:s.y},children:[o.jsx("strong",{children:e[n].label}),o.jsxs("span",{children:["Entrate: ",e[n].income.toFixed(2)]}),o.jsxs("span",{children:["Uscite: ",e[n].expense.toFixed(2)]})]})]})},Tm=({data:e,color:t="#2f5b8a"})=>{if(e.length===0)return o.jsx("div",{className:"empty",children:"Nessun dato disponibile."});const n=x.useRef(null),[r,s]=x.useState(null),[a,i]=x.useState({x:0,y:0}),l=520,c=200,u=20,d=e.map(S=>S.value),m=Math.min(...d,0),w=Math.max(...d,1)-m||1,y=(l-u*2)/(e.length-1||1),_=e.map((S,T)=>{const k=u+T*y,P=c-u-(S.value-m)/w*(c-u*2);return{x:k,y:P}}),b=_.map((S,T)=>`${T===0?"M":"L"} ${S.x} ${S.y}`).join(" "),f=`${b} L ${l-u} ${c-u} L ${u} ${c-u} Z`,h=S=>{const T=S.currentTarget.getBoundingClientRect(),P=(S.clientX-T.left)/T.width*l,O=Math.round((P-u)/y),M=Math.min(Math.max(O,0),e.length-1),z=_[M];s(M),i({x:z.x/l*T.width,y:z.y/c*T.height})},g=()=>{s(null)};return o.jsxs("div",{className:"chart-interactive",ref:n,children:[o.jsxs("svg",{viewBox:`0 0 ${l} ${c}`,width:"100%",height:"200",onMouseMove:h,onMouseLeave:g,children:[o.jsx("defs",{children:o.jsxs("linearGradient",{id:"areaFill",x1:"0",y1:"0",x2:"0",y2:"1",children:[o.jsx("stop",{offset:"0%",stopColor:t,stopOpacity:"0.4"}),o.jsx("stop",{offset:"100%",stopColor:t,stopOpacity:"0.05"})]})}),o.jsx("path",{d:f,fill:"url(#areaFill)"}),o.jsx("path",{d:b,fill:"none",stroke:t,strokeWidth:"3"}),r!==null&&o.jsx("circle",{cx:_[r].x,cy:_[r].y,r:"5",fill:t})]}),r!==null&&o.jsxs("div",{className:"chart-tooltip",style:{left:a.x,top:a.y},children:[o.jsx("strong",{children:e[r].label}),o.jsx("span",{children:e[r].value.toFixed(2)})]})]})},Ba=["#1f6f5c","#c8782b","#2f5b8a","#d4a373","#8c5a3c","#4f7c93","#bf6a5a"],ph={ETF:"#ef4444",Liquidita:"#22c55e",Azioni:"#60a5fa",Obbligazioni:"#f59e0b",Crypto:"#14b8a6",Oro:"#facc15","Real Estate":"#a78bfa","Private Equity":"#f97316","Asset Investimento":"#38bdf8",Cash:"#22c55e",Altro:"#94a3b8"},Ls=({data:e,onSelect:t,valueFormatter:n,colors:r})=>{const s=e.reduce((b,f)=>b+f.value,0),a=58,i=16,l=2*Math.PI*a;let c=0;const u=!!(t&&s>0),d=x.useRef(null),[m,p]=x.useState(null),w=s>0?e:[{label:"Nessun dato",value:1}],y=b=>n?n(b):b.toFixed(2),_=(b,f)=>{var g;const h=(g=d.current)==null?void 0:g.getBoundingClientRect();h&&p({label:f.label,value:y(f.value),x:b.clientX-h.left,y:b.clientY-h.top})};return o.jsxs("div",{className:"chart-interactive",ref:d,children:[o.jsx("svg",{viewBox:"0 0 160 160",width:"100%",height:"180",onMouseLeave:()=>p(null),children:o.jsxs("g",{transform:"translate(80 80)",children:[w.map((b,f)=>{const g=(s>0?b.value:1)/(s>0?s:1)*l,S=(r==null?void 0:r[b.label])??ph[b.label]??Ba[f%Ba.length],T=o.jsx("circle",{r:a,cx:0,cy:0,fill:"transparent",stroke:S,strokeWidth:i,strokeDasharray:`${g} ${l-g}`,strokeDashoffset:-c,strokeLinecap:"round",onClick:u?()=>t&&t(b.label):void 0,onMouseMove:k=>_(k,b),style:u?{cursor:"pointer"}:void 0},b.label);return c+=g,T}),o.jsx("circle",{r:a-i,fill:"var(--bg)"}),o.jsx("text",{textAnchor:"middle",y:5,fontSize:"14",fill:"var(--muted)",fontFamily:"IBM Plex Mono, monospace",children:s>0?"Totale":"--"})]})}),m&&o.jsxs("div",{className:"chart-tooltip",style:{left:m.x,top:m.y},children:[o.jsx("strong",{children:m.label}),o.jsx("span",{children:m.value})]}),o.jsx("div",{className:"grid-2",style:{gap:"10px"},children:w.map((b,f)=>{const h=s>0?b.value/s:0,g=s>0?Nm(h):"N/D";return o.jsxs("span",{className:"tag",onClick:u?()=>t&&t(b.label):void 0,style:u?{cursor:"pointer"}:void 0,children:[o.jsx("span",{className:"tag-dot",style:{background:(r==null?void 0:r[b.label])??ph[b.label]??Ba[f%Ba.length]}}),o.jsx("span",{children:b.label}),o.jsx("span",{className:"tag-value",children:g})]},b.label)})})]})},Vx={bank:"Banca",debit:"Carta debito",credit:"Carta credito",cash:"Cash",paypal:"PayPal",other:"Altro"},Wx=()=>{const{accounts:e,categories:t,transactions:n,holdings:r,settings:s,loading:a,error:i}=fn(),[l,c]=x.useState(null),u=(s==null?void 0:s.base_currency)??"EUR",d=_m(n),m=xm(n,t),p=ym(r),w=wm(r),y=du(r),_=la(r)-y,b=bm(n,6),f=Bx(r,12),h=Zi(e,n),g=la(r)+h.filter(R=>R.type!=="credit").reduce((R,N)=>R+N.balance,0),S=km(h,(s==null?void 0:s.emergency_fund)??0),T=m>0?S/m:0,k=m>0?`${oc(T)} mesi`:S>0?"Illimitato":"N/D",P=h.reduce((R,N)=>R+N.balance,0),O=hu(r),M=P>0?[...O,{label:"Cash",value:P}]:O,z=l?r.filter(R=>R.asset_class===l).map(R=>({label:`${R.emoji?`${R.emoji} `:""}${R.name}`,value:R.current_value})):[],J=l==="Cash"?h.map(R=>({label:`${R.emoji?`${R.emoji} `:""}${R.name}`,value:R.balance})):[],be=Sm(n,t),se=be.slice(0,4),we=be.reduce((R,N)=>R+N.value,0),K=n.filter(R=>R.type==="expense").length,oe=new Date,ge=`${oe.getFullYear()}-${String(oe.getMonth()+1).padStart(2,"0")}`,B=n.filter(R=>R.date.startsWith(ge)),ee=B.filter(R=>R.type==="income").reduce((R,N)=>R+N.amount,0),G=B.filter(R=>R.type==="expense").reduce((R,N)=>R+N.amount,0),de=ee-G,ie=oe.getDate()>0?G/oe.getDate():0,E=be[0];return a?o.jsx("div",{className:"card",children:"Caricamento dashboard..."}):i?o.jsx("div",{className:"error",children:i}):o.jsxs("div",{className:"page",children:[o.jsx("div",{className:"section-header",children:o.jsxs("div",{children:[o.jsx("h2",{className:"section-title",children:"Dashboard Strategica"}),o.jsx("p",{className:"section-subtitle",children:"Vista completa del portafoglio e del cash flow in tempo reale."})]})}),o.jsxs("div",{className:"stat-grid",children:[o.jsxs("div",{className:"stat-card",children:[o.jsx("span",{className:"stat-label",children:"Net Worth"}),o.jsx("span",{className:"stat-value",children:te(g,u)}),o.jsx("span",{className:"stat-trend",children:"Valore patrimoniale totale"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("span",{className:"stat-label",children:"Savings Rate"}),o.jsx("span",{className:"stat-value",children:mt(d)}),o.jsx("span",{className:"stat-trend",children:"(Entrate - Uscite) / Entrate"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("span",{className:"stat-label",children:"Burn Rate Mensile"}),o.jsx("span",{className:"stat-value",children:te(m,u)}),o.jsx("span",{className:"stat-trend",children:"Spese fisse ultime 4 settimane"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("span",{className:"stat-label",children:"Runway"}),o.jsx("span",{className:"stat-value",children:k}),o.jsx("span",{className:"stat-trend",children:"Copertura fondo emergenza"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("span",{className:"stat-label",children:"ROI"}),o.jsx("span",{className:"stat-value",children:mt(p)}),o.jsx("span",{className:"stat-trend",children:"Rendimento totale holdings"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("span",{className:"stat-label",children:"Capital Gain"}),o.jsx("span",{className:`stat-value ${_>=0?"positive":"negative"}`,children:te(_,u)}),o.jsx("span",{className:"stat-trend",children:"Differenza tra valore e capitale"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("span",{className:"stat-label",children:"CAGR"}),o.jsx("span",{className:"stat-value",children:mt(w)}),o.jsx("span",{className:"stat-trend",children:"Crescita annua composta"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("span",{className:"stat-label",children:"Capitale Investito"}),o.jsx("span",{className:"stat-value",children:te(y,u)}),o.jsx("span",{className:"stat-trend",children:"Totale capitale allocato"})]})]}),o.jsxs("div",{className:"card",children:[o.jsx("div",{className:"section-header",children:o.jsxs("div",{children:[o.jsx("h3",{children:"Conti attivi"}),o.jsx("p",{className:"section-subtitle",children:"Saldo aggiornato per ogni conto"})]})}),h.length===0?o.jsx("div",{className:"empty",children:"Nessun conto creato."}):o.jsx("div",{className:"account-grid",children:h.map(R=>o.jsxs("div",{className:"account-card",children:[o.jsxs("div",{className:"account-meta",children:[o.jsx("span",{className:"account-emoji",children:R.emoji&&R.emoji.trim()?R.emoji:"O"}),o.jsxs("div",{className:"account-info",children:[o.jsx("strong",{children:R.name}),o.jsx("span",{className:"section-subtitle",children:Vx[R.type]??R.type})]})]}),o.jsx("div",{className:"account-balance",children:te(R.balance,R.currency)})]},R.id))})]}),o.jsxs("div",{className:"grid-2",children:[o.jsxs("div",{className:"chart-card",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Cash Flow (6 mesi)"}),o.jsx("p",{className:"section-subtitle",children:"Entrate vs uscite"}),o.jsxs("div",{style:{display:"flex",gap:"8px"},children:[o.jsxs("span",{className:"tag",children:[o.jsx("span",{className:"tag-dot",style:{background:"#1f6f5c"}}),"Entrate"]}),o.jsxs("span",{className:"tag",children:[o.jsx("span",{className:"tag-dot",style:{background:"#c8782b"}}),"Uscite"]})]})]}),o.jsx(Cm,{data:b})]}),o.jsxs("div",{className:"chart-card",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Valore Portafoglio (12 mesi)"}),o.jsx("p",{className:"section-subtitle",children:"Trend stimato basato su holdings"})]}),o.jsx(Tm,{data:f})]})]}),o.jsxs("div",{className:"grid-2",children:[o.jsxs("div",{className:"chart-card",children:[o.jsxs("div",{children:[o.jsx("strong",{children:l?`Asset Allocation - ${l}`:"Asset Allocation"}),o.jsx("p",{className:"section-subtitle",children:l?"Dettaglio percentuale per singolo asset":"Distribuzione percentuale attuale"}),l&&o.jsx("button",{className:"button ghost small",type:"button",onClick:()=>c(null),children:"Torna indietro"})]}),o.jsx(Ls,{data:l==="Cash"?J:l?z:M,onSelect:l?void 0:R=>c(R),valueFormatter:R=>te(R,u)})]}),o.jsxs("div",{className:"chart-card",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Top Spese"}),o.jsx("p",{className:"section-subtitle",children:"Categorie piu rilevanti"})]}),be.length>0?o.jsxs("div",{className:"expense-panel",children:[o.jsxs("div",{className:"grid-3",children:[o.jsxs("div",{className:"stat-card",children:[o.jsx("span",{className:"stat-label",children:"Totale spese"}),o.jsx("span",{className:"stat-value",children:te(we,u)}),o.jsx("span",{className:"stat-trend",children:"Periodo complessivo"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("span",{className:"stat-label",children:"Numero spese"}),o.jsx("span",{className:"stat-value",children:K}),o.jsx("span",{className:"stat-trend",children:"Transazioni registrate"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("span",{className:"stat-label",children:"Top categoria"}),o.jsx("span",{className:"stat-value",children:E?E.label:"N/D"}),o.jsx("span",{className:"stat-trend",children:E?te(E.value,u):"N/D"})]})]}),o.jsx("div",{className:"expense-bars",children:se.map(R=>{const N=we?R.value/we*100:0;return o.jsxs("div",{className:"expense-bar",children:[o.jsxs("div",{children:[o.jsx("strong",{children:R.label}),o.jsx("span",{className:"section-subtitle",children:te(R.value,u)})]}),o.jsx("div",{className:"expense-track",children:o.jsx("div",{className:"expense-fill",style:{width:`${N}%`}})})]},R.label)})})]}):o.jsx("div",{className:"empty",children:"Nessuna spesa registrata."})]})]}),o.jsxs("div",{className:"grid-3",children:[o.jsxs("div",{className:"card impact-card",children:[o.jsx("h3",{children:"Snapshot mese"}),o.jsxs("div",{className:"impact-values",children:[o.jsxs("div",{children:[o.jsx("span",{className:"stat-label",children:"Entrate"}),o.jsx("strong",{children:te(ee,u)})]}),o.jsxs("div",{children:[o.jsx("span",{className:"stat-label",children:"Uscite"}),o.jsx("strong",{children:te(G,u)})]}),o.jsxs("div",{children:[o.jsx("span",{className:"stat-label",children:"Netto"}),o.jsx("strong",{children:te(de,u)})]})]})]}),o.jsxs("div",{className:"card impact-card",children:[o.jsx("h3",{children:"Spesa media giornaliera"}),o.jsx("p",{className:"impact-value",children:te(ie,u)}),o.jsx("span",{className:"section-subtitle",children:"Calcolata sul mese corrente"})]}),o.jsxs("div",{className:"card impact-card",children:[o.jsx("h3",{children:"Categoria dominante"}),o.jsx("p",{className:"impact-value",children:E?E.label:"N/D"}),o.jsx("span",{className:"section-subtitle",children:E?te(E.value,u):"N/D"})]})]})]})},qx=async e=>{throw new Error("API key Alpha Vantage mancante.")},qo=e=>e?Number(e.trim().replace(",",".")):Number.NaN,mh=["Azioni","ETF","Obbligazioni","Crypto","Oro","Real Estate","Liquidita","Private Equity","Altro"],Kx=new Set(["ETF","Obbligazioni"]),gh={name:"",asset_class:"ETF",emoji:"",quantity:"",avg_cost:"",current_value:"",currency:"EUR",start_date:"",note:""},Hx=()=>{const{session:e}=hr(),{accounts:t,categories:n,transactions:r,holdings:s,settings:a,refresh:i,loading:l,error:c}=fn(),[u,d]=x.useState(gh),[m,p]=x.useState(null),[w,y]=x.useState(null),[_,b]=x.useState(null),[f,h]=x.useState(null),[g,S]=x.useState(null),[T,k]=x.useState(null),[P,O]=x.useState({}),[M,z]=x.useState("general"),[J,be]=x.useState({etf:80,bonds:20}),[se,we]=x.useState({cash:{mode:"rel",value:"",pct:""}}),K=x.useRef(null),oe=x.useRef(null),ge=x.useRef(!1),[B,ee]=x.useState(!1),[G,de]=x.useState(null),[ie,E]=x.useState(null),[R,N]=x.useState(null),[j,$]=x.useState("buy"),[D,ae]=x.useState({quantity:"",price:"",fees:""}),[ve,he]=x.useState(null),[ue,Ye]=x.useState(!1),[Te,Ot]=x.useState(!1),[bt,St]=x.useState(6),[xe,At]=x.useState([{key:"cash",label:"Cash",pct:20,kind:"reserve"},{key:"investments",label:"Asset Investimento",pct:70,kind:"asset"},{key:"emergency",label:"Fondo emergenza",pct:10,kind:"reserve"}]),[as,Bn]=x.useState(!1),[fr,ma]=x.useState(""),[It,pn]=x.useState({Cash:"#22c55e",ETF:"#ef4444",Obbligazioni:"#f59e0b","Fondo emergenza":"#60a5fa","Asset Investimento":"#38bdf8",Crypto:"#14b8a6"}),Fe=(a==null?void 0:a.base_currency)??"EUR",mn=u.asset_class==="Liquidita",Rm=x.useMemo(()=>{const v=se.cash;if(!v||v.mode!=="set"||!v.value.trim())return null;const C=qo(v.value);return Number.isFinite(C)&&C>=0?C:null},[se]);x.useEffect(()=>{if(!a)return;St(a.emergency_fund_months??6),Te||At(Q=>{const q=[...Q],L=le=>{const ye=q.findIndex(Z=>Z.key===le.key);ye===-1?q.push(le):q[ye]={...q[ye],...le}};return L({key:"cash",label:"Cash",pct:a.target_cash_pct??20,kind:"reserve"}),L({key:"emergency",label:"Fondo emergenza",pct:a.target_emergency_pct??10,kind:"reserve"}),q.some(le=>le.key==="investments")||q.push({key:"investments",label:"Asset Investimento",pct:70,kind:"asset"}),q}),we(Q=>{var le;const q={...Q};return a.cash_target_cap!==null&&a.cash_target_cap!==void 0?q.cash={mode:"set",value:String(a.cash_target_cap),pct:((le=Q.cash)==null?void 0:le.pct)??""}:q.cash||(q.cash={mode:"rel",value:"",pct:""}),q});const v=Q=>Math.max(0,Math.min(100,Q)),C=a.target_etf_pct??80,I=a.target_bond_pct??20,A=v(C),X=v(I),V=A+X,F=V>0?A/V*100:80,W=100-F;be({etf:Number(F.toFixed(1)),bonds:Number(W.toFixed(1))})},[a]),x.useEffect(()=>{M==="general"&&(de(null),E(null))},[M]),x.useEffect(()=>{if(!e||Te)return;let v=!1;const C="portfolio_allocation_targets_v1",I=V=>{if(!V||typeof V!="string")return null;try{const F=JSON.parse(V);return Array.isArray(F.items)?{items:F.items,colors:F.colors,caps:F.caps,emergencyFundMonths:F.emergencyFundMonths}:null}catch{return null}},A=V=>{if(!V)return;const F={};return Object.entries(V).forEach(([W,Q])=>{const q=Q==null?void 0:Q.mode,L=typeof(Q==null?void 0:Q.value)=="string"?Q.value:"",le=qo(L),ye=L.trim()!==""&&Number.isFinite(le),Z=q==="set"||q==="off"||q==="rel"?q:Q!=null&&Q.enabled&&ye?"set":"rel";F[W]={mode:Z,value:L,pct:typeof(Q==null?void 0:Q.pct)=="string"?Q.pct:""}}),F},X=V=>{const F=V.reduce((Z,fe)=>fe.key==="ETF"||fe.key==="Obbligazioni"?Z+(Number.isFinite(fe.pct)?fe.pct:0):Z,0),W=V.find(Z=>Z.key==="investments"||Z.label==="Asset Investimento"),Q=W?{...W,key:"investments",label:"Asset Investimento",kind:"asset"}:{key:"investments",label:"Asset Investimento",pct:F>0?F:70,kind:"asset"},q=V.filter(Z=>Z.key!=="ETF"&&Z.key!=="Obbligazioni"&&Z.key!=="investments"&&Z.label!=="Asset Investimento").map(Z=>({...Z,kind:Z.key==="cash"||Z.key==="emergency"?"reserve":"asset"})),L=q.find(Z=>Z.key==="cash")??{key:"cash",label:"Cash",pct:20,kind:"reserve"},le=q.find(Z=>Z.key==="emergency")??{key:"emergency",label:"Fondo emergenza",pct:10,kind:"reserve"},ye=q.filter(Z=>Z.key!=="cash"&&Z.key!=="emergency");return[L,Q,le,...ye.filter(Z=>Z.key!==Q.key)]};return(async()=>{var Q;const V=await Fx();if(v)return;const F=I(localStorage.getItem(C)),W=A(F==null?void 0:F.caps);if(V.length>0){const q=X(V.map(L=>({key:L.key,label:L.label,pct:L.pct,kind:L.key==="cash"||L.key==="emergency"?"reserve":"asset"})));At(q),pn(L=>{const le={...L};if(V.forEach(ye=>{ye.color&&(le[ye.label]=ye.color)}),F!=null&&F.colors){const ye=new Set(V.map(Z=>Z.label));Object.entries(F.colors).forEach(([Z,fe])=>{!ye.has(Z)&&fe&&(le[Z]=fe)})}return le}),W&&we(W),typeof(F==null?void 0:F.emergencyFundMonths)=="number"&&St(F.emergencyFundMonths),Ot(!0);return}if((Q=F==null?void 0:F.items)!=null&&Q.length){At(X(F.items)),F.colors&&pn(q=>({...q,...F.colors})),W&&we(W),typeof F.emergencyFundMonths=="number"&&St(F.emergencyFundMonths),Ot(!0);return}W&&we(W),typeof(F==null?void 0:F.emergencyFundMonths)=="number"&&St(F.emergencyFundMonths),Ot(!0)})().catch(()=>{Ot(!0)}),()=>{v=!0}},[Te,e]),x.useEffect(()=>{we(v=>{const C={...v},I=new Set(xe.map(A=>A.key));return xe.forEach(A=>{if(!C[A.key]){C[A.key]={mode:"rel",value:"",pct:""};return}C[A.key].mode!=="rel"&&C[A.key].mode!=="set"&&C[A.key].mode!=="off"&&(C[A.key].mode="rel"),typeof C[A.key].value!="string"&&(C[A.key].value=""),typeof C[A.key].pct!="string"&&(C[A.key].pct="")}),Object.keys(C).forEach(A=>{I.has(A)||delete C[A]}),C})},[xe]),x.useEffect(()=>{O(v=>{const C=new Set(s.map(A=>A.id)),I={};return Object.entries(v).forEach(([A,X])=>{C.has(A)&&(I[A]=X)}),I})},[s]);const Pm=x.useMemo(()=>{const v=new Map;return xe.forEach(C=>v.set(C.key,C.pct)),v},[xe]),is=v=>{const C=v.trim();return C?(C.split(/[^A-Za-z0-9.]/)[0]??"").toUpperCase():""},eo=v=>`${v.emoji?`${v.emoji} `:""}${v.name}`,fu=v=>new Intl.NumberFormat("it-IT",{maximumFractionDigits:4}).format(Number.isFinite(v)?v:0),pu=()=>{d({...gh,currency:Fe}),p(null)},to=()=>{pu(),y(null),b(null)},pr=x.useMemo(()=>{if(mn){const I=Number(u.current_value);return Number.isFinite(I)?I:0}const v=Number(u.quantity),C=Number(u.avg_cost);return!Number.isFinite(v)||!Number.isFinite(C)?0:v*C},[u.quantity,u.avg_cost,u.current_value,mn]),Om=async v=>{v.preventDefault(),y(null),k(null);let C=null;const I=Number(u.current_value),A=mn?1:Number(u.quantity),X=mn?I:Number(u.avg_cost),V=is(u.name),F={name:u.name,asset_class:u.asset_class,emoji:u.emoji.trim()||null,target_pct:(m==null?void 0:m.target_pct)??null,quantity:Number.isFinite(A)?A:0,avg_cost:Number.isFinite(X)?X:0,total_cap:Number.isFinite(pr)?pr:0,current_value:Number.isFinite(I)?I:0,currency:u.currency,start_date:u.start_date,note:u.note||null};try{if(m)await ws(m.id,F);else{const W=!mn&&V?s.find(Q=>is(Q.name)===V&&Q.asset_class===u.asset_class):null;if(W){if(W.currency!==F.currency){y("Ticker gia presente con valuta diversa. Aggiorna la holding esistente.");return}const Q=W.quantity+(Number.isFinite(A)?A:0),q=W.total_cap+(Number.isFinite(pr)?pr:0),L=A>0&&Number.isFinite(I)&&I>0?I/A:W.quantity>0?W.current_value/W.quantity:0,le=L>0?L*Q:W.current_value+(Number.isFinite(I)?I:0),ye=Q>0?q/Q:0,Z=W.start_date&&u.start_date?W.start_date<u.start_date?W.start_date:u.start_date:W.start_date||u.start_date;await ws(W.id,{name:W.name,asset_class:W.asset_class,emoji:F.emoji??W.emoji,target_pct:W.target_pct??null,quantity:Q,avg_cost:ye,total_cap:q,current_value:le,currency:F.currency,start_date:Z,note:F.note||W.note}),C=`Holding unita a ${W.name}.`}else await Ox(F)}await i(),y(C??"Salvataggio completato."),pu()}catch(W){y(W.message)}},Am=v=>{p(v),d({name:v.name,asset_class:v.asset_class,emoji:v.emoji??"",quantity:String(v.quantity),avg_cost:String(v.avg_cost),current_value:String(v.current_value),currency:v.currency,start_date:v.start_date,note:v.note??""})},Im=async v=>{try{await Ix(v),await i()}catch(C){y(C.message)}},$m=async v=>{if(b(null),v.asset_class==="Liquidita"){b("Prezzo live non disponibile per liquidita.");return}const C=is(v.name);if(!C){b("Inserisci il ticker nel nome (es. MWRD - ETF).");return}h(v.id);try{const A=await qx(C)*(v.quantity||0);await ws(v.id,{current_value:A}),await i(),b(`Prezzo ${C} aggiornato.`)}catch(I){b(I.message)}finally{h(null)}},Lm=(v,C)=>{N(v),$(C),ae({quantity:"",price:"",fees:""}),he(null)},no=()=>{N(null),he(null)},Dm=async v=>{if(v.preventDefault(),!R)return;he(null);const C=Number(D.quantity),I=Number(D.price),A=D.fees?Number(D.fees):0;if(!Number.isFinite(C)||C<=0){he("Inserisci una quantita valida.");return}if(!Number.isFinite(I)||I<=0){he("Inserisci un prezzo valido.");return}if(!Number.isFinite(A)||A<0){he("Le commissioni devono essere positive.");return}if(j==="sell"&&C>R.quantity){he("Quantita superiore a quella disponibile.");return}const X=j==="buy"?1:-1,V=R.quantity+X*C,F=C*I+A,W=R.avg_cost*C,Q=j==="buy"?R.total_cap+F:Math.max(R.total_cap-W,0),q=V>0?Q/V:0,L=V>0?V*I:0;Ye(!0);try{await ws(R.id,{quantity:V,total_cap:Q,avg_cost:q,current_value:L}),await i(),no()}catch(le){he(le.message)}finally{Ye(!1)}},mu=(v,C)=>{var ye;if(!Number.isFinite(C)||(((ye=se[v])==null?void 0:ye.mode)??"rel")!=="rel")return;const A=$t>0?dt.remainingTotal/$t*100:0;if(A<=0)return;const X=xe.filter(Z=>{var fe;return(((fe=se[Z.key])==null?void 0:fe.mode)??"rel")==="rel"});if(X.length<=1)return;const V=X.reduce((Z,fe)=>Z+(Number.isFinite(fe.pct)?fe.pct:0),0);if(V<=0)return;const W=Math.max(0,Math.min(A,C))/A,q=X.filter(Z=>Z.key!==v).reduce((Z,fe)=>Z+(Number.isFinite(fe.pct)?fe.pct:0),0);let L=0,le=0;if(W<=0)L=0,le=q>0?V/q:0;else if(W>=1||q<=0)L=V,le=0;else{L=W*V;const Z=V-L;le=q>0?Z/q:0}At(Z=>Z.map(fe=>{var _a;if((((_a=se[fe.key])==null?void 0:_a.mode)??"rel")!=="rel")return fe;if(fe.key===v)return{...fe,pct:Number(L.toFixed(1))};const vn=Number.isFinite(fe.pct)?fe.pct:0,wa=le>0?vn*le:0;return{...fe,pct:Number(wa.toFixed(1))}}))},gu=(v,C)=>{if(!Number.isFinite(C))return;const I=Math.max(0,Math.min(100,C));be(A=>v==="etf"?{etf:I,bonds:Number((100-I).toFixed(1))}:{etf:Number((100-I).toFixed(1)),bonds:I})},Um=v=>{(v==="ETF"||v==="Obbligazioni")&&de(v)},Mm=v=>{(v==="ETF"||v==="Obbligazioni")&&E(v)};x.useEffect(()=>{if(!e||!Te)return;const v=JSON.stringify({allocationTargetItems:xe,investmentTargets:J,allocationCaps:se,allocationColors:It,emergencyFundMonths:bt});if(!ge.current){ge.current=!0,oe.current=v;return}if(v!==oe.current)return K.current&&clearTimeout(K.current),K.current=setTimeout(()=>{Fm(v,!0)},800),()=>{K.current&&clearTimeout(K.current)}},[xe,se,It,Te,J,bt,e]);const Fm=async(v,C=!1)=>{if(!e)return;C||S(null);const I="portfolio_allocation_targets_v1",A=X=>Pm.get(X)??0;try{await vm({user_id:e.user.id,base_currency:(a==null?void 0:a.base_currency)??"EUR",emergency_fund:Vn,cash_target_cap:Rm??null,target_cash_pct:A("cash"),target_etf_pct:J.etf,target_bond_pct:J.bonds,target_emergency_pct:A("emergency"),emergency_fund_months:bt,rebalance_months:(a==null?void 0:a.rebalance_months)??6});const X=xe.map((F,W)=>({user_id:e.user.id,key:F.key,label:F.label,pct:F.pct,color:It[F.label]??null,sort_order:W})),V=await zx(X);localStorage.setItem(I,JSON.stringify({items:xe,colors:It,caps:se,emergencyFundMonths:bt})),C||(await i(),S(V?"Asset allocation salvata.":"Asset allocation salvata in locale (tabella Supabase non trovata).")),oe.current=v??null}catch(X){S(X.message)}},zm=x.useMemo(()=>{const v=new Map;return s.forEach(C=>{const I=C.asset_class||"Altro",A=v.get(I)??{items:[],totalCap:0,totalValue:0};A.items.push(C),A.totalCap+=C.total_cap,A.totalValue+=C.current_value,v.set(I,A)}),Array.from(v.entries()).map(([C,I])=>({label:C,...I,roi:I.totalCap?(I.totalValue-I.totalCap)/I.totalCap:0}))},[s]),ro=x.useMemo(()=>Zi(t,r),[t,r]),os=x.useMemo(()=>xm(r,n),[r,n]),Vn=km(ro,(a==null?void 0:a.emergency_fund)??0),vu=ro.filter(v=>v.type==="credit").reduce((v,C)=>v+C.balance,0),Bm=ro.filter(v=>v.type!=="credit").reduce((v,C)=>v+C.balance,0),ga=Math.max(Bm-Vn,0),gn=x.useMemo(()=>{const v=new Map;return s.forEach(C=>{const I=C.asset_class||"Altro";v.set(I,(v.get(I)??0)+C.current_value)}),v},[s]),ls=gn.get("ETF")??0,cs=gn.get("Obbligazioni")??0,yu=gn.get("Crypto")??0,va=Array.from(gn.values()).reduce((v,C)=>v+C,0),ya=ga+Vn+va,$t=ya>0?ya:0,so=Math.max(va-yu,0),Vm=[{label:"Cash",value:ga},{label:"Fondo emergenza",value:Vn},{label:"Crypto",value:yu},{label:"Asset Investimento",value:so}].filter(v=>Number.isFinite(v.value)&&v.value>0),dt=x.useMemo(()=>{const v=new Map;xe.forEach(q=>{const L=q.key==="cash"?ga:q.key==="emergency"?Vn:q.key==="investments"?so:gn.get(q.key)??0;v.set(q.key,L)});const C=new Map;Object.entries(se).forEach(([q,L])=>{const le=L.mode??"rel",ye=qo(L.value??""),Z=Number.isFinite(ye)&&ye>=0?ye:0;C.set(q,{mode:le,value:Z})});const I=bt>0&&os>0?os*bt:null;I!==null&&C.set("emergency",{mode:"set",value:I});const A=xe.reduce((q,L)=>{var ye;return(((ye=C.get(L.key))==null?void 0:ye.mode)??"rel")!=="rel"?q:q+(Number.isFinite(L.pct)?L.pct:0)},0);let X=0,V=0;xe.forEach(q=>{const L=C.get(q.key);(L==null?void 0:L.mode)==="set"?X+=L.value:(L==null?void 0:L.mode)==="off"&&(V+=v.get(q.key)??0)});const F=Math.max($t-X-V,0),W=new Map;xe.forEach(q=>{const L=C.get(q.key),le=(L==null?void 0:L.mode)??"rel",ye=v.get(q.key)??0;if(le==="set"){W.set(q.key,(L==null?void 0:L.value)??0);return}if(le==="off"){W.set(q.key,ye);return}const Z=Number.isFinite(q.pct)?q.pct:0,vn=(A>0?Z/A*100:0)/100*F;W.set(q.key,vn)});const Q=new Map;return $t>0?W.forEach((q,L)=>{Q.set(L,q/$t*100)}):xe.forEach(q=>Q.set(q.key,0)),{currentByKey:v,targetByKey:W,effectivePctByKey:Q,relativePercentTotal:A,remainingTotal:F,setTotal:X,offTotal:V,emergencyAutoTarget:I}},[xe,se,$t,ga,Vn,so,gn,os,bt]);x.useEffect(()=>{Te&&At(v=>{const C=new Set(v.map(V=>V.key)),I=new Set(Array.from(gn.keys())),A=new Set(["cash","emergency","investments"]),X=[...v];return I.forEach(V=>{A.has(V)||V==="ETF"||V==="Obbligazioni"||C.has(V)||X.push({key:V,label:V,pct:0,kind:"asset"})}),X})},[Te,gn]);const Wm=[{label:"ETF",value:J.etf},{label:"Obbligazioni",value:J.bonds}],qm=[{label:"ETF",value:ls},{label:"Obbligazioni",value:cs}],us=ls+cs,Km=xe.map(v=>{const C=dt.currentByKey.get(v.key)??0,I=dt.targetByKey.get(v.key)??0;return{label:v.label,current:C,target:I,delta:I-C}}).filter(v=>v.current!==0||v.target!==0),Hm=[{label:"ETF",current:ls,target:J.etf/100*us,delta:J.etf/100*us-ls},{label:"Obbligazioni",current:cs,target:J.bonds/100*us,delta:J.bonds/100*us-cs}].filter(v=>v.current!==0||v.target!==0),wu=xe.reduce((v,C)=>{const I=dt.effectivePctByKey.get(C.key)??0;return v+(Number.isFinite(I)?I:0)},0),Gm=Number(wu.toFixed(1)),Jm=$t>0?Math.abs(wu-100)<=.1:!0,_u=dt.setTotal+dt.offTotal-$t,xu=x.useMemo(()=>xe.filter(v=>{var C;return(((C=se[v.key])==null?void 0:C.mode)??"rel")==="rel"}).length,[xe,se]),ao=$t>0?dt.remainingTotal/$t*100:0,ju=x.useMemo(()=>Object.values(se).filter(v=>v.mode!=="rel").length,[se]),Wn=x.useMemo(()=>{if(!R)return null;const v=Number(D.quantity),C=Number(D.price),I=D.fees?Number(D.fees):0;if(!Number.isFinite(v)||!Number.isFinite(C))return{quantity:0,price:0,fees:Number.isFinite(I)?I:0,tradeValue:0,newQuantity:R.quantity,newTotalCap:R.total_cap,newAvgCost:R.avg_cost,newCurrentValue:R.current_value};const A=Number.isFinite(I)?Math.max(I,0):0,X=v*C,V=j==="buy"?1:-1,F=Math.max(R.quantity+V*v,0),W=R.avg_cost*v,Q=j==="buy"?R.total_cap+X+A:Math.max(R.total_cap-W,0),q=F>0?Q/F:0,L=F>0?F*C:0;return{quantity:v,price:C,fees:A,tradeValue:X,newQuantity:F,newTotalCap:Q,newAvgCost:q,newCurrentValue:L}},[D.fees,D.price,D.quantity,R,j]),Qm=(v,C)=>{const I=ls+cs;if(v==="ETF")return I>0?J.etf/100*I:C;if(v==="Obbligazioni")return I>0?J.bonds/100*I:C;const A=dt.targetByKey.get(v);return A!==void 0?A:C},bu=v=>{const C=v.reduce((X,V)=>X+V.current_value,0),I=v.map(X=>{const V=P[X.id]??X.target_pct,F=typeof V=="number"&&Number.isFinite(V)?V:C>0?X.current_value/C*100:0;return{id:X.id,target:F}}),A=I.reduce((X,V)=>X+V.target,0);return{entries:I,total:A}},Ym=x.useMemo(()=>{if(!G)return[];const v=s.filter(A=>A.asset_class===G);if(v.length===0)return[];const C=bu(v),I=new Map(v.map(A=>[A.id,A]));return C.entries.map(A=>{const X=I.get(A.id);return{label:X?eo(X):A.id,value:A.target}})},[s,G,P]),Xm=x.useMemo(()=>{if(!ie)return[];const v=s.filter(I=>I.asset_class===ie),C=v.reduce((I,A)=>I+A.current_value,0);return v.map(I=>({label:eo(I),value:C>0?I.current_value/C*100:0}))},[s,ie]),Zm=async(v,C)=>{if(k(null),v.length!==0)try{await Promise.all(v.map(I=>ws(I.id,{target_pct:Number.isFinite(C.get(I.id))?Number(C.get(I.id)):0}))),await i(),O(I=>{const A={...I};return v.forEach(X=>delete A[X.id]),A}),k("Pesi interni salvati.")}catch(I){k(I.message)}},Su=(v,C,I)=>o.jsxs("form",{className:"form-grid",onSubmit:Om,children:[o.jsx("input",{className:"input",placeholder:"Nome asset",value:u.name,onChange:A=>d({...u,name:A.target.value}),required:!0}),o.jsx("input",{className:"input",placeholder:"Emoji (opzionale)",value:u.emoji,onChange:A=>d({...u,emoji:A.target.value})}),o.jsx("select",{className:"select",value:u.asset_class,onChange:A=>d({...u,asset_class:A.target.value}),children:mh.map(A=>o.jsx("option",{value:A,children:A},A))}),!mn&&o.jsx("input",{className:"input",type:"number",step:"0.01",placeholder:"Costo medio",value:u.avg_cost,onChange:A=>d({...u,avg_cost:A.target.value}),required:!0}),!mn&&o.jsx("input",{className:"input",type:"number",step:"0.01",placeholder:"Quantita",value:u.quantity,onChange:A=>d({...u,quantity:A.target.value}),required:!0}),o.jsx("input",{className:"input",type:"number",step:"0.01",placeholder:"Total Cap",value:Number.isFinite(pr)?pr.toFixed(2):"",readOnly:!0}),o.jsxs("select",{className:"select",value:u.currency,onChange:A=>d({...u,currency:A.target.value}),children:[o.jsx("option",{value:"EUR",children:"EUR"}),o.jsx("option",{value:"USD",children:"USD"})]}),o.jsx("input",{className:"input",type:"number",step:"0.01",placeholder:mn?"Importo liquidita":"Valore attuale",value:u.current_value,onChange:A=>d({...u,current_value:A.target.value}),required:!0}),o.jsx("input",{className:"input",type:"date",value:u.start_date,onChange:A=>d({...u,start_date:A.target.value}),required:!0}),o.jsx("input",{className:"input",placeholder:"Note",value:u.note,onChange:A=>d({...u,note:A.target.value})}),o.jsxs("div",{style:{display:"flex",gap:"10px"},children:[o.jsx("button",{className:"button",type:"submit",children:v}),C&&I&&o.jsx("button",{type:"button",className:"button secondary",onClick:I,children:"Annulla"})]})]});return l?o.jsx("div",{className:"card",children:"Caricamento portafoglio..."}):o.jsxs("div",{className:"page",children:[o.jsx("div",{className:"section-header",children:o.jsxs("div",{children:[o.jsx("h2",{className:"section-title",children:"Portafoglio"}),o.jsx("p",{className:"section-subtitle",children:"Holdings, performance e metriche chiave"})]})}),o.jsxs("div",{className:"card allocation-card",children:[o.jsxs("div",{className:"section-header",children:[o.jsxs("div",{children:[o.jsx("h3",{children:"Asset Allocation Target"}),o.jsx("p",{className:"section-subtitle",children:"Imposta le percentuali e ricevi indicazioni per ribilanciare."})]}),o.jsxs("div",{className:"allocation-actions",children:[o.jsxs("div",{className:"allocation-view-toggle",children:[o.jsx("button",{className:`view-toggle ${M==="general"?"active":""}`,type:"button",onClick:()=>z("general"),children:"Generale"}),o.jsx("button",{className:`view-toggle ${M==="investment"?"active":""}`,type:"button",onClick:()=>z("investment"),children:"Investimento"})]}),o.jsx("span",{className:"allocation-autosave",children:"Salvataggio automatico"})]})]}),o.jsxs("div",{className:`allocation-layout ${M==="investment"?"investment":""}`,children:[o.jsx("div",{className:"allocation-chart",children:M==="general"?o.jsxs(o.Fragment,{children:[o.jsx(Ls,{data:Vm,valueFormatter:v=>te(v,Fe),colors:It}),o.jsxs("div",{className:"allocation-summary",children:[o.jsxs("div",{children:[o.jsx("span",{className:"stat-label",children:"Totale attuale"}),o.jsx("strong",{children:te(ya,Fe)})]}),o.jsxs("div",{children:[o.jsx("span",{className:"stat-label",children:"Fondo emergenza"}),o.jsx("strong",{children:te(Vn,Fe)})]})]})]}):o.jsxs("div",{className:"allocation-investment-grid",children:[o.jsxs("div",{className:"allocation-subchart",children:[o.jsxs("div",{className:"allocation-subchart-header",children:[o.jsxs("div",{children:[o.jsx("strong",{children:G?`Target - ${G}`:"Target"}),o.jsx("p",{className:"section-subtitle",children:G?"Pesi interni target":"ETF + Obbligazioni"})]}),G&&o.jsx("button",{className:"button ghost small",type:"button",onClick:()=>de(null),children:"Indietro"})]}),o.jsx(Ls,{data:G?Ym:Wm,valueFormatter:v=>`${v.toFixed(1)}%`,colors:It,onSelect:G?void 0:Um})]}),o.jsxs("div",{className:"allocation-subchart",children:[o.jsxs("div",{className:"allocation-subchart-header",children:[o.jsxs("div",{children:[o.jsx("strong",{children:ie?`Attuale - ${ie}`:"Attuale"}),o.jsx("p",{className:"section-subtitle",children:ie?"Valori correnti per holding":"Valori correnti ETF + Obbligazioni"})]}),ie&&o.jsx("button",{className:"button ghost small",type:"button",onClick:()=>E(null),children:"Indietro"})]}),o.jsx(Ls,{data:ie?Xm:qm,valueFormatter:v=>ie?`${v.toFixed(1)}%`:te(v,Fe),colors:It,onSelect:ie?void 0:Mm})]})]})}),o.jsx("div",{className:"allocation-controls",children:M==="general"?o.jsxs(o.Fragment,{children:[o.jsxs("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[o.jsx("button",{className:"button ghost small",type:"button",onClick:()=>Bn(v=>!v),children:"+ Aggiungi asset"}),as&&o.jsxs("div",{style:{display:"flex",gap:"10px",width:"100%"},children:[o.jsxs("select",{className:"select",value:fr,onChange:v=>ma(v.target.value),children:[o.jsx("option",{value:"",children:"Scegli asset..."}),mh.filter(v=>v!=="ETF"&&v!=="Obbligazioni"&&!xe.some(C=>C.key===v)).map(v=>o.jsx("option",{value:v,children:v},`target-${v}`))]}),o.jsx("button",{className:"button secondary small",type:"button",disabled:!fr.trim(),onClick:()=>{const v=fr.trim();v&&(At(C=>[...C,{key:v,label:v,pct:0,kind:"asset"}]),pn(C=>({...C,[v]:C[v]??"#94a3b8"})),ma(""),Bn(!1))},children:"Aggiungi"})]})]}),[...xe.map(v=>({key:v.key,label:v.label,colorKey:v.label,kind:v.kind}))].map(v=>{var F;const I=(((F=se[v.key])==null?void 0:F.mode)??"rel")==="rel",A=I?ao:100,X=dt.effectivePctByKey.get(v.key)??0,V=I&&xu>1&&ao>0;return o.jsxs("div",{className:"allocation-row",children:[o.jsxs("div",{className:"allocation-label",children:[o.jsx("input",{className:"color-input",type:"color",value:It[v.colorKey]??"#94a3b8",onChange:W=>pn(Q=>({...Q,[v.colorKey]:W.target.value})),"aria-label":`Colore ${v.label}`}),o.jsx("strong",{children:v.label})]}),o.jsx("input",{className:"allocation-slider",type:"range",min:"0",max:A,step:"0.1",value:X,disabled:!V,onChange:W=>mu(v.key,Number(W.target.value))}),o.jsxs("div",{className:"allocation-input",children:[o.jsx("input",{type:"number",min:"0",max:A,step:"0.1",value:X.toFixed(1),disabled:!V,onChange:W=>mu(v.key,Number(W.target.value))}),o.jsx("span",{children:"%"})]}),v.kind==="asset"&&v.key!=="ETF"&&v.key!=="Obbligazioni"&&v.key!=="investments"&&o.jsx("button",{className:"button ghost small",type:"button",onClick:()=>At(W=>W.filter(Q=>Q.key!==v.key)),children:"Rimuovi"})]},`allocation-${v.key}`)}),o.jsxs("div",{className:"allocation-total",children:["Totale percentuali (effettive): ",Gm,"%"]}),xu<=1&&ao>0&&o.jsx("span",{className:"section-subtitle",children:"Con un solo asset in Rel, il target prende il restante."}),o.jsxs("div",{className:"allocation-cap",children:[o.jsxs("button",{className:"cap-trigger",type:"button",onClick:()=>ee(!0),children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Stato target per asset"}),o.jsx("span",{className:"section-subtitle",children:"Scegli tra relativo, set fisso o off."})]}),o.jsx("span",{className:"cap-badge",children:ju>0?`${ju} attivi`:"Nessuno"})]}),vu!==0&&o.jsxs("span",{className:"section-subtitle",children:["Nota: conti ",o.jsx("code",{children:"credit"})," esclusi dal calcolo Cash:"," ",te(vu,Fe),"."]})]}),!Jm&&o.jsx("div",{className:"notice",children:_u>0?`I valori Set/Off superano il totale di ${te(_u,Fe)}.`:"Consiglio: porta le percentuali effettive al 100% per un ribilanciamento corretto."})]}):o.jsxs(o.Fragment,{children:[["etf","bonds"].map(v=>{const C=v==="etf"?"ETF":"Obbligazioni",I=v==="etf"?J.etf:J.bonds;return o.jsxs("div",{className:"allocation-row",children:[o.jsxs("div",{className:"allocation-label",children:[o.jsx("input",{className:"color-input",type:"color",value:It[C]??"#94a3b8",onChange:A=>pn(X=>({...X,[C]:A.target.value})),"aria-label":`Colore ${C}`}),o.jsx("strong",{children:C})]}),o.jsx("input",{className:"allocation-slider",type:"range",min:"0",max:"100",step:"0.1",value:I,onChange:A=>gu(v,Number(A.target.value))}),o.jsxs("div",{className:"allocation-input",children:[o.jsx("input",{type:"number",min:"0",max:"100",step:"0.1",value:I.toFixed(1),onChange:A=>gu(v,Number(A.target.value))}),o.jsx("span",{children:"%"})]})]},`investment-${v}`)}),o.jsxs("div",{className:"allocation-total",children:["Totale investito: ",(J.etf+J.bonds).toFixed(1),"%"]}),o.jsx("span",{className:"section-subtitle",children:"Queste percentuali influenzano solo la vista investimento."})]})})]}),o.jsxs("div",{className:"allocation-rebalance",children:[o.jsx("h4",{children:"Azioni consigliate"}),ya===0?o.jsx("div",{className:"empty",children:"Inserisci dati per calcolare il ribilanciamento."}):o.jsx("div",{className:"allocation-grid",children:(M==="investment"?Hm:Km.filter(v=>!Kx.has(v.label))).map(v=>{const C=v.delta>0?"Compra":v.delta<0?"Vendi":"Mantieni",I=Math.abs(v.delta),A=v.delta>0?"buy":v.delta<0?"sell":"hold",X=Math.abs(v.delta),V=M==="investment"?us:$t,F=V>0?X/V*100:0,W=v.label==="Cash"||v.label==="Crypto";return o.jsxs("div",{className:`allocation-item ${A}`,children:[o.jsxs("div",{className:`allocation-item-header${W?" stacked":""}`,children:[o.jsx("strong",{children:v.label}),o.jsxs("div",{className:"allocation-item-meta",children:[o.jsxs("span",{children:["Target: ",te(v.target,Fe)]}),o.jsxs("span",{children:["Attuale: ",te(v.current,Fe)]})]})]}),o.jsxs("div",{className:`allocation-action ${A}`,children:[C," ",te(I,Fe),F>0&&o.jsxs("span",{className:"allocation-action-share",children:["(",F.toFixed(1),"%)"]})]})]},v.label)})})]}),g&&o.jsx("div",{className:"notice",children:g})]}),B&&o.jsx("div",{className:"modal-backdrop",onClick:()=>ee(!1),children:o.jsxs("div",{className:"modal-card",onClick:v=>v.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsxs("div",{children:[o.jsx("h3",{children:"Target avanzati per asset"}),o.jsx("p",{className:"section-subtitle",children:"Rel usa le percentuali, Set blocca un valore fisso, Off congela l'asset al valore attuale."})]}),o.jsx("button",{className:"button ghost small",type:"button",onClick:()=>ee(!1),children:"Chiudi"})]}),o.jsxs("div",{className:"cap-emergency-config",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Fondo emergenza"}),o.jsx("span",{className:"section-subtitle",children:"Target automatico = burn rate x mesi selezionati."})]}),o.jsxs("select",{className:"select cap-months",value:bt,onChange:v=>St(Number(v.target.value)),children:[o.jsx("option",{value:6,children:"6 mesi"}),o.jsx("option",{value:9,children:"9 mesi"}),o.jsx("option",{value:12,children:"12 mesi"})]}),o.jsx("div",{className:"cap-emergency-meta",children:os>0&&dt.emergencyAutoTarget!==null?o.jsxs("span",{className:"section-subtitle",children:["Burn rate: ",te(os,Fe),"  Target:"," ",te(dt.emergencyAutoTarget,Fe)]}):o.jsx("span",{className:"section-subtitle",children:"Burn rate assente: inserisci un valore Set manuale."})})]}),o.jsx("div",{className:"cap-grid",children:xe.map(v=>{const C=se[v.key]??{mode:"rel",value:""},I=v.key==="emergency"&&dt.emergencyAutoTarget!==null,A=I?"set":C.mode,X=I?dt.emergencyAutoTarget??"":C.value;return o.jsxs("div",{className:"cap-row",children:[o.jsx("div",{className:"cap-label",children:o.jsx("span",{children:v.label})}),o.jsxs("select",{className:"select cap-mode",value:A,onChange:V=>{const F=V.target.value;we(W=>{var Q,q;return{...W,[v.key]:{mode:F,value:((Q=W[v.key])==null?void 0:Q.value)??"",pct:((q=W[v.key])==null?void 0:q.pct)??""}}})},disabled:I,children:[o.jsx("option",{value:"rel",children:"Rel %"}),o.jsx("option",{value:"set",children:"Set"}),o.jsx("option",{value:"off",children:"Off"})]}),o.jsxs("div",{className:"cap-input",children:[o.jsx("input",{type:"number",step:"0.01",placeholder:"Valore fisso",value:X,onChange:V=>we(F=>{var W,Q;return{...F,[v.key]:{mode:((W=F[v.key])==null?void 0:W.mode)??"rel",value:V.target.value,pct:((Q=F[v.key])==null?void 0:Q.pct)??""}}}),disabled:A!=="set"||I}),o.jsx("span",{children:Fe})]})]},`cap-${v.key}`)})})]})}),R&&o.jsx("div",{className:"modal-backdrop",onClick:no,children:o.jsxs("div",{className:"modal-card trade-modal",onClick:v=>v.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsxs("div",{children:[o.jsxs("h3",{children:[j==="buy"?"Acquisto":"Vendita"," -"," ",eo(R)]}),o.jsx("p",{className:"section-subtitle",children:"Aggiorna quantita e costo medio senza uscire dalla pagina."})]}),o.jsx("button",{className:"button ghost small",type:"button",onClick:no,children:"Chiudi"})]}),o.jsxs("div",{className:"trade-tabs",children:[o.jsx("button",{type:"button",className:`trade-tab ${j==="buy"?"active buy":""}`,onClick:()=>$("buy"),children:"Buy"}),o.jsx("button",{type:"button",className:`trade-tab ${j==="sell"?"active sell":""}`,onClick:()=>$("sell"),children:"Sell"})]}),o.jsxs("div",{className:"trade-body",children:[o.jsxs("div",{className:`trade-panel ${j}`,children:[o.jsxs("div",{className:"trade-summary",children:[o.jsxs("div",{children:[o.jsx("span",{className:"stat-label",children:"Quantita attuale"}),o.jsx("strong",{children:fu(R.quantity)})]}),o.jsxs("div",{children:[o.jsx("span",{className:"stat-label",children:"Valore attuale"}),o.jsx("strong",{children:te(R.current_value,R.currency)})]}),o.jsxs("div",{children:[o.jsx("span",{className:"stat-label",children:"Prezzo medio"}),o.jsx("strong",{children:te(R.avg_cost,R.currency)})]})]}),o.jsxs("form",{className:"trade-form",onSubmit:Dm,children:[o.jsxs("div",{className:"trade-field",children:[o.jsx("label",{children:"Quantita"}),o.jsx("input",{type:"number",min:"0",step:"0.0001",value:D.quantity,onChange:v=>ae(C=>({...C,quantity:v.target.value})),required:!0})]}),o.jsxs("div",{className:"trade-field",children:[o.jsx("label",{children:"Prezzo"}),o.jsx("input",{type:"number",min:"0",step:"0.0001",value:D.price,onChange:v=>ae(C=>({...C,price:v.target.value})),required:!0})]}),o.jsxs("div",{className:"trade-field",children:[o.jsx("label",{children:"Commissioni"}),o.jsx("input",{type:"number",min:"0",step:"0.01",value:D.fees,onChange:v=>ae(C=>({...C,fees:v.target.value}))})]}),Wn&&o.jsxs("div",{className:"trade-preview",children:[o.jsxs("div",{children:[o.jsx("span",{className:"stat-label",children:"Totale operazione"}),o.jsx("strong",{children:te(Wn.tradeValue+(j==="buy"?Wn.fees:-Wn.fees),R.currency)})]}),o.jsxs("div",{children:[o.jsx("span",{className:"stat-label",children:"Nuova quantita"}),o.jsx("strong",{children:fu(Wn.newQuantity)})]}),o.jsxs("div",{children:[o.jsx("span",{className:"stat-label",children:"Nuovo costo medio"}),o.jsx("strong",{children:te(Wn.newAvgCost,R.currency)})]}),o.jsxs("div",{children:[o.jsx("span",{className:"stat-label",children:"Nuovo valore"}),o.jsx("strong",{children:te(Wn.newCurrentValue,R.currency)})]})]}),o.jsx("button",{className:`button ${j==="buy"?"buy":"sell"}`,type:"submit",disabled:ue,children:ue?"Salvataggio...":j==="buy"?"Conferma acquisto":"Conferma vendita"})]})]}),ve&&o.jsx("div",{className:"notice",children:ve})]})]})}),m&&o.jsx("div",{className:"modal-backdrop",onClick:to,children:o.jsxs("div",{className:"modal-card",onClick:v=>v.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsxs("div",{children:[o.jsx("h3",{children:"Modifica holding"}),o.jsx("p",{className:"section-subtitle",children:"Aggiorna i dati senza scorrere la pagina."})]}),o.jsx("button",{className:"button ghost small",type:"button",onClick:to,children:"Chiudi"})]}),Su("Aggiorna",!0,to),w&&o.jsx("div",{className:"notice",children:w}),_&&o.jsx("div",{className:"notice",children:_}),c&&o.jsx("div",{className:"error",children:c})]})}),!m&&o.jsxs("div",{className:"card",children:[o.jsx("h3",{children:"Nuova holding"}),Su("Aggiungi",!1),w&&o.jsx("div",{className:"notice",children:w}),_&&o.jsx("div",{className:"notice",children:_}),c&&o.jsx("div",{className:"error",children:c})]}),o.jsxs("div",{className:"card",children:[o.jsx("h3",{children:"Holdings attive"}),s.length===0?o.jsx("div",{className:"empty",children:"Nessuna holding presente."}):o.jsx("div",{className:"asset-groups",children:zm.map(v=>{const C=v.totalCap>0?v.totalValue/v.totalCap:0,I=v.totalCap>0?v.totalValue/v.totalCap-1:Number.NaN,X=Math.min(C,2)/2*100,V=bu(v.items),F=new Map(V.entries.map(L=>[L.id,L.target])),W=Qm(v.label,v.totalValue),Q=v.label!=="Liquidita",q=v.items.some(L=>P[L.id]!==void 0);return o.jsxs("div",{className:"asset-group card",children:[o.jsxs("div",{className:"asset-group-header",children:[o.jsxs("div",{children:[o.jsx("h4",{children:v.label}),o.jsxs("span",{className:"section-subtitle",children:[v.items.length," holdings attive"]})]}),o.jsxs("div",{className:"asset-group-metrics",children:[o.jsxs("div",{className:"asset-metric",children:[o.jsx("span",{children:"Investito"}),o.jsx("strong",{children:te(v.totalCap,Fe)})]}),o.jsxs("div",{className:"asset-metric",children:[o.jsx("span",{children:"Valore"}),o.jsx("strong",{children:te(v.totalValue,Fe)})]}),o.jsxs("div",{className:"asset-metric",children:[o.jsx("span",{children:"ROI"}),o.jsx("strong",{children:mt(v.roi)})]})]})]}),o.jsxs("div",{className:"asset-bar-meta",children:[o.jsx("span",{children:"Performance (barra 0-200%)"}),o.jsx("span",{children:mt(I)})]}),o.jsxs("div",{className:"asset-bar",children:[o.jsx("div",{className:"asset-bar-fill",style:{width:`${X}%`}}),o.jsx("span",{className:"asset-bar-label",children:mt(I)})]}),o.jsx("div",{className:"asset-items",children:v.items.map(L=>{const le=L.total_cap?(L.current_value-L.total_cap)/L.total_cap:Number.NaN,ye=v.totalValue?L.current_value/v.totalValue:0,Z=va?L.current_value/va:0,fe=L.asset_class==="Liquidita"?"Liquidita disponibile":`${L.quantity} x ${Et(L.avg_cost,L.currency)}`,vn=is(L.name);return o.jsxs("div",{className:"asset-item",children:[o.jsxs("div",{className:"asset-item-text",children:[o.jsxs("strong",{children:[L.emoji?`${L.emoji} `:"",L.name]}),o.jsx("span",{className:"section-subtitle",children:fe}),vn&&o.jsxs("span",{className:"asset-subinfo",children:["Ticker: ",vn]})]}),o.jsxs("div",{className:"asset-item-metrics",children:[o.jsxs("div",{className:"asset-item-metric",children:[o.jsx("span",{className:"asset-item-label",children:"Investito"}),o.jsx("strong",{className:"asset-item-value",children:te(L.total_cap,L.currency)})]}),o.jsxs("div",{className:"asset-item-metric",children:[o.jsx("span",{className:"asset-item-label",children:"Valore"}),o.jsx("strong",{className:"asset-item-value",children:te(L.current_value,L.currency)})]}),o.jsxs("div",{className:"asset-item-metric",children:[o.jsx("span",{className:"asset-item-label",children:"Peso totale"}),o.jsx("strong",{className:"asset-item-value",children:mt(Z)})]}),o.jsxs("div",{className:"asset-item-metric",children:[o.jsx("span",{className:"asset-item-label",children:"Peso classe"}),o.jsx("strong",{className:"asset-item-value",children:mt(ye)})]}),o.jsxs("div",{className:"asset-item-metric",children:[o.jsx("span",{className:"asset-item-label",children:"ROI"}),o.jsx("strong",{className:"asset-item-value",children:mt(le)})]})]}),o.jsxs("div",{className:"asset-item-actions",children:[o.jsx("button",{className:"button ghost small",type:"button",onClick:()=>$m(L),disabled:f===L.id,children:f===L.id?"Live...":"Live"}),L.asset_class!=="Liquidita"&&o.jsx("button",{className:"button ghost small",type:"button",onClick:()=>Lm(L,"buy"),children:"Buy/Sell"}),o.jsx("button",{className:"button ghost small",type:"button",onClick:()=>Am(L),children:"Modifica"}),o.jsx("button",{className:"button ghost small",type:"button",onClick:()=>Im(L.id),children:"Elimina"})]})]},L.id)})}),Q&&o.jsxs("div",{className:"holding-targets",children:[o.jsxs("div",{className:"holding-target-header",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Pesi interni e azioni consigliate"}),o.jsx("span",{className:"section-subtitle",children:v.label==="ETF"||v.label==="Obbligazioni"?`Target classe: ${te(W,Fe)}`:"Target calcolato sul valore attuale della classe"})]}),o.jsxs("div",{className:"holding-target-actions",children:[o.jsx("span",{className:"stat-label",children:"Totale target"}),o.jsxs("strong",{children:[V.total.toFixed(1),"%"]}),q&&o.jsx("button",{className:"button secondary small",type:"button",onClick:()=>Zm(v.items,F),children:"Salva pesi"})]})]}),Math.abs(V.total-100)>.1&&o.jsx("div",{className:"notice",children:"Porta il totale al 100% per un bilanciamento interno corretto."}),o.jsx("div",{className:"holding-target-grid",children:v.items.map(L=>{const le=F.get(L.id)??0,ye=v.totalValue?L.current_value/v.totalValue:0,Z=W*le/100,fe=Z-L.current_value,vn=fe>0?"Compra":fe<0?"Vendi":"Mantieni",wa=fe>0?"buy":fe<0?"sell":"hold",_a=is(L.name)||L.name;return o.jsxs("div",{className:`holding-target-card ${wa}`,children:[o.jsxs("div",{className:"holding-target-meta",children:[o.jsxs("strong",{children:[L.emoji?`${L.emoji} `:"",_a]}),o.jsxs("span",{className:"section-subtitle",children:[mt(ye)," attuale"]})]}),o.jsxs("div",{className:"holding-target-slider",children:[o.jsx("input",{className:"allocation-slider",type:"range",min:"0",max:"100",step:"1",value:le,onChange:io=>O(oo=>({...oo,[L.id]:Number(io.target.value)}))}),o.jsxs("div",{className:"holding-target-input",children:[o.jsx("input",{type:"number",min:"0",max:"100",step:"0.1",value:le.toFixed(1),onChange:io=>O(oo=>({...oo,[L.id]:Number(io.target.value)}))}),o.jsx("span",{children:"%"})]})]}),o.jsxs("div",{className:"holding-target-values",children:[o.jsxs("span",{children:["Target: ",te(Z,Fe)]}),o.jsxs("span",{children:["Attuale: ",te(L.current_value,Fe)]})]}),o.jsxs("div",{className:`holding-action ${wa}`,children:[vn," ",te(Math.abs(fe),Fe)]})]},`target-${L.id}`)})})]})]},v.label)})}),T&&o.jsx("div",{className:"notice",children:T})]})]})},Gx=new Date().toISOString().slice(0,10),vh={"Reddito da Lavoro":"","Extra & Side Hustle":"","Regali & Aiuti":"",Regali:"","Rimborsi & Tecnici":"","Casa & Utenze":"",Alimentazione:"",Trasporti:"","Salute & Cura Personale":"","Svago & Lifestyle":"","Finanza & Obblighi":"","Famiglia & Altro":"","Versamenti (Input Capitale)":"","Rendita Generata (Flusso Positivo)":"","Disinvestimenti (Output Capitale)":""},yh={type:"expense",flow:"out",account_id:"",transfer_from_id:"",transfer_to_id:"",category_id:"",amount:"",currency:"EUR",date:Gx,note:""},Jx=()=>{const{accounts:e,categories:t,transactions:n,settings:r,refresh:s,loading:a,error:i}=fn(),[l,c]=x.useState(yh),[u,d]=x.useState(null),[m,p]=x.useState(null),[w,y]=x.useState(!1),[_,b]=x.useState(""),[f,h]=$0(),g=(r==null?void 0:r.base_currency)??"EUR",S=x.useMemo(()=>{const E=new Map,R=new Map(t.map(N=>[N.id,N]));return t.forEach(N=>{const j=N.parent_id?R.get(N.parent_id):null,$=vh[N.name]??(j?vh[j.name]:void 0)??"";E.set(N.id,$)}),E},[t]),T=x.useMemo(()=>new Map(t.map(E=>[E.id,E.name])),[t]),k=x.useMemo(()=>new Map(e.map(E=>[E.id,`${E.emoji?`${E.emoji} `:""}${E.name}`])),[e]),P=x.useMemo(()=>{const E=t.find(R=>R.name.toLowerCase().includes("giroconti"));return(E==null?void 0:E.id)??""},[t]),O=l.type==="transfer",M=x.useMemo(()=>l.type==="transfer"?[]:t.filter(E=>E.type===l.type),[t,l.type]),z=x.useMemo(()=>M.filter(R=>!R.parent_id).map(R=>({...R,children:M.filter(N=>N.parent_id===R.id)})),[M]),J=x.useMemo(()=>{const E=_.trim().toLowerCase();return E?z.map(R=>{const N=R.name.toLowerCase().includes(E),j=R.children.filter($=>$.name.toLowerCase().includes(E));return!N&&j.length===0?null:{...R,children:N?R.children:j}}).filter(R=>R!==null):z},[z,_]),be=x.useMemo(()=>[...n].sort((R,N)=>{const j=N.date.localeCompare(R.date);return j!==0?j:(N.created_at??"").localeCompare(R.created_at??"")}).slice(0,6),[n]),se=x.useMemo(()=>{const E=Date.now()-2592e6;return n.reduce((R,N)=>(new Date(N.date).getTime()<E||(N.type==="income"?R.income+=N.amount:N.type==="expense"?R.expense+=N.amount:N.type==="investment"&&(N.flow==="in"&&(R.investmentIn+=N.amount),N.flow==="out"&&(R.investmentOut+=N.amount))),R),{income:0,expense:0,investmentIn:0,investmentOut:0})},[n]),we=se.income-se.expense+se.investmentIn-se.investmentOut,K=()=>{c({...yh,currency:g}),d(null),f.get("edit")&&h({})};x.useEffect(()=>{e.length!==0&&c(E=>{var R;if(E.type==="transfer"){const N=E.transfer_from_id||e[0].id,j=E.transfer_to_id||((R=e[1])==null?void 0:R.id)||e[0].id,$=e.find(D=>D.id===N)??e[0];return{...E,transfer_from_id:N,transfer_to_id:j,currency:$.currency}}return E.account_id?E:{...E,account_id:e[0].id,currency:e[0].currency}})},[e,l.account_id,l.transfer_from_id,l.transfer_to_id,l.type]),x.useEffect(()=>{c(E=>({...E,category_id:""})),y(!1),b("")},[l.type]),x.useEffect(()=>{const E=l.type==="transfer"?l.transfer_from_id:l.account_id,R=e.find(N=>N.id===E);R&&c(N=>({...N,currency:R.currency}))},[e,l.account_id,l.transfer_from_id,l.type]);const oe=async E=>{if(E.preventDefault(),p(null),l.type==="transfer"){if(!l.transfer_from_id||!l.transfer_to_id){p("Seleziona il conto di origine e destinazione.");return}if(l.transfer_from_id===l.transfer_to_id){p("Seleziona due conti diversi.");return}if(!P){p("Categoria giroconti non trovata. Importa le categorie base.");return}}else{if(!l.account_id){p("Seleziona un conto.");return}if(!l.category_id){p("Seleziona una categoria.");return}}const R=Number(l.amount);try{if(l.type==="transfer"){const N=e.find(D=>D.id===l.transfer_from_id),j=e.find(D=>D.id===l.transfer_to_id),$=l.note?`Trasferimento: ${l.note}`:`Trasferimento da ${(N==null?void 0:N.name)??"conto"} a ${(j==null?void 0:j.name)??"conto"}`;await gm([{type:"transfer",flow:"out",account_id:l.transfer_from_id,category_id:P,amount:R,currency:l.currency,date:l.date,note:$},{type:"transfer",flow:"in",account_id:l.transfer_to_id,category_id:P,amount:R,currency:l.currency,date:l.date,note:$}])}else{const N={type:l.type,flow:l.type==="income"?"in":l.type==="expense"?"out":l.flow,account_id:l.account_id,category_id:l.category_id,amount:R,currency:l.currency,date:l.date,note:l.note||null};u?await Tx(u.id,N):await Cx(N)}await s(),p("Transazione salvata."),K()}catch(N){p(N.message)}},ge=l.category_id?t.find(E=>E.id===l.category_id):null,B=(ge==null?void 0:ge.name)??"Seleziona categoria",ee=ge?S.get(ge.id)??"":"",G=E=>{c(R=>({...R,category_id:E})),y(!1),b("")},de=async()=>{try{await mm(),await s(),p("Categorie base importate.")}catch(E){p(E.message)}},ie=E=>{d(E),c({type:E.type,flow:E.flow,account_id:E.account_id,transfer_from_id:E.type==="transfer"?E.account_id:"",transfer_to_id:"",category_id:E.category_id,amount:String(E.amount),currency:E.currency,date:E.date,note:E.note??""})};return x.useEffect(()=>{const E=f.get("edit");if(!E)return;const R=n.find(N=>N.id===E);R&&ie(R)},[f,n]),a?o.jsx("div",{className:"card",children:"Caricamento transazioni..."}):o.jsxs("div",{className:"page",children:[o.jsx("div",{className:"section-header",children:o.jsxs("div",{children:[o.jsx("h2",{className:"section-title",children:"Transazioni"}),o.jsx("p",{className:"section-subtitle",children:"Entrate, uscite e trasferimenti"})]})}),o.jsxs("div",{className:"stat-grid",children:[o.jsxs("div",{className:"stat-card",children:[o.jsx("span",{className:"stat-label",children:"Entrate 30g"}),o.jsx("span",{className:"stat-value",children:Et(se.income,g)}),o.jsx("span",{className:"stat-trend",children:"Ultimi 30 giorni"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("span",{className:"stat-label",children:"Uscite 30g"}),o.jsx("span",{className:"stat-value",children:Et(se.expense,g)}),o.jsx("span",{className:"stat-trend",children:"Spesa corrente"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("span",{className:"stat-label",children:"Investimenti netti"}),o.jsx("span",{className:"stat-value",children:Et(se.investmentIn-se.investmentOut,g)}),o.jsx("span",{className:"stat-trend",children:"Input vs output"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("span",{className:"stat-label",children:"Net Flow"}),o.jsx("span",{className:"stat-value",children:Et(we,g)}),o.jsx("span",{className:"stat-trend",children:"Saldo finale 30g"})]})]}),o.jsxs("div",{className:"card transaction-panel",children:[o.jsxs("div",{className:"section-header",children:[o.jsxs("div",{children:[o.jsx("h3",{children:u?"Modifica transazione":"Nuova transazione"}),o.jsx("p",{className:"section-subtitle",children:"Registrazione rapida e pulita"})]}),o.jsx("span",{className:"pill",children:"Workflow rapido"})]}),o.jsxs("form",{className:"form-grid transaction-form",onSubmit:oe,children:[o.jsxs("select",{className:"select",value:l.type,onChange:E=>c({...l,type:E.target.value}),children:[o.jsx("option",{value:"income",children:"Entrata"}),o.jsx("option",{value:"expense",children:"Uscita"}),o.jsx("option",{value:"transfer",children:"Trasferimento"}),o.jsx("option",{value:"investment",hidden:!0,children:"Investimento"})]}),O?o.jsxs(o.Fragment,{children:[o.jsxs("select",{className:"select",value:l.transfer_from_id,onChange:E=>c({...l,transfer_from_id:E.target.value}),children:[o.jsx("option",{value:"",children:"Da (conto)"}),e.map(E=>o.jsxs("option",{value:E.id,children:[E.emoji?`${E.emoji} `:"",E.name]},E.id))]}),o.jsxs("select",{className:"select",value:l.transfer_to_id,onChange:E=>c({...l,transfer_to_id:E.target.value}),children:[o.jsx("option",{value:"",children:"A (conto)"}),e.map(E=>o.jsxs("option",{value:E.id,children:[E.emoji?`${E.emoji} `:"",E.name]},E.id))]}),o.jsx("span",{className:"tag",children:"Trasferimento interno tra conti"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("select",{className:"select",value:l.account_id,onChange:E=>c({...l,account_id:E.target.value}),children:[o.jsx("option",{value:"",children:"Seleziona conto"}),e.map(E=>o.jsxs("option",{value:E.id,children:[E.emoji?`${E.emoji} `:"",E.name]},E.id))]}),l.type==="investment"?o.jsxs("select",{className:"select",value:l.flow,onChange:E=>c({...l,flow:E.target.value}),children:[o.jsx("option",{value:"out",children:"Output capitale"}),o.jsx("option",{value:"in",children:"Ritorno / rendita"})]}):o.jsx("span",{className:"tag",children:"Flusso automatico: entrata = IN, uscita = OUT"})]}),!O&&o.jsx("div",{className:"category-picker form-span",children:o.jsxs("button",{className:"picker-trigger",type:"button",onClick:()=>y(!0),"aria-expanded":w,children:[o.jsxs("span",{className:"picker-label",children:[o.jsx("span",{className:"picker-icon",children:ee}),B]}),o.jsx("span",{className:"picker-caret",children:"v"})]})}),O&&o.jsx("div",{className:"notice form-span",children:"Categoria impostata automaticamente su giroconti."}),!O&&M.length===0&&o.jsxs("div",{className:"notice form-span",children:["Nessuna categoria disponibile per questo tipo.",o.jsx("button",{className:"button ghost small",type:"button",onClick:de,children:"Importa categorie base"})]}),o.jsx("input",{className:"input",type:"number",step:"0.01",placeholder:"Importo",value:l.amount,onChange:E=>c({...l,amount:E.target.value}),required:!0}),o.jsxs("select",{className:"select",value:l.currency,onChange:E=>c({...l,currency:E.target.value}),disabled:O||!!l.account_id,children:[o.jsx("option",{value:"EUR",children:"EUR"}),o.jsx("option",{value:"USD",children:"USD"})]}),o.jsx("input",{className:"input",type:"date",value:l.date,onChange:E=>c({...l,date:E.target.value})}),o.jsx("input",{className:"input",placeholder:"Note",value:l.note,onChange:E=>c({...l,note:E.target.value})}),o.jsxs("div",{style:{display:"flex",gap:"10px"},children:[o.jsx("button",{className:"button",type:"submit",children:u?"Aggiorna":"Aggiungi"}),u&&o.jsx("button",{className:"button secondary",type:"button",onClick:K,children:"Annulla"})]})]}),w&&!O&&o.jsx("div",{className:"modal-backdrop",onClick:()=>y(!1),children:o.jsxs("div",{className:"modal-card picker-modal",onClick:E=>E.stopPropagation(),children:[o.jsxs("div",{className:"modal-header",children:[o.jsxs("div",{children:[o.jsx("h3",{children:"Scegli categoria"}),o.jsx("p",{className:"section-subtitle",children:"Seleziona la categoria corretta"})]}),o.jsx("button",{className:"button ghost small",type:"button",onClick:()=>y(!1),children:"Chiudi"})]}),o.jsxs("div",{className:"picker-panel picker-panel-modal",children:[o.jsxs("div",{className:"picker-search",children:[o.jsx("input",{className:"input",placeholder:"Cerca categoria",value:_,onChange:E=>b(E.target.value)}),o.jsx("button",{className:"button ghost small",type:"button",onClick:()=>b(""),children:"Reset"})]}),o.jsx("div",{className:"picker-groups",children:J.length===0?o.jsx("div",{className:"empty",children:"Nessuna categoria trovata."}):J.map(E=>o.jsxs("div",{className:"picker-group",children:[o.jsxs("button",{className:"picker-parent",type:"button",onClick:()=>G(E.id),children:[o.jsx("span",{className:"picker-icon",children:S.get(E.id)??""}),E.name]}),E.children.length>0&&o.jsx("div",{className:"picker-children",children:E.children.map(R=>o.jsxs("button",{className:"picker-child",type:"button",onClick:()=>G(R.id),children:[o.jsx("span",{className:"picker-icon",children:S.get(R.id)??""}),R.name]},R.id))})]},E.id))})]})]})}),m&&o.jsx("div",{className:"notice",children:m}),i&&o.jsx("div",{className:"error",children:i}),o.jsxs("div",{className:"transaction-list",children:[o.jsx("div",{className:"section-header",children:o.jsxs("div",{children:[o.jsx("h4",{children:"Ultime transazioni"}),o.jsx("p",{className:"section-subtitle",children:"Lista rapida senza filtri"})]})}),be.length===0?o.jsx("div",{className:"empty",children:"Nessuna transazione registrata."}):be.map(E=>{const R=T.get(E.category_id)??"Categoria",N=k.get(E.account_id)??"Conto",j=E.type==="expense"||E.type==="investment"&&E.flow==="out"||E.type==="transfer"&&E.flow==="out",$=j?-E.amount:E.amount,D=E.type==="income"?"Entrata":E.type==="expense"?"Uscita":E.type==="investment"?E.flow==="in"?"Ritorno":"Output capitale":"Trasferimento";return o.jsxs("div",{className:"transaction-row",children:[o.jsxs("div",{className:"transaction-meta",children:[o.jsx("span",{className:"transaction-date",children:Em(E.date)}),o.jsx("strong",{className:"transaction-category",children:R}),o.jsx("span",{className:"transaction-note",children:E.note??"Nessuna nota"})]}),o.jsxs("div",{className:"transaction-tags",children:[o.jsx("span",{className:`chip ${E.type}`,children:D}),o.jsx("span",{className:"chip",children:N}),o.jsx("span",{className:`transaction-amount ${j?"negative":"positive"}`,children:Et($,E.currency)})]})]},E.id)})]})]}),e.length===0&&o.jsx("div",{className:"notice",children:"Nessun conto disponibile. Crea un conto in Impostazioni prima di inserire transazioni."})]})},Qx=["Lun","Mar","Mer","Gio","Ven","Sab","Dom"],Ko=e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`,Yx=e=>{const t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),n=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-n);const r=new Date(Date.UTC(t.getUTCFullYear(),0,1)),s=Math.ceil(((t.getTime()-r.getTime())/864e5+1)/7);return{year:t.getUTCFullYear(),week:s}},wh=e=>{const{year:t,week:n}=Yx(e);return`${t}-W${String(n).padStart(2,"0")}`},Xx=e=>{const t=e.match(/^(\d{4})-W(\d{2})$/);if(!t)return new Date;const n=Number(t[1]),r=Number(t[2]),s=new Date(n,0,1+(r-1)*7),a=s.getDay(),i=a<=4?1-a:8-a,l=new Date(s);return l.setDate(s.getDate()+i),l},Zx=()=>{const{accounts:e,categories:t,transactions:n,settings:r,refresh:s,loading:a,error:i}=fn(),l=Gi(),[c,u]=x.useState("all"),[d,m]=x.useState("all"),[p,w]=x.useState(""),[y,_]=x.useState(""),[b,f]=x.useState(""),[h,g]=x.useState("month"),[S,T]=x.useState(()=>{const j=new Date;return`${j.getFullYear()}-${String(j.getMonth()+1).padStart(2,"0")}`}),[k,P]=x.useState(()=>wh(new Date)),[O,M]=x.useState(()=>String(new Date().getFullYear())),z=(r==null?void 0:r.base_currency)??"EUR",J=x.useMemo(()=>new Map(t.map(j=>[j.id,j.name])),[t]),be=x.useMemo(()=>new Map(e.map(j=>[j.id,`${j.emoji?`${j.emoji} `:""}${j.name}`])),[e]),se=x.useMemo(()=>{const j=c==="all"||c==="transfer"?t:t.filter(D=>D.type===c);return j.filter(D=>!D.parent_id).map(D=>({...D,children:j.filter(ae=>ae.parent_id===D.id)}))},[t,c]),we=x.useMemo(()=>{const j=b.trim().toLowerCase();return n.filter($=>{var D,ae;if(c!=="all"&&$.type!==c||d!=="all"&&$.category_id!==d||p&&$.date<p||y&&$.date>y)return!1;if(j){const ve=((D=J.get($.category_id))==null?void 0:D.toLowerCase())??"",he=((ae=$.note)==null?void 0:ae.toLowerCase())??"";if(!ve.includes(j)&&!he.includes(j))return!1}return!0})},[n,c,d,p,y,b,J]),K=x.useMemo(()=>{const[j,$]=S.split("-"),D=Number(j),ae=Number($)-1,ve=new Intl.DateTimeFormat("it-IT",{month:"long",year:"numeric"}).format(new Date(D,ae,1));return{year:D,monthIndex:ae,monthStr:String(ae+1).padStart(2,"0"),monthLabel:ve}},[S]),oe=x.useMemo(()=>{const j=Xx(k),$=new Date(j);$.setDate(j.getDate()+6);const D=k.split("-W")[1]??"",ae=new Intl.DateTimeFormat("it-IT",{day:"2-digit",month:"short"}),ve=`Settimana ${D} - ${ae.format(j)} / ${ae.format($)}`;return{weekStart:j,weekEnd:$,weekStartKey:Ko(j),weekEndKey:Ko($),label:ve}},[k]),ge=x.useMemo(()=>{const j=Number(O),$=Number.isFinite(j)&&O!==""?j:new Date().getFullYear();return{year:$,label:`Anno ${$}`}},[O]),B=h==="month"?K.monthLabel:h==="week"?oe.label:ge.label,ee=x.useMemo(()=>{if(h==="year"){const ve=new Intl.DateTimeFormat("it-IT",{month:"short"});return Array.from({length:12},(he,ue)=>{const Ye=String(ue+1).padStart(2,"0"),Te=new Date(ge.year,ue,1);return{label:ve.format(Te),key:`${ge.year}-${Ye}`}})}if(h==="week")return Array.from({length:7},(ve,he)=>{const ue=new Date(oe.weekStart);return ue.setDate(oe.weekStart.getDate()+he),{label:String(ue.getDate()),key:Ko(ue)}});const $=(new Date(K.year,K.monthIndex,1).getDay()+6)%7,D=new Date(K.year,K.monthIndex+1,0).getDate(),ae=[];for(let ve=0;ve<$;ve+=1)ae.push(null);for(let ve=1;ve<=D;ve+=1){const he=`${K.year}-${K.monthStr}-${String(ve).padStart(2,"0")}`;ae.push({label:String(ve),key:he})}return ae},[h,K,oe,ge]),G=x.useMemo(()=>{const j=new Map;return we.forEach($=>{if(h==="month"){if(!$.date.startsWith(`${K.year}-${K.monthStr}`))return}else if(h==="week"){if($.date<oe.weekStartKey||$.date>oe.weekEndKey)return}else if(!$.date.startsWith(`${ge.year}-`))return;const D=h==="year"?$.date.slice(0,7):$.date,ae=j.get(D)??{income:0,expense:0};$.type==="income"&&(ae.income+=$.amount),$.type==="expense"&&(ae.expense+=$.amount),j.set(D,ae)}),j},[we,h,K,oe,ge]),de=x.useMemo(()=>{let j=0,$=0;return G.forEach(D=>{j+=D.income,$+=D.expense}),{income:j,expense:$}},[G]);x.useEffect(()=>{m("all")},[c]);const ie=j=>{if(h==="month"){const D=new Date(K.year,K.monthIndex+j,1);T(`${D.getFullYear()}-${String(D.getMonth()+1).padStart(2,"0")}`);return}if(h==="week"){const D=new Date(oe.weekStart);D.setDate(oe.weekStart.getDate()+j*7),P(wh(D));return}const $=ge.year+j;M(String($))},E=()=>{u("all"),m("all"),w(""),_(""),f("")},R=j=>{l(`/transactions?edit=${j}`)},N=async j=>{try{await Rx(j),await s()}catch($){console.error($)}};return a?o.jsx("div",{className:"card",children:"Caricamento filtri..."}):o.jsxs("div",{className:"page",children:[o.jsxs("div",{className:"section-header",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"section-title",children:"Filtra per"}),o.jsx("p",{className:"section-subtitle",children:"Calendario, filtri e ricerca avanzata sulle transazioni"})]}),o.jsxs("span",{className:"pill",children:[we.length," risultati"]})]}),i&&o.jsx("div",{className:"error",children:i}),o.jsxs("div",{className:"card search-panel",children:[o.jsxs("div",{className:"filter-group",children:[o.jsxs("div",{className:"filter-subheader",children:[o.jsx("strong",{children:"Calendario"}),o.jsx("span",{className:"section-subtitle",children:"Verde entrate, rosso uscite"})]}),o.jsxs("div",{className:"calendar-header",children:[o.jsx("button",{className:"button ghost small",type:"button",onClick:()=>ie(-1),children:"<"}),o.jsxs("div",{className:"calendar-title",children:[o.jsx("strong",{children:B}),o.jsxs("div",{className:"calendar-summary",children:[o.jsxs("span",{className:"calendar-income",children:["+",Et(de.income,z)]}),o.jsxs("span",{className:"calendar-expense",children:["-",Et(de.expense,z)]})]})]}),o.jsxs("div",{className:"calendar-actions",children:[o.jsx("div",{className:"calendar-view-toggle",children:[{key:"month",label:"Mese"},{key:"week",label:"Settimana"},{key:"year",label:"Anno"}].map(j=>o.jsx("button",{type:"button",className:`filter-chip ${h===j.key?"active":""}`,onClick:()=>g(j.key),children:j.label},j.key))}),h==="month"&&o.jsx("input",{className:"input",type:"month",value:S,onChange:j=>T(j.target.value)}),h==="week"&&o.jsx("input",{className:"input",type:"week",value:k,onChange:j=>P(j.target.value)}),h==="year"&&o.jsx("input",{className:"input",type:"number",min:"2000",max:"2100",value:O,onChange:j=>M(j.target.value)}),o.jsx("button",{className:"button ghost small",type:"button",onClick:()=>ie(1),children:">"})]})]}),o.jsxs("div",{className:`calendar-grid ${h}`,children:[h!=="year"&&Qx.map(j=>o.jsx("div",{className:"calendar-weekday",children:j},j)),ee.map((j,$)=>{if(!j)return o.jsx("div",{className:"calendar-day empty"},`empty-${$}`);const D=G.get(j.key);return o.jsxs("div",{className:`calendar-day ${h==="year"?"year":""}`,children:[o.jsx("span",{className:"calendar-date",children:j.label}),o.jsxs("div",{className:"calendar-values",children:[o.jsx("span",{className:"calendar-income",children:D!=null&&D.income?`+${Et(D.income,z)}`:"-"}),o.jsx("span",{className:"calendar-expense",children:D!=null&&D.expense?`-${Et(D.expense,z)}`:"-"})]})]},j.key)})]})]}),o.jsxs("div",{className:"filter-group",children:[o.jsxs("div",{className:"filter-subheader",children:[o.jsx("strong",{children:"Filtri"}),o.jsx("span",{className:"section-subtitle",children:"Tipo, categoria, date e testo"})]}),o.jsxs("div",{className:"filter-bar",children:[o.jsx("div",{className:"filter-tabs",children:[{key:"all",label:"Tutte"},{key:"income",label:"Entrate"},{key:"expense",label:"Uscite"},{key:"investment",label:"Investimenti"},{key:"transfer",label:"Trasferimenti"}].map(j=>o.jsx("button",{type:"button",className:`filter-chip ${c===j.key?"active":""}`,onClick:()=>u(j.key),children:j.label},j.key))}),o.jsxs("div",{className:"filter-controls",children:[o.jsxs("select",{className:"select",value:d,onChange:j=>m(j.target.value),disabled:c==="transfer",children:[o.jsx("option",{value:"all",children:"Tutte le categorie"}),se.map(j=>o.jsx("optgroup",{label:j.name,children:j.children.length>0?j.children.map($=>o.jsx("option",{value:$.id,children:$.name},$.id)):o.jsx("option",{value:j.id,children:j.name})},j.id))]}),o.jsx("input",{className:"input",type:"date",value:p,onChange:j=>w(j.target.value)}),o.jsx("input",{className:"input",type:"date",value:y,onChange:j=>_(j.target.value)}),o.jsx("input",{className:"input",type:"search",placeholder:"Cerca note o categoria",value:b,onChange:j=>f(j.target.value)}),o.jsx("button",{className:"button ghost small",type:"button",onClick:E,children:"Reset filtri"})]})]})]}),o.jsxs("div",{className:"filter-group",children:[o.jsxs("div",{className:"filter-subheader",children:[o.jsx("strong",{children:"Risultati"}),o.jsx("span",{className:"section-subtitle",children:"Lista transazioni filtrata"})]}),we.length===0?o.jsx("div",{className:"empty",children:"Nessuna transazione per questi filtri."}):o.jsx("div",{className:"transaction-list",children:we.map(j=>{const $=J.get(j.category_id)??"-",D=be.get(j.account_id)??"Conto",ae=j.type==="expense"||j.type==="investment"&&j.flow==="out"||j.type==="transfer"&&j.flow==="out",ve=ae?-j.amount:j.amount,he=j.type==="income"?"Entrata":j.type==="expense"?"Uscita":j.type==="investment"?j.flow==="in"?"Ritorno":"Output capitale":"Trasferimento";return o.jsxs("div",{className:"transaction-row",children:[o.jsxs("div",{className:"transaction-meta",children:[o.jsx("span",{className:"transaction-date",children:Em(j.date)}),o.jsx("strong",{className:"transaction-category",children:$}),o.jsx("span",{className:"transaction-note",children:j.note??"Nessuna nota"})]}),o.jsxs("div",{className:"transaction-tags",children:[o.jsx("span",{className:`chip ${j.type}`,children:he}),o.jsx("span",{className:"chip",children:D}),o.jsx("span",{className:`transaction-amount ${ae?"negative":"positive"}`,children:Et(ve,j.currency)})]}),o.jsxs("div",{className:"transaction-actions",children:[j.type!=="transfer"&&o.jsx("button",{className:"button ghost small",type:"button",onClick:()=>R(j.id),children:"Modifica"}),o.jsx("button",{className:"button ghost small",type:"button",onClick:()=>N(j.id),children:"Elimina"})]})]},j.id)})})]})]})]})},Ho="Obiettivi",_h="expense",xh={title:"",emoji:"",target_amount:"",due_date:""},ej=()=>{const{categories:e,goals:t,transactions:n,settings:r,refresh:s,loading:a,error:i}=fn(),[l,c]=x.useState(xh),[u,d]=x.useState(null),[m,p]=x.useState(null),[w,y]=x.useState(!1);r==null||r.base_currency;const _=async()=>{const k=e.find(M=>!M.parent_id&&M.name.toLowerCase()===Ho.toLowerCase());if(k)return k.id;await ic({name:Ho,type:_h,parent_id:null,is_fixed:!1,sort_order:null});const O=(await ac()).find(M=>!M.parent_id&&M.name.toLowerCase()===Ho.toLowerCase());return(O==null?void 0:O.id)??null},b=async(k,P)=>{const O=e.find(J=>J.parent_id===P&&J.name.toLowerCase()===k.toLowerCase());if(O)return O.id;await ic({name:k,type:_h,parent_id:P,is_fixed:!1,sort_order:null});const z=(await ac()).find(J=>J.parent_id===P&&J.name.toLowerCase()===k.toLowerCase());return(z==null?void 0:z.id)??null},f=()=>{c(xh),d(null),y(!1)},h=async k=>{k.preventDefault(),p(null);const P=Number(l.target_amount);if(!Number.isFinite(P)||P<=0){p("Inserisci un importo obiettivo valido.");return}if(!l.due_date){p("Seleziona una data di scadenza.");return}try{const O=await _();if(!O){p("Impossibile creare la categoria Obiettivi.");return}const z={category_id:await b(l.title.trim(),O),title:l.title.trim(),emoji:l.emoji.trim()||null,target_amount:P,due_date:l.due_date};u?(await Dx(u.id,z),u.category_id&&u.title!==z.title&&await pm(u.category_id,{name:z.title})):await Lx(z),await s(),p("Obiettivo salvato."),f()}catch(O){p(O.message)}},g=k=>{d(k),c({title:k.title,emoji:k.emoji??"",target_amount:String(k.target_amount),due_date:k.due_date}),y(!0)},S=async k=>{p(null);try{await Ux(k),await s(),p("Obiettivo eliminato.")}catch(P){p(P.message)}},T=x.useMemo(()=>{const k=new Date;return t.map(P=>{const O=n.filter(ge=>ge.category_id===P.category_id&&ge.flow==="out").reduce((ge,B)=>ge+B.amount,0),M=Math.max(P.target_amount-O,0),J=new Date(P.due_date).getTime()-k.getTime(),be=Math.max(Math.ceil(J/(1e3*60*60*24)),0),se=Math.max(Math.ceil(be/30.4),0),we=be>0?M/be:0,K=se>0?M/se:0,oe=P.target_amount>0?Math.min(O/P.target_amount,1):0;return{...P,contributions:O,remaining:M,daysLeft:be,monthsLeft:se,perDay:we,perMonth:K,progress:oe}})},[t,n]);return a?o.jsx("div",{className:"card",children:"Caricamento obiettivi..."}):o.jsxs("div",{className:"page",children:[o.jsxs("div",{className:"section-header",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"section-title",children:"Obiettivi"}),o.jsx("p",{className:"section-subtitle",children:"Pianifica, monitora e raggiungi i tuoi traguardi finanziari."})]}),o.jsx("button",{className:"button secondary",type:"button",onClick:()=>y(k=>!k),children:w?"Chiudi":"+ Nuovo obiettivo"})]}),w&&o.jsxs("div",{className:"card goal-form-card",children:[o.jsx("h3",{children:u?"Modifica obiettivo":"Nuovo obiettivo"}),o.jsxs("form",{className:"form-grid",onSubmit:h,children:[o.jsx("input",{className:"input",placeholder:"Titolo obiettivo",value:l.title,onChange:k=>c({...l,title:k.target.value}),required:!0}),o.jsx("input",{className:"input",placeholder:"Emoji (opzionale)",value:l.emoji,onChange:k=>c({...l,emoji:k.target.value})}),o.jsx("input",{className:"input",type:"number",step:"0.01",placeholder:"Obiettivo totale",value:l.target_amount,onChange:k=>c({...l,target_amount:k.target.value}),required:!0}),o.jsx("input",{className:"input",type:"date",value:l.due_date,onChange:k=>c({...l,due_date:k.target.value}),required:!0}),o.jsxs("div",{style:{display:"flex",gap:"10px"},children:[o.jsx("button",{className:"button",type:"submit",children:u?"Aggiorna":"Aggiungi"}),u&&o.jsx("button",{type:"button",className:"button secondary",onClick:f,children:"Annulla"})]})]})]}),m&&o.jsx("div",{className:"notice",children:m}),i&&o.jsx("div",{className:"error",children:i}),T.length===0?o.jsx("div",{className:"empty",children:"Nessun obiettivo creato."}):o.jsx("div",{className:"goal-grid",children:T.map(k=>{const P=(r==null?void 0:r.base_currency)??"EUR",O=k.contributions>=k.target_amount?"Raggiunto":"In corso";return o.jsxs("div",{className:"goal-card",children:[o.jsxs("div",{className:"goal-header",children:[o.jsxs("div",{children:[o.jsxs("strong",{className:"goal-title",children:[k.emoji?`${k.emoji} `:"",k.title]}),o.jsx("span",{className:"section-subtitle",children:"Categoria Obiettivi"})]}),o.jsx("span",{className:"goal-status",children:O})]}),o.jsx("div",{className:"goal-progress",children:o.jsx("div",{className:"goal-progress-fill",style:{width:`${k.progress*100}%`}})}),o.jsxs("div",{className:"goal-metrics",children:[o.jsxs("div",{className:"goal-metric",children:[o.jsx("span",{children:"Target"}),o.jsx("strong",{children:te(k.target_amount,P)})]}),o.jsxs("div",{className:"goal-metric",children:[o.jsx("span",{children:"Versato"}),o.jsx("strong",{children:te(k.contributions,P)})]}),o.jsxs("div",{className:"goal-metric",children:[o.jsx("span",{children:"Residuo"}),o.jsx("strong",{children:te(k.remaining,P)})]}),o.jsxs("div",{className:"goal-metric",children:[o.jsx("span",{children:"Scadenza"}),o.jsx("strong",{children:k.due_date})]})]}),o.jsxs("div",{className:"goal-breakdown",children:[o.jsxs("div",{children:[o.jsx("span",{className:"stat-label",children:"Al giorno"}),o.jsx("strong",{children:te(k.perDay,P)})]}),o.jsxs("div",{children:[o.jsx("span",{className:"stat-label",children:"Al mese"}),o.jsx("strong",{children:te(k.perMonth,P)})]}),o.jsxs("div",{children:[o.jsx("span",{className:"stat-label",children:"Tempo"}),o.jsx("strong",{children:k.daysLeft>0?`${oc(k.daysLeft)}g / ${oc(k.monthsLeft)}m`:"Scaduto"})]})]}),o.jsxs("div",{className:"goal-actions",children:[o.jsx("button",{className:"button ghost small",type:"button",onClick:()=>g(k),children:"Modifica"}),o.jsx("button",{className:"button ghost small",type:"button",onClick:()=>S(k.id),children:"Elimina"})]})]},k.id)})})]})},jh={name:"",type:"expense",parent_id:"",is_fixed:!1,sort_order:""},tj=()=>{const{categories:e,refresh:t,loading:n,error:r}=fn(),[s,a]=x.useState(jh),[i,l]=x.useState(null),[c,u]=x.useState(null),d=x.useMemo(()=>e.filter(f=>!f.parent_id&&f.type===s.type),[e,s.type]),m=x.useMemo(()=>{const f={income:[],expense:[],investment:[]};return e.forEach(h=>{f[h.type].push(h)}),f},[e]),p=()=>{a(jh),l(null)},w=async f=>{f.preventDefault(),u(null);const h={name:s.name,type:s.type,parent_id:s.parent_id?s.parent_id:null,is_fixed:s.is_fixed,sort_order:s.sort_order?Number(s.sort_order):null};try{i?await pm(i.id,h):await ic(h),await t(),u("Categoria salvata."),p()}catch(g){u(g.message)}},y=f=>{l(f),a({name:f.name,type:f.type,parent_id:f.parent_id??"",is_fixed:f.is_fixed,sort_order:f.sort_order?String(f.sort_order):""})},_=async f=>{try{await Nx(f),await t()}catch(h){u(h.message)}},b=async()=>{try{await mm(),await t(),u("Categorie base importate.")}catch(f){u(f.message)}};return n?o.jsx("div",{className:"card",children:"Caricamento categorie..."}):o.jsxs("div",{className:"page",children:[o.jsxs("div",{className:"section-header",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"section-title",children:"Categorie"}),o.jsx("p",{className:"section-subtitle",children:"Struttura gerarchica completa"})]}),o.jsx("button",{className:"button secondary",onClick:b,children:"Importa categorie base"})]}),o.jsxs("div",{className:"card",children:[o.jsx("h3",{children:i?"Modifica categoria":"Nuova categoria"}),o.jsxs("div",{className:"info-panel",children:[o.jsxs("div",{className:"info-item",children:[o.jsx("strong",{children:"Genitore"}),o.jsx("span",{children:"Assegna un genitore per creare una sottocategoria ordinata."})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("strong",{children:"Ordine"}),o.jsx("span",{children:"Numero piu basso = categoria mostrata prima."})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("strong",{children:"Spesa fissa"}),o.jsx("span",{children:"Segna le spese ricorrenti usate nel burn rate."})]})]}),o.jsxs("form",{className:"form-grid",onSubmit:w,children:[o.jsx("input",{className:"input",placeholder:"Nome categoria",value:s.name,onChange:f=>a({...s,name:f.target.value}),required:!0}),o.jsxs("select",{className:"select",value:s.type,onChange:f=>a({...s,type:f.target.value}),children:[o.jsx("option",{value:"income",children:"Entrate"}),o.jsx("option",{value:"expense",children:"Uscite"}),o.jsx("option",{value:"investment",children:"Investimenti"})]}),o.jsxs("select",{className:"select",value:s.parent_id,onChange:f=>a({...s,parent_id:f.target.value}),children:[o.jsx("option",{value:"",children:"Nessun genitore"}),d.map(f=>o.jsx("option",{value:f.id,children:f.name},f.id))]}),o.jsx("input",{className:"input",type:"number",placeholder:"Ordine (priorita)",value:s.sort_order,onChange:f=>a({...s,sort_order:f.target.value})}),o.jsxs("label",{className:"tag",children:[o.jsx("input",{type:"checkbox",checked:s.is_fixed,onChange:f=>a({...s,is_fixed:f.target.checked})}),"Spesa fissa (ricorrente)"]}),o.jsxs("div",{style:{display:"flex",gap:"10px"},children:[o.jsx("button",{className:"button",type:"submit",children:i?"Aggiorna":"Aggiungi"}),i&&o.jsx("button",{type:"button",className:"button secondary",onClick:p,children:"Annulla"})]})]}),c&&o.jsx("div",{className:"notice",children:c}),r&&o.jsx("div",{className:"error",children:r})]}),o.jsx("div",{className:"grid-3",children:Object.keys(m).map(f=>o.jsxs("div",{className:"card",children:[o.jsx("h3",{children:f.toUpperCase()}),m[f].length===0?o.jsx("div",{className:"empty",children:"Nessuna categoria."}):m[f].filter(h=>!h.parent_id).map(h=>o.jsxs("div",{style:{marginBottom:"12px"},children:[o.jsx("strong",{children:h.name}),o.jsxs("div",{style:{display:"flex",gap:"6px",marginTop:"6px"},children:[o.jsx("button",{className:"button ghost",type:"button",onClick:()=>y(h),children:"Modifica"}),o.jsx("button",{className:"button ghost",type:"button",onClick:()=>_(h.id),children:"Elimina"})]}),o.jsx("div",{style:{marginTop:"8px",paddingLeft:"12px"},children:m[f].filter(g=>g.parent_id===h.id).map(g=>o.jsxs("div",{style:{marginBottom:"6px"},children:[o.jsx("span",{children:g.name}),o.jsxs("div",{style:{display:"flex",gap:"6px",marginTop:"4px"},children:[o.jsx("button",{className:"button ghost",type:"button",onClick:()=>y(g),children:"Modifica"}),o.jsx("button",{className:"button ghost",type:"button",onClick:()=>_(g.id),children:"Elimina"})]})]},g.id))})]},h.id))]},f))})]})},nj=()=>{var we;const{accounts:e,categories:t,transactions:n,holdings:r,settings:s,loading:a,error:i}=fn(),l=(s==null?void 0:s.base_currency)??"EUR",[c,u]=x.useState(12),[d,m]=x.useState(null),p=ym(r),w=wm(r),y=_m(n),_=du(r),b=la(r)-_,f=bm(n,c),h=Zi(e,n),g=la(r)+h.filter(K=>K.type!=="credit").reduce((K,oe)=>K+oe.balance,0),S=h.reduce((K,oe)=>K+oe.balance,0),T=hu(r),k=S>0?[...T,{label:"Cash",value:S}]:T,P=d?r.filter(K=>K.asset_class===d).map(K=>({label:`${K.emoji?`${K.emoji} `:""}${K.name}`,value:K.current_value})):[],O=d==="Cash"?h.map(K=>({label:`${K.emoji?`${K.emoji} `:""}${K.name}`,value:K.balance})):[],M=Sm(n,t),z=M.reduce((K,oe)=>K+oe.value,0),J=n.filter(K=>K.type==="expense").length,be=J>0?z/J:0,se=M.slice(0,5);return a?o.jsx("div",{className:"card",children:"Caricamento analytics..."}):i?o.jsx("div",{className:"error",children:i}):o.jsxs("div",{className:"page",children:[o.jsx("div",{className:"section-header",children:o.jsxs("div",{children:[o.jsx("h2",{className:"section-title",children:"Analytics Avanzate"}),o.jsx("p",{className:"section-subtitle",children:"Indicatori strategici pensati per investitori e controllo cash flow."})]})}),o.jsxs("div",{className:"stat-grid",children:[o.jsxs("div",{className:"stat-card",children:[o.jsx("span",{className:"stat-label",children:"ROI"}),o.jsx("span",{className:"stat-value",children:mt(p)}),o.jsx("span",{className:"stat-trend",children:"Rendimento totale"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("span",{className:"stat-label",children:"CAGR"}),o.jsx("span",{className:"stat-value",children:mt(w)}),o.jsx("span",{className:"stat-trend",children:"Crescita annua composta"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("span",{className:"stat-label",children:"Capitale investito"}),o.jsx("span",{className:"stat-value",children:te(_,l)}),o.jsx("span",{className:"stat-trend",children:"Totale allocato"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("span",{className:"stat-label",children:"Capital Gain"}),o.jsx("span",{className:`stat-value ${b>=0?"positive":"negative"}`,children:te(b,l)}),o.jsx("span",{className:"stat-trend",children:"Differenza valore vs capitale"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("span",{className:"stat-label",children:"Savings Rate"}),o.jsx("span",{className:"stat-value",children:mt(y)}),o.jsx("span",{className:"stat-trend",children:"Capitale trattenuto"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("span",{className:"stat-label",children:"Net Worth"}),o.jsx("span",{className:"stat-value",children:te(g,l)}),o.jsx("span",{className:"stat-trend",children:"Patrimonio netto"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("span",{className:"stat-label",children:"Spesa media"}),o.jsx("span",{className:"stat-value",children:te(be,l)}),o.jsx("span",{className:"stat-trend",children:"Media per transazione"})]})]}),o.jsxs("div",{className:"grid-2",children:[o.jsxs("div",{className:"chart-card",children:[o.jsxs("div",{children:[o.jsxs("strong",{children:["Cash Flow ",c," mesi"]}),o.jsx("p",{className:"section-subtitle",children:"Entrate vs uscite mese per mese"}),o.jsxs("div",{style:{display:"flex",gap:"8px"},children:[o.jsxs("span",{className:"tag",children:[o.jsx("span",{className:"tag-dot",style:{background:"#1f6f5c"}}),"Entrate"]}),o.jsxs("span",{className:"tag",children:[o.jsx("span",{className:"tag-dot",style:{background:"#c8782b"}}),"Uscite"]})]}),o.jsx("div",{className:"range-toggle",children:[6,12,24].map(K=>o.jsxs("button",{type:"button",className:`chip ${c===K?"active":""}`,onClick:()=>u(K),children:[K," mesi"]},K))})]}),o.jsx(Cm,{data:f})]}),o.jsxs("div",{className:"chart-card",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Net Flow"}),o.jsx("p",{className:"section-subtitle",children:"Risultato netto mensile"})]}),o.jsx(Tm,{data:f,color:"#c8782b"})]})]}),o.jsxs("div",{className:"grid-2",children:[o.jsxs("div",{className:"chart-card",children:[o.jsxs("div",{children:[o.jsx("strong",{children:d?`Asset Allocation - ${d}`:"Asset Allocation"}),o.jsx("p",{className:"section-subtitle",children:d?"Dettaglio percentuale per singolo asset":"Classi di asset a confronto"}),d&&o.jsx("button",{className:"button ghost small",type:"button",onClick:()=>m(null),children:"Torna indietro"})]}),o.jsx(Ls,{data:d==="Cash"?O:d?P:k,onSelect:d?void 0:K=>m(K),valueFormatter:K=>te(K,l)})]}),o.jsxs("div",{className:"chart-card",children:[o.jsxs("div",{children:[o.jsx("strong",{children:"Spese per categoria"}),o.jsx("p",{className:"section-subtitle",children:"Distribuzione uscite"})]}),M.length>0?o.jsxs("div",{className:"expense-panel",children:[o.jsxs("div",{className:"grid-3",children:[o.jsxs("div",{className:"stat-card",children:[o.jsx("span",{className:"stat-label",children:"Totale spese"}),o.jsx("span",{className:"stat-value",children:te(z,l)}),o.jsx("span",{className:"stat-trend",children:"Periodo complessivo"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("span",{className:"stat-label",children:"Numero spese"}),o.jsx("span",{className:"stat-value",children:J}),o.jsx("span",{className:"stat-trend",children:"Transazioni"})]}),o.jsxs("div",{className:"stat-card",children:[o.jsx("span",{className:"stat-label",children:"Top categoria"}),o.jsx("span",{className:"stat-value",children:((we=se[0])==null?void 0:we.label)??"N/D"}),o.jsx("span",{className:"stat-trend",children:se[0]?te(se[0].value,l):"N/D"})]})]}),o.jsx("div",{className:"expense-bars",children:se.map(K=>{const oe=z?K.value/z*100:0;return o.jsxs("div",{className:"expense-bar",children:[o.jsxs("div",{children:[o.jsx("strong",{children:K.label}),o.jsx("span",{className:"section-subtitle",children:te(K.value,l)})]}),o.jsx("div",{className:"expense-track",children:o.jsx("div",{className:"expense-fill",style:{width:`${oe}%`}})})]},K.label)})})]}):o.jsx("div",{className:"empty",children:"Nessuna spesa disponibile."})]})]})]})},rj=({data:e,benchmarkColor:t="#f2b76c",portfolioColor:n="#2dd4bf"})=>{if(e.length===0)return o.jsx("div",{className:"empty",children:"Nessun dato disponibile."});const r=x.useRef(null),[s,a]=x.useState(null),[i,l]=x.useState({x:0,y:0}),c=520,u=200,d=20,m=e.flatMap(T=>[T.benchmark,T.portfolio,0]),p=Math.min(...m),y=Math.max(...m)-p||1,_=(c-d*2)/(e.length-1||1),b=e.map((T,k)=>{const P=d+k*_,O=u-d-(T.benchmark-p)/y*(u-d*2),M=u-d-(T.portfolio-p)/y*(u-d*2);return{x:P,benchmarkY:O,portfolioY:M}}),f=T=>b.map((k,P)=>`${P===0?"M":"L"} ${k.x} ${k[T]}`).join(" "),h=f("benchmarkY"),g=f("portfolioY"),S=T=>{const k=T.currentTarget.getBoundingClientRect(),O=(T.clientX-k.left)/k.width*c,M=Math.round((O-d)/_),z=Math.min(Math.max(M,0),e.length-1),J=b[z];a(z),l({x:J.x/c*k.width,y:Math.min(J.benchmarkY,J.portfolioY)/u*k.height})};return o.jsxs("div",{className:"chart-interactive",ref:r,children:[o.jsxs("svg",{viewBox:`0 0 ${c} ${u}`,width:"100%",height:"200",onMouseMove:S,onMouseLeave:()=>a(null),children:[o.jsx("path",{d:h,fill:"none",stroke:t,strokeWidth:"3"}),o.jsx("path",{d:g,fill:"none",stroke:n,strokeWidth:"3"}),s!==null&&o.jsxs(o.Fragment,{children:[o.jsx("circle",{cx:b[s].x,cy:b[s].benchmarkY,r:"4",fill:t}),o.jsx("circle",{cx:b[s].x,cy:b[s].portfolioY,r:"4",fill:n})]})]}),s!==null&&o.jsxs("div",{className:"chart-tooltip",style:{left:i.x,top:i.y},children:[o.jsx("strong",{children:e[s].label}),o.jsxs("span",{children:["Benchmark: ",e[s].benchmark.toFixed(1),"%"]}),o.jsxs("span",{children:["Portafoglio: ",e[s].portfolio.toFixed(1),"%"]})]})]})},sj=[{id:"inflation-euro",title:"Inflazione Euro + energia",description:"Aumento prezzi energia e inflazione persistente in area Euro.",benchmarkShock:-12,shocks:{Cash:-3,ETF:-8,Azioni:-10,Obbligazioni:-14,Crypto:-18,Oro:6,"Real Estate":-7,"Private Equity":-12,Altro:-6},advice:["Aumenta exposure a oro/commodity difensive.","Valuta ETF inflation-linked o indicizzati.","Riduci duration obbligazionaria."]},{id:"rate-hike",title:"Rialzo tassi aggressivo",description:"Tassi in salita, compressione multipli e credito piu caro.",benchmarkShock:-16,shocks:{Cash:1,ETF:-12,Azioni:-15,Obbligazioni:-10,Crypto:-22,Oro:2,"Real Estate":-12,"Private Equity":-15,Altro:-8},advice:["Favorisci cash e strumenti a breve durata.","Ribilancia verso quality e low leverage.","Riduci asset ad alta volatilita."]},{id:"global-slowdown",title:"Rallentamento globale + USD forte",description:"Domanda in calo, export sotto pressione, dollaro dominante.",benchmarkShock:-18,shocks:{Cash:0,ETF:-14,Azioni:-18,Obbligazioni:-6,Crypto:-25,Oro:4,"Real Estate":-10,"Private Equity":-18,Altro:-9},advice:["Proteggi equity con asset decorrelati.","Mantieni liquidita per opportunita.","Diversifica esposizione geografica."]}],aj=e=>{const t=[];for(let n=0;n<e;n+=1){const r=n/(e-1||1),s=Math.sin(Math.PI*r);t.push(s)}return t},ij=()=>{const{accounts:e,transactions:t,holdings:n,loading:r,error:s}=fn(),i=x.useMemo(()=>Zi(e,t),[e,t]).reduce((p,w)=>p+w.balance,0),l=hu(n),u=l.reduce((p,w)=>p+w.value,0)+i,d=x.useMemo(()=>{const p=new Map;return l.forEach(w=>{p.set(w.label,u>0?w.value/u:0)}),i>0&&p.set("Cash",u>0?i/u:0),p},[l,i,u]),m=x.useMemo(()=>{const p=Array.from({length:12},(y,_)=>`M${_+1}`),w=aj(p.length);return sj.map(y=>{const _=Array.from(d.entries()).reduce((f,[h,g])=>{const S=y.shocks[h]??y.shocks.Altro??y.benchmarkShock;return f+g*S},0),b=p.map((f,h)=>({label:f,benchmark:y.benchmarkShock*w[h],portfolio:_*w[h]}));return{scenario:y,portfolioShock:_,data:b}})},[d]);return r?o.jsx("div",{className:"card",children:"Caricamento stress test..."}):s?o.jsx("div",{className:"error",children:s}):o.jsxs("div",{className:"page",children:[o.jsx("div",{className:"section-header",children:o.jsxs("div",{children:[o.jsx("h2",{className:"section-title",children:"Stress Test"}),o.jsx("p",{className:"section-subtitle",children:"Simulazioni realistiche con benchmark vs portafoglio."})]})}),o.jsx("div",{className:"stress-grid",children:m.map(({scenario:p,portfolioShock:w,data:y})=>o.jsxs("div",{className:"card stress-card",children:[o.jsxs("div",{className:"stress-header",children:[o.jsxs("div",{children:[o.jsx("strong",{children:p.title}),o.jsx("p",{className:"section-subtitle",children:p.description})]}),o.jsxs("div",{className:"stress-metrics",children:[o.jsxs("span",{className:"tag",children:["Benchmark: ",p.benchmarkShock.toFixed(1),"%"]}),o.jsxs("span",{className:"tag",children:["Portafoglio: ",w.toFixed(1),"%"]})]})]}),o.jsx(rj,{data:y}),o.jsx("div",{className:"stress-advice",children:p.advice.map(_=>o.jsx("span",{className:"chip",children:_},_))})]},p.id))})]})},oj=[{value:"bank",label:"Banca"},{value:"debit",label:"Carta debito"},{value:"credit",label:"Carta credito"},{value:"cash",label:"Cash"},{value:"paypal",label:"PayPal"},{value:"other",label:"Altro"}],bh={name:"",type:"bank",emoji:"",currency:"EUR",opening_balance:""},Sh={bank:"Banca",debit:"Carta debito",credit:"Carta credito",cash:"Cash",paypal:"PayPal",other:"Altro"},lj=()=>{const{session:e}=hr(),{accounts:t,categories:n,transactions:r,holdings:s,settings:a,refresh:i,loading:l,error:c}=fn(),[u,d]=x.useState("EUR"),[m,p]=x.useState(null),[w,y]=x.useState(null),[_,b]=x.useState(bh),[f,h]=x.useState(null),[g,S]=x.useState(null),T=N=>/emergenza|emergency/i.test(N.name),k=N=>N.toLowerCase().replace(/[^a-z0-9]/g,"").trim(),P=x.useMemo(()=>new Map(n.map(N=>[k(N.name),N.id])),[n]),O=x.useMemo(()=>new Map(t.map(N=>[k(N.name),N.id])),[t]),M=(N,j)=>{if(!j)return;const $=k(j);if($){if(N.has($))return N.get($);for(const[D,ae]of N.entries())if(D.includes($)||$.includes(D))return ae}};x.useEffect(()=>{a&&d(a.base_currency)},[a]),x.useEffect(()=>{f||b(N=>({...N,currency:u}))},[u,f]);const z=async N=>{if(N.preventDefault(),p(null),!!e)try{await vm({user_id:e.user.id,base_currency:u,emergency_fund:(a==null?void 0:a.emergency_fund)??0}),await i(),p("Impostazioni aggiornate.")}catch(j){p(j.message)}},J=()=>{b({...bh,currency:u}),h(null)},be=async N=>{N.preventDefault(),S(null);const $={name:(f?T(f):!1)?(f==null?void 0:f.name)??"":_.name.trim(),type:_.type,emoji:_.emoji.trim()||null,currency:_.currency,opening_balance:Number(_.opening_balance||0)};try{f?await Sx(f.id,$):await fm($),await i(),S("Conto salvato."),J()}catch(D){S(D.message)}},se=N=>{h(N),b({name:N.name,type:N.type,emoji:N.emoji??"",currency:N.currency,opening_balance:String(N.opening_balance??0)})},we=async N=>{S(null);const j=t.find($=>$.id===N);if(j&&T(j)){S("Non puoi eliminare i conti di sistema.");return}try{await kx(N),await i(),S("Conto eliminato.")}catch($){S($.message)}},K=(N,j)=>{const $=N.includes(j)||N.includes('"')||N.includes(`
`),D=N.replace(/\"/g,'""');return $?`"${D}"`:D},oe=(N,j=";")=>N.map($=>$.map(D=>K(D,j)).join(j)).join(`
`),ge=(N,j)=>{const $=new Blob([j],{type:"text/csv;charset=utf-8;"}),D=document.createElement("a");D.href=URL.createObjectURL($),D.download=N,D.click(),URL.revokeObjectURL(D.href)},B=()=>{const N=[["date","type","flow","account_id","account_name","category_id","category_name","amount","currency","note"],...r.map(j=>{var $,D;return[j.date,j.type,j.flow,j.account_id,(($=t.find(ae=>ae.id===j.account_id))==null?void 0:$.name)??"",j.category_id,((D=n.find(ae=>ae.id===j.category_id))==null?void 0:D.name)??"",String(j.amount),j.currency,j.note??""]})];ge("transactions.csv",oe(N))},ee=()=>{const N=[["name","asset_class","emoji","target_pct","quantity","avg_cost","total_cap","current_value","currency","start_date","note"],...s.map(j=>[j.name,j.asset_class,j.emoji??"",j.target_pct!==null&&j.target_pct!==void 0?String(j.target_pct):"",String(j.quantity),String(j.avg_cost),String(j.total_cap),String(j.current_value),j.currency,j.start_date,j.note??""])];ge("holdings.csv",oe(N))},G=()=>{const N=[["name","type","parent_name","is_fixed","sort_order"],...n.map(j=>{var $;return[j.name,j.type,j.parent_id?(($=n.find(D=>D.id===j.parent_id))==null?void 0:$.name)??"":"",j.is_fixed?"true":"false",j.sort_order?String(j.sort_order):""]})];ge("categories.csv",oe(N))},de=(N,j=";")=>{const $=[];let D="",ae=[],ve=!1;for(let he=0;he<N.length;he+=1){const ue=N[he],Ye=N[he+1];if(ue==='"'&&Ye==='"'){D+='"',he+=1;continue}if(ue==='"'){ve=!ve;continue}if(!ve&&(ue===`
`||ue==="\r")){ue==="\r"&&Ye===`
`&&(he+=1),ae.push(D),$.push(ae),ae=[],D="";continue}if(!ve&&ue===j){ae.push(D),D="";continue}D+=ue}return(D.length>0||ae.length>0)&&(ae.push(D),$.push(ae)),$.filter(he=>he.some(ue=>ue.trim()!==""))},ie=N=>N.map(j=>j.trim().toLowerCase()),E=async N=>{var j;y(null);try{if(t.length===0){y("Crea almeno un conto prima di importare transazioni.");return}const $=await N.text(),D=de($);if(D.length<2){y("File vuoto o formato non valido.");return}const ae=ie(D[0]),ve=((j=t[0])==null?void 0:j.id)??"",ue=D.slice(1).map(Ye=>{const Te=ae.reduce((fr,ma,It)=>{var pn;return fr[ma]=((pn=Ye[It])==null?void 0:pn.trim())??"",fr},{}),Ot=Number(Te.amount??0),bt=Number.isFinite(Ot)?Ot<0?"expense":"income":"expense",St=Te.type||bt,xe=St==="income"?"in":St==="expense"?"out":Te.flow==="in"?"in":"out",At=Te.account_id||M(O,Te.account_name)||ve,as=Te.category_id||M(P,Te.category_name),Bn=Te.currency==="USD"?"USD":"EUR";return{date:Te.date,type:St,flow:xe,account_id:At??"",category_id:as??"",amount:Math.abs(Ot),currency:Bn,note:Te.note||null}}).filter(Ye=>Ye.date&&Ye.account_id&&Ye.category_id&&!Number.isNaN(Ye.amount));await gm(ue),await i(),y(`Importate ${ue.length} transazioni.`)}catch($){y($.message)}},R=async N=>{y(null);try{const j=await N.text(),$=de(j);if($.length<2){y("File vuoto o formato non valido.");return}const D=ie($[0]),ve=$.slice(1).map(he=>{const ue=D.reduce((xe,At,as)=>{var Bn;return xe[At]=((Bn=he[as])==null?void 0:Bn.trim())??"",xe},{}),Ye=ue.currency==="USD"?"USD":"EUR",Te=Number(ue.quantity??0),Ot=Number(ue.avg_cost??0),bt=ue.total_cap?Number(ue.total_cap):Te*Ot,St=ue.target_pct?Number(ue.target_pct):null;return{name:ue.name,asset_class:ue.asset_class||"Altro",emoji:ue.emoji||null,target_pct:Number.isFinite(St)?St:null,quantity:Te,avg_cost:Ot,total_cap:bt,current_value:Number(ue.current_value??0),currency:Ye,start_date:ue.start_date,note:ue.note||null}}).filter(he=>he.name&&he.start_date&&!Number.isNaN(he.total_cap));await Ax(ve),await i(),y(`Importate ${ve.length} holdings.`)}catch(j){y(j.message)}};return l?o.jsx("div",{className:"card",children:"Caricamento impostazioni..."}):o.jsxs("div",{className:"page",children:[o.jsx("div",{className:"section-header",children:o.jsxs("div",{children:[o.jsx("h2",{className:"section-title",children:"Impostazioni"}),o.jsx("p",{className:"section-subtitle",children:"Valute e configurazioni chiave"})]})}),o.jsxs("div",{className:"card",children:[o.jsxs("form",{className:"form-grid",onSubmit:z,children:[o.jsxs("select",{className:"select",value:u,onChange:N=>d(N.target.value),children:[o.jsx("option",{value:"EUR",children:"EUR"}),o.jsx("option",{value:"USD",children:"USD"})]}),o.jsx("button",{className:"button",type:"submit",children:"Salva impostazioni"})]}),m&&o.jsx("div",{className:"notice",children:m}),c&&o.jsx("div",{className:"error",children:c})]}),o.jsxs("div",{className:"card",children:[o.jsx("div",{className:"section-header",children:o.jsxs("div",{children:[o.jsx("h3",{children:"Conti"}),o.jsx("p",{className:"section-subtitle",children:"Carte, contanti, PayPal e altro"})]})}),o.jsxs("form",{className:"form-grid",onSubmit:be,children:[o.jsx("input",{className:"input",placeholder:"Nome conto",value:_.name,onChange:N=>b({..._,name:N.target.value}),disabled:f?T(f):!1,required:!0}),o.jsx("select",{className:"select",value:_.type,onChange:N=>b({..._,type:N.target.value}),children:oj.map(N=>o.jsx("option",{value:N.value,children:N.label},N.value))}),o.jsx("input",{className:"input",placeholder:"Emoji (opzionale)",value:_.emoji,onChange:N=>b({..._,emoji:N.target.value})}),o.jsxs("select",{className:"select",value:_.currency,onChange:N=>b({..._,currency:N.target.value}),children:[o.jsx("option",{value:"EUR",children:"EUR"}),o.jsx("option",{value:"USD",children:"USD"})]}),o.jsx("input",{className:"input",type:"number",step:"0.01",placeholder:"Saldo iniziale",value:_.opening_balance,onChange:N=>b({..._,opening_balance:N.target.value})}),o.jsxs("div",{style:{display:"flex",gap:"10px"},children:[o.jsx("button",{className:"button",type:"submit",children:f?"Aggiorna":"Aggiungi"}),f&&o.jsx("button",{type:"button",className:"button secondary",onClick:J,children:"Annulla"})]})]}),g&&o.jsx("div",{className:"notice",children:g}),t.length===0?o.jsx("div",{className:"empty",children:"Nessun conto creato."}):o.jsxs(o.Fragment,{children:[t.some(N=>T(N))&&o.jsxs("div",{className:"account-section",children:[o.jsx("div",{className:"section-header",children:o.jsxs("div",{children:[o.jsx("h4",{children:"Sistema"}),o.jsx("p",{className:"section-subtitle",children:"Conti predefiniti del sistema"})]})}),o.jsx("div",{className:"account-grid",children:t.filter(N=>T(N)).map(N=>o.jsxs("div",{className:"account-card system-account",children:[o.jsxs("div",{className:"account-meta",children:[o.jsx("span",{className:"account-emoji",children:N.emoji&&N.emoji.trim()?N.emoji:"O"}),o.jsxs("div",{className:"account-info",children:[o.jsx("strong",{children:N.name}),o.jsx("span",{className:"section-subtitle",children:Sh[N.type]??N.type})]})]}),o.jsxs("div",{className:"account-actions",children:[o.jsx("span",{className:"account-badge",children:"Sistema"}),o.jsx("button",{className:"button ghost small",type:"button",onClick:()=>se(N),children:"Modifica"})]})]},N.id))})]}),o.jsxs("div",{className:"account-section",children:[o.jsx("div",{className:"section-header",children:o.jsxs("div",{children:[o.jsx("h4",{children:"Personali"}),o.jsx("p",{className:"section-subtitle",children:"Conti creati manualmente"})]})}),o.jsx("div",{className:"account-grid",children:t.filter(N=>!T(N)).map(N=>o.jsxs("div",{className:"account-card",children:[o.jsxs("div",{className:"account-meta",children:[o.jsx("span",{className:"account-emoji",children:N.emoji&&N.emoji.trim()?N.emoji:"O"}),o.jsxs("div",{className:"account-info",children:[o.jsx("strong",{children:N.name}),o.jsx("span",{className:"section-subtitle",children:Sh[N.type]??N.type})]})]}),o.jsxs("div",{className:"account-actions",children:[o.jsx("button",{className:"button ghost small",type:"button",onClick:()=>se(N),children:"Modifica"}),o.jsx("button",{className:"button ghost small",type:"button",onClick:()=>we(N.id),children:"Elimina"})]})]},N.id))})]})]})]}),o.jsxs("div",{className:"card",children:[o.jsx("h3",{children:"Import / Export dati (CSV)"}),o.jsxs("div",{className:"info-panel",children:[o.jsxs("div",{className:"info-item",children:[o.jsx("strong",{children:"Formato CSV"}),o.jsxs("span",{children:["Delimitatore consigliato: ",o.jsx("code",{children:";"})," (compatibile con Excel)."]})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("strong",{children:"Transazioni"}),o.jsx("span",{children:"Campi: date, type, flow, account_id o account_name, category_id o category_name, amount, currency, note."})]}),o.jsxs("div",{className:"info-item",children:[o.jsx("strong",{children:"Holdings"}),o.jsx("span",{children:"Campi: name, asset_class, emoji, target_pct, quantity, avg_cost, total_cap, current_value, currency, start_date, note."})]})]}),o.jsxs("div",{className:"grid-3",style:{marginTop:"16px"},children:[o.jsx("button",{className:"button secondary",type:"button",onClick:B,children:"Esporta transazioni"}),o.jsx("button",{className:"button secondary",type:"button",onClick:ee,children:"Esporta holdings"}),o.jsx("button",{className:"button secondary",type:"button",onClick:G,children:"Esporta categorie"})]}),o.jsxs("div",{className:"grid-2",style:{marginTop:"16px"},children:[o.jsxs("label",{children:["Importa transazioni (CSV)",o.jsx("input",{className:"input",type:"file",accept:".csv,text/csv",onChange:N=>{var $;const j=($=N.target.files)==null?void 0:$[0];j&&E(j)}})]}),o.jsxs("label",{children:["Importa holdings (CSV)",o.jsx("input",{className:"input",type:"file",accept:".csv,text/csv",onChange:N=>{var $;const j=($=N.target.files)==null?void 0:$[0];j&&R(j)}})]})]}),w&&o.jsx("div",{className:"notice",children:w})]})]})},cj=({children:e})=>{const{session:t,loading:n}=hr();return n?o.jsx("div",{className:"card",children:"Caricamento..."}):t?o.jsx(o.Fragment,{children:e}):o.jsx(Vl,{to:"/login",replace:!0})},uj=()=>{const{session:e}=hr();return o.jsxs(x0,{children:[o.jsx(ht,{path:"/login",element:e?o.jsx(Vl,{to:"/",replace:!0}):o.jsx(jx,{})}),o.jsx(ht,{path:"/register",element:e?o.jsx(Vl,{to:"/",replace:!0}):o.jsx(bx,{})}),o.jsxs(ht,{path:"/",element:o.jsx(cj,{children:o.jsx(xx,{})}),children:[o.jsx(ht,{index:!0,element:o.jsx(Wx,{})}),o.jsx(ht,{path:"portfolio",element:o.jsx(Hx,{})}),o.jsx(ht,{path:"transactions",element:o.jsx(Jx,{})}),o.jsx(ht,{path:"transactions/filter",element:o.jsx(Zx,{})}),o.jsx(ht,{path:"goals",element:o.jsx(ej,{})}),o.jsx(ht,{path:"categories",element:o.jsx(tj,{})}),o.jsx(ht,{path:"analytics",element:o.jsx(nj,{})}),o.jsx(ht,{path:"analytics/stress-test",element:o.jsx(ij,{})}),o.jsx(ht,{path:"settings",element:o.jsx(lj,{})})]})]})};function dj(){return o.jsx(vx,{children:o.jsx(uj,{})})}Go.createRoot(document.getElementById("root")).render(o.jsx($h.StrictMode,{children:o.jsx(R0,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:o.jsx(dj,{})})}));
